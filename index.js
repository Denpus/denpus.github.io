(function(T){function bb(c,a){var b,e;e=a.keyCode;b=a.key||a.code;var d=!1;if(!c.hint||c.hint.knav(e))switch(e){case 225:break;case 229:c.is_evtch=!0;break;case 13:a.ctrlKey?d=!0:(c.ln_len++,c.put_val("","\n","",null),ba(c,c.pos),c.line_pos(1));break;case 27:c.exec_evt(h.DM_ginp_esc);c.blur(0);break;case 8:b=c.get_val();e=b.substring(0,c.pos-1);e+=b.substring(c.pos,b.length);c.set_val(e,"",null);ba(c,c.pos-1);break;case 46:b=c.get_val();c.pos<b.length&&(e=b.substring(0,c.pos),e+=b.substring(c.pos+
1,b.length),c.set_val(e,"",null),ba(c,c.pos));break;case 37:ba(c,c.pos-1);break;case 38:c.line_pos(-1);break;case 39:ba(c,c.pos+1);break;case 40:c.line_pos(1);break;default:20<e?(e=c.pos,a.modifierAltGraph||a.ctrlKey||a.altKey?d=!0:(c.put_val("",b,"",null),ba(c,e+1))):d=!0}return d}function cb(c){var a=c.field,b=0;"selectionStart"in a?b=a.selectionStart:"selection"in document&&(a=document.selection.createRange(),b=document.selection.createRange().text.length,a.moveStart("character",-c.get_val()),
b=a.text.length-b);return b}function ba(c,a){var b=c.field,e=c.get_val().length;0>a?a=e+1- -1*a:a>e&&(a-=e+1);c.pos=a;b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveEnd("character",a),b.moveStart("character",a),b.select())}function Da(c){var a=Z.cur,b=a.field;null==c?c=b.bk2:b.bk2={evt:a.evt,placeholder:a.placeholder,pos:a.pos,ud_par:a.ud_par,val:a.get_val()};c&&(Object.assign(a,c),a.init());b.obj=c;"string"==typeof c.val&&a.set_val(c.val,
c.notice,null);null==b.bk&&(b.bk=[b.obj,a.get_val()]);return a}function Ea(c,a,b,e,d){var f=c.field;b="string"===typeof b?b:"";a=null!=a?"string"===typeof a?a:a.toString():"";c.val=a;f.value=a;c.val_el.innerText=a;f.title=b;f._notice_el.innerText=b;null!=e&&(f._val_type=e[0],f._val_big=e[1]);d&&c.exec_evt(h.DM_ginp_live);return 0}function Ka(c,a,b,e){Ea(c,a,b,e,0)}function db(){var c=Z.cur;c.pos=0;c.init();return 0}function eb(c){return La(c,c.sz-c.cur)}function La(c,a){var b=(new Uint8Array(c.pos.buffer)).subarray(c.cur,
c.cur+a),b=String.fromCharCode.apply(null,b);c.cur+=a;return b}function fb(c,a,b){var e;for(e=0;e<a;e++)ta(c,b[e]);return b}function Ma(c,a){var b=(new TextEncoder).encode(a);gb(c,b.byteLength);fb(c,b.byteLength,b);return a}function hb(c){return new DataView(c.pos.buffer,c.cur,c.end)}function ta(c,a){c.pos.setInt8(c.end,a);c.end+=1}function gb(c,a){c.pos.setInt32(c.end,a,!0);c.end+=4}function Na(c,a){c.pos.setBigInt64(c.end,a,!0);c.end+=8}function Fa(c,a){var b=new TextDecoder,e=new Uint8Array(c.pos.buffer,
c.pos.byteOffset),d=c.cur+a;d<=c.sz?(e=e.subarray(c.cur,d),b=b.decode(e),c.cur+=a):b=null;return b}function Oa(c){return c.pos.getInt8(c.cur++,!0)}function wa(c){return c.pos.getUint8(c.cur++,!0)}function ib(c){var a=c.pos.getInt16(c.cur,!0);c.cur+=2;return a}function oa(c){var a=c.pos.getUint16(c.cur,!0);c.cur+=2;return a}function Pa(c){var a=c.pos.getInt32(c.cur,!0);c.cur+=4;return a}function pa(c){var a=c.pos.getUint32(c.cur,!0);c.cur+=4;return a}function Qa(c){var a=c.pos.getBigInt64(c.cur,!0);
c.cur+=8;return a}function ua(c){var a=c.pos.getBigUint64(c.cur,!0);c.cur+=8;return a}function Ra(c){var a,b;a=wa(c);0<a&&(b=Fa(c,a));return b}function jb(c){var a,b;a=oa(c);0<a&&(b=La(c,a));return b}function $(c){var a;a=oa(c);return Fa(c,a)}function Sa(c){var a;a=pa(c);return Fa(c,a)}function kb(c){var a=pa(c),b={pos:new DataView(c.pos.buffer,c.cur,a),end:a,sz:a,cur:0};c.cur+=a;return b}function lb(){var c=document.getElementById("dmi_play_btn");h.dmi_play_cfg.is.fill?mb(h.dmi_play_cfg.is.play):
(h.dmi_play_cfg.is.fill=1,h.dmi_play_cfg._el_act=-1,h.dmi_play_cfg.el=[new Audio,new Audio],h.dmi_play_cfg.el[0].oncanplay=function(){dmi_progress_end_cb(c);h.dmi_play_cfg._el_act=!h.dmi_play_cfg._el_act?1:0;Ga()});"mediaSession"in navigator&&(h.dmi_play_cfg.is.mediaSession=1,navigator.mediaSession.metadata=new MediaMetadata({artwork:[{src:"https://dummyimage.com/96x96",sizes:"96x96",type:"image/png"},{src:"https://dummyimage.com/128x128",sizes:"128x128",type:"image/png"},{src:"https://dummyimage.com/192x192",
sizes:"192x192",type:"image/png"},{src:"https://dummyimage.com/256x256",sizes:"256x256",type:"image/png"},{src:"https://dummyimage.com/384x384",sizes:"384x384",type:"image/png"},{src:"https://dummyimage.com/512x512",sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",Ga),navigator.mediaSession.setActionHandler("pause",Ta),navigator.mediaSession.setActionHandler("previoustrack",nb),navigator.mediaSession.setActionHandler("nexttrack",ob));return 0}function pb(c,a,b,e){var d=
"http://"===a.substr(0,7);h.dmi_play_cfg.ls.push({id:c,title:b,img:e,nosecurity:d,src:a});-1===h.dmi_play_cfg._el_act&&(h.dmi_play_cfg._el_act=0,h.dmi_play_cfg.current=-1);return 0}function Ga(){if(-1===h.dmi_play_cfg._el_act)return-1;var c=h.dmi_play_cfg,a=c.el[c._el_act];c.is.play||(c._irep=10,c.is.play=1,a.play(),c._play_interval=window.setInterval(function(){--c._irep?0.9>=a.volume&&(a.volume+=0.1):(a.volume=1,window.clearInterval(c._play_interval))},30));dm_play.className="act";dm_play.firstChild.className=
"i24 pause";return 0}function Ta(){if(-1===h.dmi_play_cfg._el_act)return-1;var c=h.dmi_play_cfg,a=c.el[c._el_act];c.is.play&&(c._ipause=10,c.is.play=0,c._pause_interval=window.setInterval(function(){--c._ipause?0.1<=a.volume&&(a.volume-=0.1):(a.pause(),window.clearInterval(c._pause_interval))},30),h.dmi_play_cfg.is.play=0);return 0}function mb(c){c?Ga():Ta();return 0}function ob(){}function nb(){}function qb(c,a){var b=a.children[0],e,d;if(!b)return-1;e=b.children[1];d=b.children[0];if(e&&0===e.childNodes.length)return-1;
c.link=b.pathname;c.id=Number(b.pathname.substr(7));c.dat_link=b.getAttribute("data-id");10===c.id&&(c.dat_link="http://95.154.196.33:38186/gagauzradiosu");e&&(c.title=e.childNodes[0].nodeValue,e.children[0]&&(c.desc=e.children[0].innerText));d&&"IMG"===d.tagName.toUpperCase()?c.img=window.location.href.toString()===d.src?null:d.src:c.img=null;return 0}function Ua(c,a,b){var e,d,f;if((d=a.children)&&d.length){c=Array(d.length);for(var g=0;g<d.length;g++)f=d[g],c[g]={},e=c[g],-1!==qb(e,f)&&(b.data.push(e),
e.exec(e,-1,0),a.replaceChild(e.el,f))}return 0}function rb(){var c,a,b;if("undefined"==typeof act_mod_id)return 0;c=act_mod_id;if(!c||"media"!==c.className)return 0;c=c.querySelectorAll("a");for(a=0;a<c.length;a++)b=c[a],b.getAttribute("data-id");return 0}function sb(c,a){c._color_id=256;c._cid=setInterval(function(){c._color_id--?c.style.background=a+c._color_id.toString(16):(c.style.background="",clearInterval(c._cid))},10);return 0}var h={};"undefined"!==typeof window&&function(c,a){"object"===
typeof h&&"object"===typeof module?module.exports=a():"function"===typeof define&&define.amd?define([],a):"object"===typeof h?h.Hls=a():c.Hls=a()}(this,function(){return function(c){function a(e){if(b[e])return b[e].exports;var d=b[e]={i:e,l:!1,exports:{}};c[e].call(d.exports,d,d.exports,a);d.l=!0;return d.exports}var b={};a.m=c;a.c=b;a.d=function(b,c,f){a.o(b,c)||Object.defineProperty(b,c,{enumerable:!0,get:f})};a.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})};a.t=function(b,c){c&1&&(b=a(b));if(c&8||c&4&&"object"===typeof b&&b&&b.__esModule)return b;var f=Object.create(null);a.r(f);Object.defineProperty(f,"default",{enumerable:!0,value:b});if(c&2&&"string"!=typeof b)for(var g in b)a.d(f,g,function(a){return b[a]}.bind(null,g));return f};a.n=function(b){var c=b&&b.__esModule?function(){return b["default"]}:function(){return b};a.d(c,"a",c);return c};a.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,
b)};a.p="/dist/";return a(a.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(c,a,b){function e(){}function d(a,b,c){this.fn=a;this.context=b;this.once=c||!1}function f(a,b,c,f,e){if("function"!==typeof c)throw new TypeError("The listener must be a function");c=new d(c,f||a,e);b=t?t+b:b;a._events[b]?a._events[b].fn?a._events[b]=[a._events[b],c]:a._events[b].push(c):(a._events[b]=c,a._eventsCount++);return a}function g(a,b){0===--a._eventsCount?a._events=new e:delete a._events[b]}
function n(){this._events=new e;this._eventsCount=0}var k=Object.prototype.hasOwnProperty,t="~";Object.create&&(e.prototype=Object.create(null),(new e).__proto__||(t=!1));n.prototype.eventNames=function(){var a=[],b,c;if(0===this._eventsCount)return a;for(c in b=this._events)k.call(b,c)&&a.push(t?c.slice(1):c);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};n.prototype.listeners=function(a){a=this._events[t?t+a:a];if(!a)return[];if(a.fn)return[a.fn];for(var b=0,c=
a.length,d=Array(c);b<c;b++)d[b]=a[b].fn;return d};n.prototype.listenerCount=function(a){a=this._events[t?t+a:a];return!a?0:a.fn?1:a.length};n.prototype.emit=function(a,b,c,d,f,e){var q=t?t+a:a;if(!this._events[q])return!1;var q=this._events[q],u=arguments.length,k,m;if(q.fn){q.once&&this.removeListener(a,q.fn,void 0,!0);switch(u){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,b),!0;case 3:return q.fn.call(q.context,b,c),!0;case 4:return q.fn.call(q.context,b,c,d),!0;case 5:return q.fn.call(q.context,
b,c,d,f),!0;case 6:return q.fn.call(q.context,b,c,d,f,e),!0}m=1;for(k=Array(u-1);m<u;m++)k[m-1]=arguments[m];q.fn.apply(q.context,k)}else{var y=q.length,v;for(m=0;m<y;m++)switch(q[m].once&&this.removeListener(a,q[m].fn,void 0,!0),u){case 1:q[m].fn.call(q[m].context);break;case 2:q[m].fn.call(q[m].context,b);break;case 3:q[m].fn.call(q[m].context,b,c);break;case 4:q[m].fn.call(q[m].context,b,c,d);break;default:if(!k){v=1;for(k=Array(u-1);v<u;v++)k[v-1]=arguments[v]}q[m].fn.apply(q[m].context,k)}}return!0};
n.prototype.on=function(a,b,c){return f(this,a,b,c,!1)};n.prototype.once=function(a,b,c){return f(this,a,b,c,!0)};n.prototype.removeListener=function(a,b,c,d){a=t?t+a:a;if(!this._events[a])return this;if(!b)return g(this,a),this;var f=this._events[a];if(f.fn)f.fn===b&&((!d||f.once)&&(!c||f.context===c))&&g(this,a);else{for(var e=0,q=[],u=f.length;e<u;e++)(f[e].fn!==b||d&&!f[e].once||c&&f[e].context!==c)&&q.push(f[e]);q.length?this._events[a]=1===q.length?q[0]:q:g(this,a)}return this};n.prototype.removeAllListeners=
function(a){a?(a=t?t+a:a,this._events[a]&&g(this,a)):(this._events=new e,this._eventsCount=0);return this};n.prototype.off=n.prototype.removeListener;n.prototype.addListener=n.prototype.on;n.prefixed=t;n.EventEmitter=n;c.exports=n},"./node_modules/url-toolkit/src/url-toolkit.js":function(c,a,b){(function(a){var b=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,f=/^(?=([^\/?#]*))\1([^]*)$/,g=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,
k={buildAbsoluteURL:function(a,b,c){c=c||{};a=a.trim();b=b.trim();if(!b){if(!c.alwaysNormalize)return a;c=k.parseURL(a);if(!c)throw Error("Error trying to parse base URL.");c.path=k.normalizePath(c.path);return k.buildURLFromParts(c)}var d=k.parseURL(b);if(!d)throw Error("Error trying to parse relative URL.");if(d.scheme){if(!c.alwaysNormalize)return b;d.path=k.normalizePath(d.path);return k.buildURLFromParts(d)}b=k.parseURL(a);if(!b)throw Error("Error trying to parse base URL.");!b.netLoc&&(b.path&&
"/"!==b.path[0])&&(a=f.exec(b.path),b.netLoc=a[1],b.path=a[2]);b.netLoc&&!b.path&&(b.path="/");a={scheme:b.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};d.netLoc||(a.netLoc=b.netLoc,"/"!==d.path[0]&&(d.path?(b=b.path,b=b.substring(0,b.lastIndexOf("/")+1)+d.path,a.path=k.normalizePath(b)):(a.path=b.path,d.params||(a.params=b.params,d.query||(a.query=b.query)))));null===a.path&&(a.path=c.alwaysNormalize?k.normalizePath(d.path):d.path);return k.buildURLFromParts(a)},
parseURL:function(a){a=b.exec(a);return!a?null:{scheme:a[1]||"",netLoc:a[2]||"",path:a[3]||"",params:a[4]||"",query:a[5]||"",fragment:a[6]||""}},normalizePath:function(a){for(a=a.split("").reverse().join("").replace(g,"");a.length!==(a=a.replace(n,"")).length;);return a.split("").reverse().join("")},buildURLFromParts:function(a){return a.scheme+a.netLoc+a.path+a.params+a.query+a.fragment}};c.exports=k})(this)},"./node_modules/webworkify-webpack/index.js":function(c,a,b){function e(a){function b(d){if(c[d])return c[d].exports;
var f=c[d]={i:d,l:!1,exports:{}};a[d].call(f.exports,f,f.exports,b);f.l=!0;return f.exports}var c={};b.m=a;b.c=c;b.i=function(a){return a};b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})};b.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})};b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};b.d(c,"a",c);return c};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="/";b.oe=function(a){console.error(a);
throw a;};var d=b(b.s=ENTRY_MODULE);return d.default||d}function d(a){return(a+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(a){return Object.keys(a).reduce(function(b,c){return b||0<a[c].length},!1)}function g(a,c){for(var e={main:[c]},r={main:[]},g={main:{}};f(e);)for(var z=Object.keys(e),A=0;A<z.length;A++){var q=z[A],u=e[q].pop();g[q]=g[q]||{};if(!g[q][u]&&a[q][u]){g[q][u]=!0;r[q]=r[q]||[];r[q].push(u);var D=a,m=a[q][u],u=q,q={};q[u]=[];var m=m.toString(),y=m.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);
if(y){for(var y=y[1],v=RegExp("(\\\\n|\\W)"+d(y)+k,"g"),p=void 0;p=v.exec(m);)"dll-reference"!==p[3]&&q[u].push(p[3]);for(v=RegExp("\\("+d(y)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+k,"g");p=v.exec(m);)D[p[2]]||(q[u].push(p[1]),D[p[2]]=b(p[1]).m),q[p[2]]=q[p[2]]||[],q[p[2]].push(p[4]);D=Object.keys(q);for(u=0;u<D.length;u++)for(m=0;m<q[D[u]].length;m++)!isNaN(1*q[D[u]][m])&&(q[D[u]][m]*=1)}D=Object.keys(q);for(u=0;u<D.length;u++)e[D[u]]=e[D[u]]||[],e[D[u]]=e[D[u]].concat(q[D[u]])}}return r}var n="[\\.|\\-|\\+|\\w|/|@]+",
k="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+n+").*?\\)";c.exports=function(a,c){c=c||{};var d={main:b.m},f=c.all?{main:Object.keys(d.main)}:g(d,a),k="";Object.keys(f).filter(function(a){return"main"!==a}).forEach(function(a){for(var b=0;f[a][b];)b++;f[a].push(b);d[a][b]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";k=k+"var "+a+" = ("+e.toString().replace("ENTRY_MODULE",JSON.stringify(b))+")({"+f[a].map(function(b){return""+JSON.stringify(b)+": "+d[a][b].toString()}).join(",")+
"});\n"});var k=k+"new (("+e.toString().replace("ENTRY_MODULE",JSON.stringify(a))+")({"+f.main.map(function(a){return""+JSON.stringify(a)+": "+d.main[a].toString()}).join(",")+"}))(self);",z=new window.Blob([k],{type:"text/javascript"});if(c.bare)return z;var z=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(z),A=new window.Worker(z);A.objectURL=z;return A}},"./src/config.ts":function(c,a,b){function e(){e=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=
arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}function d(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,d)}return c}function f(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?d(Object(c),!0).forEach(function(b){var d=c[b];b in a?Object.defineProperty(a,
b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):d(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function g(a,b){if((b.liveSyncDurationCount||b.liveMaxLatencyDurationCount)&&(b.liveSyncDuration||b.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");
if(void 0!==b.liveMaxLatencyDurationCount&&(void 0===b.liveSyncDurationCount||b.liveMaxLatencyDurationCount<=b.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==b.liveMaxLatencyDuration&&(void 0===b.liveSyncDuration||b.liveMaxLatencyDuration<=b.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return e({},a,b)}function n(a){var b=
a.loader;b!==r["default"]&&b!==w["default"]?(z.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),a.progressive=!1):Object(r.fetchSupported)()&&(a.loader=r["default"],a.progressive=!0,a.enableSoftwareAES=!0,z.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}b.r(a);b.d(a,"hlsDefaultConfig",function(){return A});b.d(a,"mergeConfig",function(){return g});b.d(a,"enableStreamingMode",function(){return n});c=b("./src/controller/abr-controller.ts");
a=b("./src/empty.js");a=b.n(a);var k=b("./src/controller/buffer-controller.ts"),t=b("./src/controller/cap-level-controller.ts"),l=b("./src/controller/fps-controller.ts"),w=b("./src/utils/xhr-loader.ts"),r=b("./src/utils/fetch-loader.ts"),C=b("./src/utils/mediakeys-helper.ts"),z=b("./src/utils/logger.ts"),A=f(f({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,
maxBufferSize:6E7,maxBufferHole:0.1,highBufferWatchdogPeriod:2,nudgeOffset:0.1,nudgeMaxRetry:3,maxFragLookUpTolerance:0.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1E4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1E3,manifestLoadingMaxRetryTimeout:64E3,startLevel:void 0,
levelLoadingTimeOut:1E4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1E3,levelLoadingMaxRetryTimeout:64E3,fragLoadingTimeOut:2E4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1E3,fragLoadingMaxRetryTimeout:64E3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5E3,fpsDroppedMonitoringThreshold:0.2,appendErrorMaxRetry:3,loader:w["default"],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:c["default"],bufferController:k["default"],capLevelController:t["default"],
fpsController:l["default"],stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5E5,abrBandWidthFactor:0.95,abrBandWidthUpFactor:0.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:C.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,
cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:a.a,enableWebVTT:!1,enableIMSC1:!1,enableCEA708Captions:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:void 0,
subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0,cmcdController:void 0})},"./src/controller/abr-controller.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);var f=b("./src/polyfills/number.ts"),
g=b("./src/utils/ewma-bandwidth-estimator.ts"),n=b("./src/events.ts"),k=b("./src/utils/buffer-helper.ts"),t=b("./src/errors.ts"),l=b("./src/types/loader.ts"),w=b("./src/utils/logger.ts");c=function(){function a(b){this.hls=void 0;this.lastLoadedFragLevel=0;this._nextAutoLevel=-1;this.timer=void 0;this.onCheck=this._abandonRulesCheck.bind(this);this.partCurrent=this.fragCurrent=null;this.bitrateTestDelay=0;this.bwEstimator=void 0;this.hls=b;b=b.config;this.bwEstimator=new g["default"](b.abrEwmaSlowVoD,
b.abrEwmaFastVoD,b.abrEwmaDefaultEstimate);this.registerListeners()}var b=a.prototype;b.registerListeners=function(){var a=this.hls;a.on(n.Events.FRAG_LOADING,this.onFragLoading,this);a.on(n.Events.FRAG_LOADED,this.onFragLoaded,this);a.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this);a.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.on(n.Events.ERROR,this.onError,this)};b.unregisterListeners=function(){var a=this.hls;a.off(n.Events.FRAG_LOADING,this.onFragLoading,this);a.off(n.Events.FRAG_LOADED,
this.onFragLoaded,this);a.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this);a.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.off(n.Events.ERROR,this.onError,this)};b.destroy=function(){this.unregisterListeners();this.clearTimer();this.fragCurrent=this.partCurrent=this.hls=this.onCheck=null};b.onFragLoading=function(a,b){var c=b.frag;if(c.type===l.PlaylistLevelType.MAIN&&!this.timer){var d;this.fragCurrent=c;this.partCurrent=null!=(d=b.part)?d:null;this.timer=self.setInterval(this.onCheck,
100)}};b.onLevelLoaded=function(a,b){var c=this.hls.config;b.details.live?this.bwEstimator.update(c.abrEwmaSlowLive,c.abrEwmaFastLive):this.bwEstimator.update(c.abrEwmaSlowVoD,c.abrEwmaFastVoD)};b._abandonRulesCheck=function(){var a=this.fragCurrent,b=this.partCurrent,c=this.hls,d=c.autoLevelEnabled,e=c.config,m=c.media;if(a&&m){var y=b?b.stats:a.stats,v=b?b.duration:a.duration;if(y.aborted)w.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=
-1;else if(d&&!m.paused&&m.playbackRate&&m.readyState){var d=performance.now()-y.loading.start,p=Math.abs(m.playbackRate);if(!(d<=500*v/p)){var x=c.levels,l=c.minAutoLevel,r=x[a.level],g=y.total||Math.max(y.loaded,Math.round(v*r.maxBitrate/8)),r=Math.max(1,y.bwEstimate?y.bwEstimate/8:1E3*y.loaded/d),g=(g-y.loaded)/r,t=m.currentTime,e=(k.BufferHelper.bufferInfo(m,t,e.maxBufferHole).end-t)/p;if(!(e>=2*v/p||g<=e)){m=Number.POSITIVE_INFINITY;for(p=a.level-1;p>l&&!(m=v*x[p].maxBitrate/(6.4*r),m<e);p--);
m>=g||(v=this.bwEstimator.getEstimate(),w.logger.warn("Fragment "+a.sn+(b?" part "+b.index:"")+" of level "+a.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+p+"\n      Current BW estimate: "+(Object(f.isFiniteNumber)(v)?(v/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+g.toFixed(3)+" s\n      Estimated load time for the next fragment: "+m.toFixed(3)+" s\n      Time to underbuffer: "+e.toFixed(3)+" s"),c.nextLoadLevel=
p,this.bwEstimator.sample(d,y.loaded),this.clearTimer(),a.loader&&(this.fragCurrent=this.partCurrent=null,a.loader.abort()),c.trigger(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:a,part:b,stats:y}))}}}}};b.onFragLoaded=function(a,b){var c=b.frag,d=b.part;if(c.type===l.PlaylistLevelType.MAIN&&Object(f.isFiniteNumber)(c.sn)){var e=d?d.stats:c.stats,m=d?d.duration:c.duration;this.clearTimer();this.lastLoadedFragLevel=c.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var k=this.hls.levels[c.level],
v=(k.loaded?k.loaded.bytes:0)+e.loaded,m=(k.loaded?k.loaded.duration:0)+m;k.loaded={bytes:v,duration:m};k.realBitrate=Math.round(8*v/m)}if(c.bitrateTest)this.onFragBuffered(n.Events.FRAG_BUFFERED,{stats:e,frag:c,part:d,id:c.type})}};b.onFragBuffered=function(a,b){var c=b.frag,d=b.part,d=d?d.stats:c.stats;if(!d.aborted&&!(c.type!==l.PlaylistLevelType.MAIN||"initSegment"===c.sn)){var f=d.parsing.end-d.loading.start;this.bwEstimator.sample(f,d.loaded);d.bwEstimate=this.bwEstimator.getEstimate();this.bitrateTestDelay=
c.bitrateTest?f/1E3:0}};b.onError=function(a,b){switch(b.details){case t.ErrorDetails.FRAG_LOAD_ERROR:case t.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}};b.clearTimer=function(){self.clearInterval(this.timer);this.timer=void 0};b.getNextABRAutoLevel=function(){var a=this.fragCurrent,b=this.partCurrent,c=this.hls,d=c.maxAutoLevel,f=c.config,m=c.minAutoLevel,c=c.media,a=b?b.duration:a?a.duration:0,e=c?c.currentTime:0,v=c&&0!==c.playbackRate?Math.abs(c.playbackRate):1,b=this.bwEstimator?this.bwEstimator.getEstimate():
f.abrEwmaDefaultEstimate,c=(k.BufferHelper.bufferInfo(c,e,f.maxBufferHole).end-e)/v,e=this.findBestLevel(b,m,d,c,f.abrBandWidthFactor,f.abrBandWidthUpFactor);if(0<=e)return e;w.logger.trace((c?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var e=a?Math.min(a,f.maxStarvationDelay):f.maxStarvationDelay,v=f.abrBandWidthFactor,p=f.abrBandWidthUpFactor;if(!c){var x=this.bitrateTestDelay;x&&(e=(a?Math.min(a,f.maxLoadingDelay):f.maxLoadingDelay)-x,w.logger.trace("bitrate test took "+
Math.round(1E3*x)+"ms, set first fragment max fetchDuration to "+Math.round(1E3*e)+" ms"),v=p=1)}e=this.findBestLevel(b,m,d,c+e,v,p);return Math.max(e,0)};b.findBestLevel=function(a,b,c,d,f,m){var e,k=this.fragCurrent,p=this.partCurrent,x=this.lastLoadedFragLevel,l=this.hls.levels,r=l[x],g=!!(null!==r&&void 0!==r&&null!==(e=r.details)&&void 0!==e&&e.live);e=null===r||void 0===r?void 0:r.codecSet;for(k=p?p.duration:k?k.duration:0;c>=b;c--)if((r=l[c])&&!(e&&r.codecSet!==e)){var r=r.details,r=(p?null===
r||void 0===r?void 0:r.partTarget:null===r||void 0===r?void 0:r.averagetargetduration)||k,n=void 0,n=c<=x?f*a:m*a,V=l[c].maxBitrate,t=V*r/n;w.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(n)+"/"+V+"/"+r+"/"+d+"/"+t);if(n>V&&(!t||g&&!this.bitrateTestDelay||t<d))return c}return-1};d(a,[{key:"nextAutoLevel",get:function(){var a=this._nextAutoLevel,b=this.bwEstimator;if(-1!==a&&!b.canEstimate())return a;b=this.getNextABRAutoLevel();if(-1!==a&&this.hls.levels[b].loadError)return a;
-1!==a&&(b=Math.min(a,b));return b},set:function(a){this._nextAutoLevel=a}}]);return a}();a["default"]=c},"./src/controller/base-playlist-controller.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return k});var e=b("./src/polyfills/number.ts"),d=b("./src/types/level.ts"),f=b("./src/controller/level-helper.ts"),g=b("./src/utils/logger.ts"),n=b("./src/errors.ts"),k=function(){function a(b,c){this.hls=void 0;this.timer=-1;this.canLoad=!1;this.retryCount=0;this.warn=this.log=void 0;this.log=g.logger.log.bind(g.logger,
c+":");this.warn=g.logger.warn.bind(g.logger,c+":");this.hls=b}var b=a.prototype;b.destroy=function(){this.clearTimer();this.hls=this.log=this.warn=null};b.onError=function(a,b){b.fatal&&b.type===n.ErrorTypes.NETWORK_ERROR&&this.clearTimer()};b.clearTimer=function(){clearTimeout(this.timer);this.timer=-1};b.startLoad=function(){this.canLoad=!0;this.retryCount=0;this.loadPlaylist()};b.stopLoad=function(){this.canLoad=!1;this.clearTimer()};b.switchParams=function(a,b){var c=null===b||void 0===b?void 0:
b.renditionReports;if(c)for(var f=0;f<c.length;f++){var k=c[f],q=""+k.URI;if(q===a.slice(-q.length)){q=parseInt(k["LAST-MSN"]);k=parseInt(k["LAST-PART"]);if(b&&this.hls.config.lowLatencyMode){var u=Math.min(b.age-b.partTarget,b.targetduration);void 0!==k&&u>b.partTarget&&(k+=1)}if(Object(e.isFiniteNumber)(q))return new d.HlsUrlParameters(q,Object(e.isFiniteNumber)(k)?k:void 0,d.HlsSkip.No)}}};b.loadPlaylist=function(a){};b.shouldLoadTrack=function(a){return this.canLoad&&a&&!!a.url&&(!a.details||
a.details.live)};b.playlistLoaded=function(a,b,c){var d=this,e=b.details,k=b.stats,u=k.loading.end?Math.max(0,self.performance.now()-k.loading.end):0;e.advancedDateTime=Date.now()-u;if(e.live||null!==c&&void 0!==c&&c.live){if(e.reloaded(c),c&&this.log("live playlist "+a+" "+(e.advanced?"REFRESHED "+e.lastPartSn+"-"+e.lastPartIndex:"MISSED")),c&&0<e.fragments.length&&Object(f.mergeDetails)(c,e),this.canLoad&&e.live){var l,m=void 0,u=void 0;if(e.canBlockReload&&e.endSN&&e.advanced){var y=this.hls.config.lowLatencyMode,
m=e.lastPartSn,v=e.endSN,p=e.lastPartIndex,x=m===v,g=y?0:p;-1!==p?(m=x?v+1:m,u=x?g:p+1):m=v+1;p=e.age;g=Math.min(p+e.ageHeader-e.partTarget,1.5*e.targetduration);0<g&&(c&&g>c.tuneInGoal?(this.warn("CDN Tune-in goal increased from: "+c.tuneInGoal+" to: "+g+" with playlist age: "+e.age),g=0):(c=Math.floor(g/e.targetduration),m+=c,void 0!==u&&(v=Math.round(g%e.targetduration/e.partTarget),u+=v),this.log("CDN Tune-in age: "+e.ageHeader+"s last advanced "+p.toFixed(2)+"s goal: "+g+" skip sn "+c+" to part "+
u)),e.tuneInGoal=g);l=this.getDeliveryDirectives(e,b.deliveryDirectives,m,u);if(y||!x){this.loadPlaylist(l);return}}else l=this.getDeliveryDirectives(e,b.deliveryDirectives,m,u);b=Object(f.computeReloadInterval)(e,k);void 0!==m&&e.canBlockReload&&(b-=e.partTarget||1);this.log("reload live playlist "+a+" in "+Math.round(b)+" ms");this.timer=self.setTimeout(function(){return d.loadPlaylist(l)},b)}}else this.clearTimer()};b.getDeliveryDirectives=function(a,b,c,e){var f=Object(d.getSkipValue)(a,c);null!==
b&&(void 0!==b&&b.skip&&a.deltaUpdateFailed)&&(c=b.msn,e=b.part,f=d.HlsSkip.No);return new d.HlsUrlParameters(c,e,f)};b.retryLoadingOrFail=function(a){var b=this,c=this.hls.config,d=this.retryCount<c.levelLoadingMaxRetry;if(d){var e;this.retryCount++;-1<a.details.indexOf("LoadTimeOut")&&null!==(e=a.context)&&void 0!==e&&e.deliveryDirectives?(this.warn("retry playlist loading #"+this.retryCount+' after "'+a.details+'"'),this.loadPlaylist()):(c=Math.min(Math.pow(2,this.retryCount)*c.levelLoadingRetryDelay,
c.levelLoadingMaxRetryTimeout),this.timer=self.setTimeout(function(){return b.loadPlaylist()},c),this.warn("retry playlist loading #"+this.retryCount+" in "+c+' ms after "'+a.details+'"'))}else this.warn('cannot recover from error "'+a.details+'"'),this.clearTimer(),a.fatal=!0;return d};return a}()},"./src/controller/base-stream-controller.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,
d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}function f(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function g(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;n(a,b)}function n(a,b){n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return n(a,b)}b.r(a);b.d(a,"State",function(){return x});b.d(a,"default",
function(){return qa});var k=b("./src/polyfills/number.ts");c=b("./src/task-loop.ts");var t=b("./src/controller/fragment-tracker.ts"),l=b("./src/utils/buffer-helper.ts"),w=b("./src/utils/logger.ts"),r=b("./src/events.ts"),C=b("./src/errors.ts"),z=b("./src/types/transmuxer.ts"),A=b("./src/utils/mp4-tools.ts"),q=b("./src/utils/discontinuities.ts"),u=b("./src/controller/fragment-finders.ts"),D=b("./src/controller/level-helper.ts"),m=b("./src/loader/fragment-loader.ts"),y=b("./src/crypt/decrypter.ts"),
v=b("./src/utils/time-ranges.ts"),p=b("./src/types/loader.ts"),x={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},qa=function(a){function b(c,d,p){var e;e=a.call(this)||this;e.hls=void 0;e.fragPrevious=null;e.fragCurrent=null;e.fragmentTracker=void 0;
e.transmuxer=null;e._state=x.STOPPED;e.media=null;e.mediaBuffer=null;e.config=void 0;e.bitrateTest=!1;e.lastCurrentTime=0;e.nextLoadPosition=0;e.startPosition=0;e.loadedmetadata=!1;e.fragLoadError=0;e.retryDate=0;e.levels=null;e.fragmentLoader=void 0;e.levelLastLoaded=null;e.startFragRequested=!1;e.decrypter=void 0;e.initPTS=[];e.onvseeking=null;e.onvended=null;e.logPrefix="";e.log=void 0;e.warn=void 0;e.logPrefix=p;e.log=w.logger.log.bind(w.logger,p+":");e.warn=w.logger.warn.bind(w.logger,p+":");
e.hls=c;e.fragmentLoader=new m["default"](c.config);e.fragmentTracker=d;e.config=c.config;e.decrypter=new y["default"](c,c.config);c.on(r.Events.KEY_LOADED,e.onKeyLoaded,f(e));c.on(r.Events.LEVEL_SWITCHING,e.onLevelSwitching,f(e));return e}g(b,a);var c=b.prototype;c.doTick=function(){this.onTickEnd()};c.onTickEnd=function(){};c.startLoad=function(a){};c.stopLoad=function(){this.fragmentLoader.abort();var a=this.fragCurrent;a&&this.fragmentTracker.removeFragment(a);this.resetTransmuxer();this.fragPrevious=
this.fragCurrent=null;this.clearInterval();this.clearNextTick();this.state=x.STOPPED};c._streamEnded=function(a,b){var c=this.fragCurrent,d=this.fragmentTracker;if(!b.live&&c&&this.media&&c.sn>=b.endSN&&!a.nextStart){var p=b.partList;if(null!==p&&void 0!==p&&p.length)return c=p[p.length-1],l.BufferHelper.isBuffered(this.media,c.start+c.duration/2);c=d.getState(c);return c===t.FragmentState.PARTIAL||c===t.FragmentState.OK}return!1};c.onMediaAttached=function(a,b){var c=this.media=this.mediaBuffer=
b.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);c.addEventListener("seeking",this.onvseeking);c.addEventListener("ended",this.onvended);c=this.config;this.levels&&(c.autoStartLoad&&this.state===x.STOPPED)&&this.startLoad(c.startPosition)};c.onMediaDetaching=function(){var a=this.media;null!==a&&(void 0!==a&&a.ended)&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);a&&(this.onvseeking&&this.onvended)&&
(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null);this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.fragmentTracker.removeAllFragments();this.stopLoad()};c.onMediaSeeking=function(){var a=this.config,b=this.fragCurrent,c=this.media,d=this.mediaBuffer,p=this.state,e=c?c.currentTime:0,d=l.BufferHelper.bufferInfo(d?d:c,e,a.maxBufferHole);this.log("media seeking to "+(Object(k.isFiniteNumber)(e)?e.toFixed(3):e)+
", state: "+p);if(p===x.ENDED)this.resetLoadingState();else if(b&&!d.len&&(a=a.maxFragLookUpTolerance,p=e>b.start+b.duration+a,e<b.start-a||p))p&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState();c&&(this.lastCurrentTime=e);!this.loadedmetadata&&!d.len&&(this.nextLoadPosition=this.startPosition=e);this.tickImmediate()};c.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0};c.onKeyLoaded=function(a,
b){if(!(this.state!==x.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=x.IDLE;var c=this.levels[b.frag.level].details;c&&this.loadFragment(b.frag,c,b.frag.start)}};c.onLevelSwitching=function(a,b){this.fragLoadError=0};c.onHandlerDestroying=function(){this.stopLoad();a.prototype.onHandlerDestroying.call(this)};c.onHandlerDestroyed=function(){this.state=x.STOPPED;this.hls.off(r.Events.KEY_LOADED,this.onKeyLoaded,this);this.hls.off(r.Events.LEVEL_SWITCHING,this.onLevelSwitching,this);
this.fragmentLoader&&this.fragmentLoader.destroy();this.decrypter&&this.decrypter.destroy();this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null;a.prototype.onHandlerDestroyed.call(this)};c.loadKey=function(a,b){this.log("Loading key for "+a.sn+" of ["+b.startSN+"-"+b.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+a.level);this.state=x.KEY_LOADING;this.fragCurrent=a;this.hls.trigger(r.Events.KEY_LOADING,{frag:a})};c.loadFragment=function(a,
b,c){this._loadFragForPlayback(a,b,c)};c._loadFragForPlayback=function(a,b,c){var d=this;this._doFragLoad(a,b,c,function(b){d.fragContextChanged(a)?(d.warn("Fragment "+a.sn+(b.part?" p: "+b.part.index:"")+" of level "+a.level+" was dropped during download."),d.fragmentTracker.removeFragment(a)):(a.stats.chunkCount++,d._handleFragmentLoadProgress(b))}).then(function(b){if(b){d.fragLoadError=0;var c=d.state;if(d.fragContextChanged(a)){if(c===x.FRAG_LOADING||!d.fragCurrent&&c===x.PARSING)d.fragmentTracker.removeFragment(a),
d.state=x.IDLE}else"payload"in b&&(d.log("Loaded fragment "+a.sn+" of level "+a.level),d.hls.trigger(r.Events.FRAG_LOADED,b)),d._handleFragmentLoadComplete(b)}}).catch(function(b){d.state===x.STOPPED||d.state===x.ERROR||(d.warn(b),d.resetFragmentLoading(a))})};c.flushMainBuffer=function(a,b,c){void 0===c&&(c=null);a-b&&(a={startOffset:a,endOffset:b,type:c},this.fragLoadError=0,this.hls.trigger(r.Events.BUFFER_FLUSHING,a))};c._loadInitSegment=function(a){var b=this;this._doFragLoad(a).then(function(c){if(!c||
b.fragContextChanged(a)||!b.levels)throw Error("init load aborted");return c}).then(function(c){var d=b.hls,p=c.payload,e=a.decryptdata;if(p&&0<p.byteLength&&e&&e.key&&e.iv&&"AES-128"===e.method){var x=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(p),e.key.buffer,e.iv.buffer).then(function(b){var p=self.performance.now();d.trigger(r.Events.FRAG_DECRYPTED,{frag:a,payload:b,stats:{tstart:x,tdecrypt:p}});c.payload=b;return c})}return c}).then(function(c){var d=b.fragCurrent,
p=b.hls,e=b.levels;if(!e)throw Error("init load aborted, missing levels");console.assert(e[a.level].details,"Level details are defined when init segment is loaded");e=a.stats;b.state=x.IDLE;b.fragLoadError=0;a.data=new Uint8Array(c.payload);e.parsing.start=e.buffering.start=self.performance.now();e.parsing.end=e.buffering.end=self.performance.now();c.frag===d&&p.trigger(r.Events.FRAG_BUFFERED,{stats:e,frag:d,part:null,id:a.type});b.tick()}).catch(function(c){b.state===x.STOPPED||b.state===x.ERROR||
(b.warn(c),b.resetFragmentLoading(a))})};c.fragContextChanged=function(a){var b=this.fragCurrent;return!a||!b||a.level!==b.level||a.sn!==b.sn||a.urlId!==b.urlId};c.fragBufferedComplete=function(a,b){var c=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+a.type+" sn: "+a.sn+(b?" part: "+b.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+a.level+" "+(c?v["default"].toString(l.BufferHelper.getBuffered(c)):"(detached)"));this.state=x.IDLE;c&&(!this.loadedmetadata&&
(c.buffered.length&&this.fragCurrent===this.fragPrevious)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())};c.seekToStartPos=function(){};c._handleFragmentLoadComplete=function(a){var b=this.transmuxer;if(b){var c=a.frag,d=a.part;a=a.partsLoaded;a=!a||0===a.length||a.some(function(a){return!a});c=new z.ChunkMetadata(c.level,c.sn,c.stats.chunkCount+1,0,d?d.index:-1,!a);b.flush(c)}};c._handleFragmentLoadProgress=function(a){};c._doFragLoad=function(a,b,c,d){var p=this;void 0===c&&(c=null);
if(!this.levels)throw Error("frag load aborted, missing levels");c=Math.max(a.start,c||0);if(this.config.lowLatencyMode&&b){var e=b.partList;if(e&&d){c>a.end&&b.fragmentHint&&(a=b.fragmentHint);var m=this.getNextPart(e,a,c);if(-1<m){var f=e[m];this.log("Loading part sn: "+a.sn+" p: "+f.index+" cc: "+a.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+m+"-"+(e.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+a.level+", target: "+parseFloat(c.toFixed(3)));this.nextLoadPosition=
f.start+f.duration;this.state=x.FRAG_LOADING;this.hls.trigger(r.Events.FRAG_LOADING,{frag:a,part:e[m],targetBufferTime:c});return this.doFragPartsLoad(a,e,m,d).catch(function(a){return p.handleFragLoadError(a)})}if(!a.url||this.loadedEndOfParts(e,c))return Promise.resolve(null)}}this.log("Loading fragment "+a.sn+" cc: "+a.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+a.level+", target: "+parseFloat(c.toFixed(3)));Object(k.isFiniteNumber)(a.sn)&&
!this.bitrateTest&&(this.nextLoadPosition=a.start+a.duration);this.state=x.FRAG_LOADING;this.hls.trigger(r.Events.FRAG_LOADING,{frag:a,targetBufferTime:c});return this.fragmentLoader.load(a,d).catch(function(a){return p.handleFragLoadError(a)})};c.doFragPartsLoad=function(a,b,c,d){var p=this;return new Promise(function(e,x){var m=[];(function H(c){var f=b[c];p.fragmentLoader.loadPart(a,f,d).then(function(d){m[f.index]=d;var x=d.part;p.hls.trigger(r.Events.FRAG_LOADED,d);if((d=b[c+1])&&d.fragment===
a)H(c+1);else return e({frag:a,part:x,partsLoaded:m})}).catch(x)})(c)})};c.handleFragLoadError=function(a){(a=a.data)&&a.details===C.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(a.frag,a.part):this.hls.trigger(r.Events.ERROR,a);return null};c._handleTransmuxerFlush=function(a){var b=this.getCurrentContext(a);if(!b||this.state!==x.PARSING)this.fragCurrent||(this.state=x.IDLE);else{var c=b.frag,d=b.part,b=b.level,p=self.performance.now();c.stats.parsing.end=p;d&&(d.stats.parsing.end=p);
this.updateLevelTiming(c,d,b,a.partial)}};c.getCurrentContext=function(a){var b=this.levels,c=a.level,d=a.sn;a=a.part;if(!b||!b[c])return this.warn("Levels object was unset while buffering fragment "+d+" of level "+c+". The current chunk will not be buffered."),null;b=b[c];d=(c=-1<a?Object(D.getPartWith)(b,d,a):null)?c.fragment:Object(D.getFragmentWithSN)(b,d,this.fragCurrent);return!d?null:{frag:d,part:c,level:b}};c.bufferFragmentData=function(a,b,c,d){if(a&&this.state===x.PARSING){var p=a.data1,
e=a.data2,m=p;p&&e&&(m=Object(A.appendUint8Array)(p,e));m&&m.length&&(this.hls.trigger(r.Events.BUFFER_APPENDING,{type:a.type,frag:b,part:c,chunkMeta:d,parent:b.type,data:m}),a.dropped&&(a.independent&&!c)&&this.flushBufferGap(b))}};c.flushBufferGap=function(a){var b=this.media;if(b)if(l.BufferHelper.isBuffered(b,b.currentTime)){var c=b.currentTime,d=l.BufferHelper.bufferInfo(b,c,0),b=Math.min(2*this.config.maxFragLookUpTolerance,0.25*a.duration),c=Math.max(Math.min(a.start-b,d.end-b),c+b);a.start-
c>b&&this.flushMainBuffer(c,a.start)}else this.flushMainBuffer(0,a.start)};c.getFwdBufferInfo=function(a,b){var c=this.config,d=this.getLoadPosition();if(!Object(k.isFiniteNumber)(d))return null;var p=l.BufferHelper.bufferInfo(a,d,c.maxBufferHole);if(0===p.len&&void 0!==p.nextStart){var e=this.fragmentTracker.getBufferedFrag(d,b);if(e&&p.nextStart<e.end)return l.BufferHelper.bufferInfo(a,d,Math.max(p.nextStart,c.maxBufferHole))}return p};c.getMaxBufferLength=function(a){var b=this.config;a=a?Math.max(8*
b.maxBufferSize/a,b.maxBufferLength):b.maxBufferLength;return Math.min(a,b.maxMaxBufferLength)};c.reduceMaxBufferLength=function(a){var b=this.config;return b.maxMaxBufferLength>=(a||b.maxBufferLength)?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1};c.getNextFragment=function(a,b){var c=b.fragments,d=c.length;if(!d)return null;var p=this.config,e=c[0].start,x;if(b.live){e=p.initialLiveManifestSize;if(d<e)return this.warn("Not enough fragments to start playback (have: "+
d+", need: "+e+")"),null;!b.PTSKnown&&(!this.startFragRequested&&-1===this.startPosition)&&(this.startPosition=(x=this.getInitialLiveFragment(b,c))?this.hls.liveSyncPosition||x.start:a)}else a<=e&&(x=c[0]);x||(x=this.getFragmentAtPosition(a,p.lowLatencyMode?b.partEnd:b.fragmentEnd,b));return this.mapToInitFragWhenRequired(x)};c.mapToInitFragWhenRequired=function(a){return null!==a&&void 0!==a&&a.initSegment&&!(null!==a&&void 0!==a&&a.initSegment.data)&&!this.bitrateTest?a.initSegment:a};c.getNextPart=
function(a,b,c){for(var d=-1,p=!1,e=!0,x=0,m=a.length;x<m;x++){var f=a[x],e=e&&!f.independent;if(-1<d&&c<f.start)break;var k=f.loaded;if(!k&&(p||f.independent||e)&&f.fragment===b)d=x;p=k}return d};c.loadedEndOfParts=function(a,b){var c=a[a.length-1];return c&&b>c.start&&c.loaded};c.getInitialLiveFragment=function(a,b){var c=this.fragPrevious,d=null;if(c){if(a.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+c.programDateTime),d=Object(u.findFragmentByPDT)(b,
c.endProgramDateTime,this.config.maxFragLookUpTolerance)),!d){var p=c.sn+1;p>=a.startSN&&p<=a.endSN&&(p=b[p-a.startSN],c.cc===p.cc&&(d=p,this.log("Live playlist, switching playlist, load frag with next SN: "+d.sn)));d||(d=Object(u.findFragWithCC)(b,c.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+d.sn)}}else c=this.hls.liveSyncPosition,null!==c&&(d=this.getFragmentAtPosition(c,this.bitrateTest?a.fragmentEnd:a.edge,a));return d};c.getFragmentAtPosition=function(a,b,c){var d=
this.config,p=this.fragPrevious,e=c.fragments,x=c.endSN,m=c.fragmentHint,f=d.maxFragLookUpTolerance;if((d=!(!d.lowLatencyMode||!c.partList||!m))&&m&&!this.bitrateTest)e=e.concat(m),x=m.sn;if(a=a<b?Object(u.findFragmentByPTS)(p,e,a,a>b-f?0:f):e[e.length-1])c=a.sn-c.startSN,p&&(a.sn===p.sn&&!d)&&(p&&a.level===p.level)&&(p=e[c+1],a.sn<x&&this.fragmentTracker.getState(p)!==t.FragmentState.OK?(this.log("SN "+a.sn+" just loaded, load next one: "+p.sn),a=p):a=null);return a};c.synchronizeToLiveEdge=function(a){var b=
this.config,c=this.media;if(c){var d=this.hls.liveSyncPosition,p=c.currentTime,e=a.edge,x=p>=a.fragments[0].start-b.maxFragLookUpTolerance&&p<=e;if(null!==d&&c.duration>d&&(p<d||!x))if(a=void 0!==b.liveMaxLatencyDuration?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*a.targetduration,!x&&4>c.readyState||p<e-a)this.loadedmetadata||(this.nextLoadPosition=d),c.readyState&&(this.warn("Playback: "+p.toFixed(3)+" is located too far from the end of live sliding playlist: "+e+", reset currentTime to : "+
d.toFixed(3)),c.currentTime=d)}};c.alignPlaylists=function(a,b){var c=this.levels,d=this.levelLastLoaded,p=this.fragPrevious,d=null!==d?c[d]:null,c=a.fragments.length;if(!c)return this.warn("No fragments in live playlist"),0;var e=a.fragments[0].start,x=!b,m=a.alignedSliding&&Object(k.isFiniteNumber)(e);return x||!m&&!e?(Object(q.alignStream)(p,d,a),d=a.fragments[0].start,this.log("Live playlist sliding: "+d.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+a.startSN+" prev-sn: "+(p?p.sn:"na")+" fragments: "+
c),d):e};c.waitForCdnTuneIn=function(a){return a.live&&a.canBlockReload&&a.partTarget&&a.tuneInGoal>Math.max(a.partHoldBack,3*a.partTarget)};c.setStartPosition=function(a,b){var c=this.startPosition;c<b&&(c=-1);if(-1===c||-1===this.lastCurrentTime){var d=a.startTimeOffset;Object(k.isFiniteNumber)(d)?(c=b+d,0>d&&(c+=a.totalduration),c=Math.min(Math.max(b,c),b+a.totalduration),this.log("Start time offset "+d+" found in playlist, adjust startPosition to "+c),this.startPosition=c):a.live?c=this.hls.liveSyncPosition||
b:this.startPosition=c=0;this.lastCurrentTime=c}this.nextLoadPosition=c};c.getLoadPosition=function(){var a=this.media,b=0;this.loadedmetadata&&a?b=a.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition);return b};c.handleFragLoadAborted=function(a,b){this.transmuxer&&("initSegment"!==a.sn&&a.stats.aborted)&&(this.warn("Fragment "+a.sn+(b?" part"+b.index:"")+" of level "+a.level+" was aborted"),this.resetFragmentLoading(a))};c.resetFragmentLoading=function(a){if(!this.fragCurrent||!this.fragContextChanged(a)&&
this.state!==x.FRAG_LOADING_WAITING_RETRY)this.state=x.IDLE};c.onFragmentOrKeyLoadError=function(a,b){if(!b.fatal){var c=b.frag;if(c&&c.type===a){var d=this.fragCurrent;console.assert(d&&c.sn===d.sn&&c.level===d.level&&c.urlId===d.urlId,"Frag load error must match current frag to retry");d=this.config;this.fragLoadError+1<=d.fragLoadingMaxRetry?(this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),d=Math.min(Math.pow(2,this.fragLoadError)*d.fragLoadingRetryDelay,
d.fragLoadingMaxRetryTimeout),this.warn("Fragment "+c.sn+" of "+a+" "+c.level+" failed to load, retrying in "+d+"ms"),this.retryDate=self.performance.now()+d,this.fragLoadError++,this.state=x.FRAG_LOADING_WAITING_RETRY):b.levelRetry?(a===p.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=x.IDLE):(w.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=x.ERROR)}}};c.afterBufferFlushed=function(a,b,c){a&&(a=l.BufferHelper.getBuffered(a),
this.fragmentTracker.detectEvictedFragments(b,a,c),this.state===x.ENDED&&this.resetLoadingState())};c.resetLoadingState=function(){this.fragPrevious=this.fragCurrent=null;this.state=x.IDLE};c.resetStartWhenNotLoaded=function(a){this.loadedmetadata||(this.startFragRequested=!1,a=this.levels?this.levels[a].details:null,null!==a&&void 0!==a&&a.live?(this.startPosition=-1,this.setStartPosition(a,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition)};c.updateLevelTiming=function(a,b,c,
d){var p=this,e=c.details;console.assert(!!e,"level.details must be defined");Object.keys(a.elementaryStreams).reduce(function(b,x){var m=a.elementaryStreams[x];if(m){var f=m.endPTS-m.startPTS;if(0>=f)return p.warn("Could not parse fragment "+a.sn+" "+x+" duration reliably ("+f+")"),b||!1;f=d?0:Object(D.updateFragPTSDTS)(e,a,m.startPTS,m.endPTS,m.startDTS,m.endDTS);p.hls.trigger(r.Events.LEVEL_PTS_UPDATED,{details:e,level:c,drift:f,type:x,frag:a,start:m.startPTS,end:m.endPTS});return!0}return b},
!1)||(this.warn("Found no media in fragment "+a.sn+" of level "+c.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer());this.state=x.PARSED;this.hls.trigger(r.Events.FRAG_PARSED,{frag:a,part:b})};c.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)};d(b,[{key:"state",get:function(){return this._state},set:function(a){var b=this._state;b!==a&&(this._state=a,this.log(b+"->"+a))}}]);return b}(c["default"])},"./src/controller/buffer-controller.ts":function(c,
a,b){b.r(a);b.d(a,"default",function(){return r});var e=b("./src/polyfills/number.ts"),d=b("./src/events.ts"),f=b("./src/utils/logger.ts"),g=b("./src/errors.ts"),n=b("./src/utils/buffer-helper.ts");c=b("./src/utils/mediasource-helper.ts");var k=b("./src/loader/fragment.ts"),t=b("./src/controller/buffer-operation-queue.ts"),l=Object(c.getMediaSource)(),w=/([ha]vc.)(?:\.[^.,]+)+/,r=function(){function a(b){var c=this;this._objectUrl=this.details=null;this.hls=this.listeners=this.operationQueue=void 0;
this._bufferCodecEventsTotal=this.bufferCodecEventsExpected=0;this.mediaSource=this.media=null;this.appendError=0;this.tracks={};this.pendingTracks={};this.sourceBuffer=void 0;this._onMediaSourceOpen=function(){var a=c.hls,b=c.media,e=c.mediaSource;f.logger.log("[buffer-controller]: Media source opened");b&&(c.updateMediaElementDuration(),a.trigger(d.Events.MEDIA_ATTACHED,{media:b}));e&&e.removeEventListener("sourceopen",c._onMediaSourceOpen);c.checkPendingTracks()};this._onMediaSourceClose=function(){f.logger.log("[buffer-controller]: Media source closed")};
this._onMediaSourceEnded=function(){f.logger.log("[buffer-controller]: Media source ended")};this.hls=b;this._initSourceBuffer();this.registerListeners()}var b=a.prototype;b.hasSourceTypes=function(){return 0<this.getSourceBufferTypes().length||0<Object.keys(this.pendingTracks).length};b.destroy=function(){this.unregisterListeners();this.details=null};b.registerListeners=function(){var a=this.hls;a.on(d.Events.MEDIA_ATTACHING,this.onMediaAttaching,this);a.on(d.Events.MEDIA_DETACHING,this.onMediaDetaching,
this);a.on(d.Events.MANIFEST_PARSED,this.onManifestParsed,this);a.on(d.Events.BUFFER_RESET,this.onBufferReset,this);a.on(d.Events.BUFFER_APPENDING,this.onBufferAppending,this);a.on(d.Events.BUFFER_CODECS,this.onBufferCodecs,this);a.on(d.Events.BUFFER_EOS,this.onBufferEos,this);a.on(d.Events.BUFFER_FLUSHING,this.onBufferFlushing,this);a.on(d.Events.LEVEL_UPDATED,this.onLevelUpdated,this);a.on(d.Events.FRAG_PARSED,this.onFragParsed,this);a.on(d.Events.FRAG_CHANGED,this.onFragChanged,this)};b.unregisterListeners=
function(){var a=this.hls;a.off(d.Events.MEDIA_ATTACHING,this.onMediaAttaching,this);a.off(d.Events.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(d.Events.MANIFEST_PARSED,this.onManifestParsed,this);a.off(d.Events.BUFFER_RESET,this.onBufferReset,this);a.off(d.Events.BUFFER_APPENDING,this.onBufferAppending,this);a.off(d.Events.BUFFER_CODECS,this.onBufferCodecs,this);a.off(d.Events.BUFFER_EOS,this.onBufferEos,this);a.off(d.Events.BUFFER_FLUSHING,this.onBufferFlushing,this);a.off(d.Events.LEVEL_UPDATED,
this.onLevelUpdated,this);a.off(d.Events.FRAG_PARSED,this.onFragParsed,this);a.off(d.Events.FRAG_CHANGED,this.onFragChanged,this)};b._initSourceBuffer=function(){this.sourceBuffer={};this.operationQueue=new t["default"](this.sourceBuffer);this.listeners={audio:[],video:[],audiovideo:[]}};b.onManifestParsed=function(a,b){var c=2;if(b.audio&&!b.video||!b.altAudio)c=1;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=c;this.details=null;f.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")};
b.onMediaAttaching=function(a,b){var c=this.media=b.media;if(c&&l){var d=this.mediaSource=new l;d.addEventListener("sourceopen",this._onMediaSourceOpen);d.addEventListener("sourceended",this._onMediaSourceEnded);d.addEventListener("sourceclose",this._onMediaSourceClose);c.src=self.URL.createObjectURL(d);this._objectUrl=c.src}};b.onMediaDetaching=function(){var a=this.media,b=this.mediaSource,c=this._objectUrl;if(b){f.logger.log("[buffer-controller]: media source detaching");if("open"===b.readyState)try{b.endOfStream()}catch(e){f.logger.warn("[buffer-controller]: onMediaDetaching: "+
e.message+" while calling endOfStream")}this.onBufferReset();b.removeEventListener("sourceopen",this._onMediaSourceOpen);b.removeEventListener("sourceended",this._onMediaSourceEnded);b.removeEventListener("sourceclose",this._onMediaSourceClose);a&&(c&&self.URL.revokeObjectURL(c),a.src===c?(a.removeAttribute("src"),a.load()):f.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup"));this._objectUrl=this.media=this.mediaSource=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;
this.pendingTracks={};this.tracks={}}this.hls.trigger(d.Events.MEDIA_DETACHED,void 0)};b.onBufferReset=function(){var a=this;this.getSourceBufferTypes().forEach(function(b){var c=a.sourceBuffer[b];try{c&&(a.removeBufferListeners(b),a.mediaSource&&a.mediaSource.removeSourceBuffer(c),a.sourceBuffer[b]=void 0)}catch(d){f.logger.warn("[buffer-controller]: Failed to reset the "+b+" buffer",d)}});this._initSourceBuffer()};b.onBufferCodecs=function(a,b){var c=this,d=this.getSourceBufferTypes().length;Object.keys(b).forEach(function(a){if(d){var e=
c.tracks[a];if(e&&"function"===typeof e.buffer.changeType){var k=b[a],p=k.id,x=k.codec,l=k.levelCodec,r=k.container,k=k.metadata,g=(e.levelCodec||e.codec).replace(w,"$1"),A=(l||x).replace(w,"$1");g!==A&&(c.appendChangeType(a,r+";codecs="+(l||x)),f.logger.log("[buffer-controller]: switching codec "+g+" to "+A),c.tracks[a]={buffer:e.buffer,codec:x,container:r,levelCodec:l,metadata:k,id:p})}}else c.pendingTracks[a]=b[a]});d||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),
this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())};b.appendChangeType=function(a,b){var c=this,d=this.operationQueue;d.append({execute:function(){var e=c.sourceBuffer[a];e&&(f.logger.log("[buffer-controller]: changing "+a+" sourceBuffer type to "+b),e.changeType(b));d.shiftAndExecuteNext(a)},onStart:function(){},onComplete:function(){},onError:function(b){f.logger.warn("[buffer-controller]: Failed to change "+a+" SourceBuffer type",b)}},a)};b.onBufferAppending=function(a,
b){var c=this,e=this.hls,m=this.operationQueue,k=this.tracks,v=b.data,p=b.type,x=b.frag,l=b.part,r=b.chunkMeta,w=r.buffering[p],z=self.performance.now();w.start=z;var t=x.stats.buffering,C=l?l.stats.buffering:null;0===t.start&&(t.start=z);C&&0===C.start&&(C.start=z);var k=k.audio,h="audio"===p&&1===r.id&&"audio/mpeg"===(null===k||void 0===k?void 0:k.container);m.append({execute:function(){w.executeStart=self.performance.now();if(h){var a=c.sourceBuffer[p];if(a){var b=x.start-a.timestampOffset;0.1<=
Math.abs(b)&&(f.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+x.start+" (delta: "+b+") sn: "+x.sn+")"),a.timestampOffset=x.start)}}c.appendExecutor(v,p)},onStart:function(){},onComplete:function(){var a=self.performance.now();w.executeEnd=w.end=a;0===t.first&&(t.first=a);C&&0===C.first&&(C.first=a);var a=c.sourceBuffer,b={},e;for(e in a)b[e]=n.BufferHelper.getBuffered(a[e]);c.appendError=0;c.hls.trigger(d.Events.BUFFER_APPENDED,{type:p,frag:x,part:l,chunkMeta:r,
parent:x.type,timeRanges:b})},onError:function(a){f.logger.error("[buffer-controller]: Error encountered while trying to append to the "+p+" SourceBuffer",a);var b={type:g.ErrorTypes.MEDIA_ERROR,parent:x.type,details:g.ErrorDetails.BUFFER_APPEND_ERROR,err:a,fatal:!1};a.code===DOMException.QUOTA_EXCEEDED_ERR?b.details=g.ErrorDetails.BUFFER_FULL_ERROR:(c.appendError++,b.details=g.ErrorDetails.BUFFER_APPEND_ERROR,c.appendError>e.config.appendErrorMaxRetry&&(f.logger.error("[buffer-controller]: Failed "+
e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),b.fatal=!0,e.stopLoad()));e.trigger(d.Events.ERROR,b)}},p)};b.onBufferFlushing=function(a,b){var c=this,e=this.operationQueue,m=function(a){return{execute:c.removeExecutor.bind(c,a,b.startOffset,b.endOffset),onStart:function(){},onComplete:function(){c.hls.trigger(d.Events.BUFFER_FLUSHED,{type:a})},onError:function(b){f.logger.warn("[buffer-controller]: Failed to remove from "+a+" SourceBuffer",b)}}};b.type?e.append(m(b.type),
b.type):this.getSourceBufferTypes().forEach(function(a){e.append(m(a),a)})};b.onFragParsed=function(a,b){var c=this,e=b.frag,m=b.part,l=[],v=m?m.elementaryStreams:e.elementaryStreams;v[k.ElementaryStreamTypes.AUDIOVIDEO]?l.push("audiovideo"):(v[k.ElementaryStreamTypes.AUDIO]&&l.push("audio"),v[k.ElementaryStreamTypes.VIDEO]&&l.push("video"));0===l.length&&f.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+e.type+" level: "+e.level+" sn: "+e.sn);this.blockBuffers(function(){var a=
self.performance.now();e.stats.buffering.end=a;m&&(m.stats.buffering.end=a);c.hls.trigger(d.Events.FRAG_BUFFERED,{frag:e,part:m,stats:m?m.stats:e.stats,id:e.type})},l)};b.onFragChanged=function(a,b){this.flushBackBuffer()};b.onBufferEos=function(a,b){var c=this;this.getSourceBufferTypes().reduce(function(a,d){var e=c.sourceBuffer[d];if((!b.type||b.type===d)&&e&&!e.ended)e.ended=!0,f.logger.log("[buffer-controller]: "+d+" sourceBuffer now EOS");return a&&!(e&&!e.ended)},!0)&&this.blockBuffers(function(){var a=
c.mediaSource;a&&"open"===a.readyState&&a.endOfStream()})};b.onLevelUpdated=function(a,b){var c=b.details;c.fragments.length&&(this.details=c,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())};b.flushBackBuffer=function(){var a=this.hls,b=this.details,c=this.media,f=this.sourceBuffer;if(c&&null!==b){var m=this.getSourceBufferTypes();if(m.length){var k=b.live&&null!==a.config.liveBackBufferLength?a.config.liveBackBufferLength:
a.config.backBufferLength;if(Object(e.isFiniteNumber)(k)&&!(0>k)){var c=c.currentTime,v=b.levelTargetDuration,k=Math.max(k,v),p=Math.floor(c/v)*v-k;m.forEach(function(c){var e=f[c];e&&(e=n.BufferHelper.getBuffered(e),0<e.length&&p>e.start(0)&&(a.trigger(d.Events.BACK_BUFFER_REACHED,{bufferEnd:p}),b.live&&a.trigger(d.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:p}),a.trigger(d.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:p,type:c})))})}}}};b.updateMediaElementDuration=function(){if(this.details&&
this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var a=this.details,b=this.hls,c=this.mediaSource,d=a.fragments[0].start+a.totalduration,m=this.media.duration,k=Object(e.isFiniteNumber)(c.duration)?c.duration:0;if(a.live&&b.config.liveDurationInfinity)f.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),c.duration=Infinity,this.updateSeekableRange(a);else if(d>k&&d>m||!Object(e.isFiniteNumber)(m))f.logger.log("[buffer-controller]: Updating Media Source duration to "+
d.toFixed(3)),c.duration=d}};b.updateSeekableRange=function(a){var b=this.mediaSource,c=a.fragments;c.length&&(a.live&&null!==b&&void 0!==b&&b.setLiveSeekableRange)&&(c=Math.max(0,c[0].start),a=Math.max(c,c+a.totalduration),b.setLiveSeekableRange(c,a))};b.checkPendingTracks=function(){var a=this.bufferCodecEventsExpected,b=this.operationQueue,c=this.pendingTracks,e=Object.keys(c).length;if(e&&!a||2===e)this.createSourceBuffers(c),this.pendingTracks={},a=this.getSourceBufferTypes(),0===a.length?this.hls.trigger(d.Events.ERROR,
{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"}):a.forEach(function(a){b.executeNext(a)})};b.createSourceBuffers=function(a){var b=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");var e=0,m;for(m in a)if(!b[m]){var k=a[m];if(!k)throw Error("source buffer exists for track "+m+", however track does not");var v=k.levelCodec||k.codec,
p=k.container+";codecs="+v;f.logger.log("[buffer-controller]: creating sourceBuffer("+p+")");try{var x=b[m]=c.addSourceBuffer(p),l=m;this.addBufferListener(l,"updatestart",this._onSBUpdateStart);this.addBufferListener(l,"updateend",this._onSBUpdateEnd);this.addBufferListener(l,"error",this._onSBUpdateError);this.tracks[m]={buffer:x,codec:v,container:k.container,levelCodec:k.levelCodec,metadata:k.metadata,id:k.id};e++}catch(r){f.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+
r.message),this.hls.trigger(d.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:r,mimeType:p})}}e&&this.hls.trigger(d.Events.BUFFER_CREATED,{tracks:this.tracks})};b._onSBUpdateStart=function(a){this.operationQueue.current(a).onStart()};b._onSBUpdateEnd=function(a){var b=this.operationQueue;b.current(a).onComplete();b.shiftAndExecuteNext(a)};b._onSBUpdateError=function(a,b){f.logger.error("[buffer-controller]: "+a+" SourceBuffer error",b);this.hls.trigger(d.Events.ERROR,
{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var c=this.operationQueue.current(a);if(c)c.onError(b)};b.removeExecutor=function(a,b,c){var d=this.media,m=this.mediaSource,k=this.operationQueue,v=this.sourceBuffer[a];!d||!m||!v?(f.logger.warn("[buffer-controller]: Attempting to remove from the "+a+" SourceBuffer, but it does not exist"),k.shiftAndExecuteNext(a)):(d=Object(e.isFiniteNumber)(d.duration)?d.duration:Infinity,m=Object(e.isFiniteNumber)(m.duration)?
m.duration:Infinity,b=Math.max(0,b),c=Math.min(c,d,m),c>b?(f.logger.log("[buffer-controller]: Removing ["+b+","+c+"] from the "+a+" SourceBuffer"),console.assert(!v.updating,a+" sourceBuffer must not be updating"),v.remove(b,c)):k.shiftAndExecuteNext(a))};b.appendExecutor=function(a,b){var c=this.operationQueue,d=this.sourceBuffer[b];d?(d.ended=!1,console.assert(!d.updating,b+" sourceBuffer must not be updating"),d.appendBuffer(a)):(f.logger.warn("[buffer-controller]: Attempting to append to the "+
b+" SourceBuffer, but it does not exist"),c.shiftAndExecuteNext(b))};b.blockBuffers=function(a,b){var c=this;void 0===b&&(b=this.getSourceBufferTypes());if(b.length){var d=this.operationQueue,e=b.map(function(a){return d.appendBlocker(a)});Promise.all(e).then(function(){a();b.forEach(function(a){var b=c.sourceBuffer[a];(!b||!b.updating)&&d.shiftAndExecuteNext(a)})})}else f.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(a)};b.getSourceBufferTypes=
function(){return Object.keys(this.sourceBuffer)};b.addBufferListener=function(a,b,c){var d=this.sourceBuffer[a];d&&(c=c.bind(this,a),this.listeners[a].push({event:b,listener:c}),d.addEventListener(b,c))};b.removeBufferListeners=function(a){var b=this.sourceBuffer[a];b&&this.listeners[a].forEach(function(a){b.removeEventListener(a.event,a.listener)})};return a}()},"./src/controller/buffer-operation-queue.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return d});var e=b("./src/utils/logger.ts"),
d=function(){function a(b){this.buffers=void 0;this.queues={video:[],audio:[],audiovideo:[]};this.buffers=b}var b=a.prototype;b.append=function(a,b){var c=this.queues[b];c.push(a);1===c.length&&this.buffers[b]&&this.executeNext(b)};b.insertAbort=function(a,b){this.queues[b].unshift(a);this.executeNext(b)};b.appendBlocker=function(a){var b,c=new Promise(function(a){b=a});this.append({execute:b,onStart:function(){},onComplete:function(){},onError:function(){}},a);return c};b.executeNext=function(a){var b=
this.buffers[a],c=this.queues[a];if(c.length){var d=c[0];try{d.execute()}catch(f){if(e.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),d.onError(f),!b||!b.updating)c.shift(),this.executeNext(a)}}};b.shiftAndExecuteNext=function(a){this.queues[a].shift();this.executeNext(a)};b.current=function(a){return this.queues[a][0]};return a}()},"./src/controller/cap-level-controller.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);var f=b("./src/events.ts");c=function(){function a(b){this.clientRect=this.streamController=this.hls=this.timer=this.restrictedLevels=this.media=this.firstLevel=this.autoLevelCapping=void 0;this.hls=b;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.firstLevel=-1;this.media=null;this.restrictedLevels=
[];this.timer=void 0;this.clientRect=null;this.registerListeners()}var b=a.prototype;b.setStreamController=function(a){this.streamController=a};b.destroy=function(){this.unregisterListener();this.hls.config.capLevelToPlayerSize&&this.stopCapping();this.hls=this.streamController=this.clientRect=this.media=null};b.registerListeners=function(){var a=this.hls;a.on(f.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this);a.on(f.Events.MEDIA_ATTACHING,this.onMediaAttaching,this);a.on(f.Events.MANIFEST_PARSED,
this.onManifestParsed,this);a.on(f.Events.BUFFER_CODECS,this.onBufferCodecs,this);a.on(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this)};b.unregisterListener=function(){var a=this.hls;a.off(f.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this);a.off(f.Events.MEDIA_ATTACHING,this.onMediaAttaching,this);a.off(f.Events.MANIFEST_PARSED,this.onManifestParsed,this);a.off(f.Events.BUFFER_CODECS,this.onBufferCodecs,this);a.off(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this)};b.onFpsDropLevelCapping=
function(b,c){a.isLevelAllowed(c.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(c.droppedLevel)};b.onMediaAttaching=function(a,b){this.media=b.media instanceof HTMLVideoElement?b.media:null};b.onManifestParsed=function(a,b){var c=this.hls;this.restrictedLevels=[];this.firstLevel=b.firstLevel;c.config.capLevelToPlayerSize&&b.video&&this.startCapping()};b.onBufferCodecs=function(a,b){this.hls.config.capLevelToPlayerSize&&b.video&&this.startCapping()};b.onMediaDetaching=function(){this.stopCapping()};
b.detectPlayerSize=function(){if(this.media&&0<this.mediaHeight&&0<this.mediaWidth){var a=this.hls.levels;if(a.length){var b=this.hls;b.autoLevelCapping=this.getMaxLevel(a.length-1);b.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch();this.autoLevelCapping=b.autoLevelCapping}}};b.getMaxLevel=function(b){var c=this,d=this.hls.levels;if(!d.length)return-1;d=d.filter(function(d,e){return a.isLevelAllowed(e,c.restrictedLevels)&&e<=b});this.clientRect=
null;return a.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)};b.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1E3),this.detectPlayerSize())};b.stopCapping=function(){this.restrictedLevels=[];this.firstLevel=-1;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.timer&&(self.clearInterval(this.timer),this.timer=
void 0)};b.getDimensions=function(){if(this.clientRect)return this.clientRect;var a=this.media,b={width:0,height:0};if(a){var c=a.getBoundingClientRect();b.width=c.width;b.height=c.height;!b.width&&!b.height&&(b.width=c.right-c.left||a.width||0,b.height=c.bottom-c.top||a.height||0)}return this.clientRect=b};a.isLevelAllowed=function(a,b){void 0===b&&(b=[]);return-1===b.indexOf(a)};a.getMaxLevelByMediaSize=function(a,b,c){if(!a||!a.length)return-1;for(var d=a.length-1,e=0;e<a.length;e+=1){var f=a[e],
g;if(g=f.width>=b||f.height>=c)g=(g=a[e+1])?f.width!==g.width||f.height!==g.height:!0;if(g){d=e;break}}return d};d(a,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var a=1;if(!this.hls.config.ignoreDevicePixelRatio)try{a=self.devicePixelRatio}catch(b){}return a}}]);return a}();a["default"]=c},"./src/controller/fps-controller.ts":function(c,
a,b){b.r(a);var e=b("./src/events.ts"),d=b("./src/utils/logger.ts");c=function(){function a(b){this.hls=void 0;this.isVideoPlaybackQualityAvailable=!1;this.timer=void 0;this.media=null;this.lastTime=void 0;this.lastDecodedFrames=this.lastDroppedFrames=0;this.streamController=void 0;this.hls=b;this.registerListeners()}var b=a.prototype;b.setStreamController=function(a){this.streamController=a};b.registerListeners=function(){this.hls.on(e.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)};b.unregisterListeners=
function(){this.hls.off(e.Events.MEDIA_ATTACHING,this.onMediaAttaching)};b.destroy=function(){this.timer&&clearInterval(this.timer);this.unregisterListeners();this.isVideoPlaybackQualityAvailable=!1;this.media=null};b.onMediaAttaching=function(a,b){var c=this.hls.config;if(c.capLevelOnFPSDrop){var d=b.media instanceof self.HTMLVideoElement?b.media:null;if((this.media=d)&&"function"===typeof d.getVideoPlaybackQuality)this.isVideoPlaybackQualityAvailable=!0;self.clearInterval(this.timer);this.timer=
self.setInterval(this.checkFPSInterval.bind(this),c.fpsDroppedMonitoringPeriod)}};b.checkFPS=function(a,b,c){a=performance.now();if(b){if(this.lastTime){var f=c-this.lastDroppedFrames,w=b-this.lastDecodedFrames,r=1E3*f/(a-this.lastTime),g=this.hls;g.trigger(e.Events.FPS_DROP,{currentDropped:f,currentDecoded:w,totalDroppedFrames:c});if(0<r&&f>g.config.fpsDroppedMonitoringThreshold*w&&(f=g.currentLevel,d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),0<f&&(-1===g.autoLevelCapping||
g.autoLevelCapping>=f)))f-=1,g.trigger(e.Events.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:g.currentLevel}),g.autoLevelCapping=f,this.streamController.nextLevelSwitch()}this.lastTime=a;this.lastDroppedFrames=c;this.lastDecodedFrames=b}};b.checkFPSInterval=function(){var a=this.media;if(a)if(this.isVideoPlaybackQualityAvailable){var b=a.getVideoPlaybackQuality();this.checkFPS(a,b.totalVideoFrames,b.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)};return a}();
a["default"]=c},"./src/controller/fragment-finders.ts":function(c,a,b){function e(a,b,c){if(null===b||(!Array.isArray(a)||!a.length||!Object(k.isFiniteNumber)(b))||b<(a[0].programDateTime||0)||b>=(a[a.length-1].endProgramDateTime||0))return null;c=c||0;for(var d=0;d<a.length;++d){var e=a[d];if(g(b,c,e))return e}return null}function d(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);var e=null;a?e=b[a.sn-b[0].sn+1]||null:0===c&&0===b[0].start&&(e=b[0]);return e&&0===f(c,d,e)?e:(a=t["default"].search(b,
f.bind(null,c,d)))?a:e}function f(a,b,c){void 0===a&&(a=0);void 0===b&&(b=0);b=Math.min(b,c.duration+(c.deltaPTS?c.deltaPTS:0));return c.start+c.duration-b<=a?1:c.start-b>a&&c.start?-1:0}function g(a,b,c){b=1E3*Math.min(b,c.duration+(c.deltaPTS?c.deltaPTS:0));return(c.endProgramDateTime||0)-b>a}function n(a,b){return t["default"].search(a,function(a){return a.cc<b?1:a.cc>b?-1:0})}b.r(a);b.d(a,"findFragmentByPDT",function(){return e});b.d(a,"findFragmentByPTS",function(){return d});b.d(a,"fragmentWithinToleranceTest",
function(){return f});b.d(a,"pdtWithinToleranceTest",function(){return g});b.d(a,"findFragWithCC",function(){return n});var k=b("./src/polyfills/number.ts"),t=b("./src/utils/binary-search.ts")},"./src/controller/fragment-tracker.ts":function(c,a,b){function e(a){var b,c;return a.buffered&&((null===(b=a.range.video)||void 0===b?void 0:b.partial)||(null===(c=a.range.audio)||void 0===c?void 0:c.partial))}function d(a){return a.type+"_"+a.level+"_"+a.urlId+"_"+a.sn}b.r(a);b.d(a,"FragmentState",function(){return n});
b.d(a,"FragmentTracker",function(){return k});var f=b("./src/events.ts"),g=b("./src/types/loader.ts"),n;(function(a){a.NOT_LOADED="NOT_LOADED";a.APPENDING="APPENDING";a.PARTIAL="PARTIAL";a.OK="OK"})(n||(n={}));var k=function(){function a(b){this.activeParts=this.activeFragment=null;this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.bufferPadding=0.2;this.hls=void 0;this.hls=b;this._registerListeners()}var b=a.prototype;b._registerListeners=function(){var a=this.hls;a.on(f.Events.BUFFER_APPENDED,
this.onBufferAppended,this);a.on(f.Events.FRAG_BUFFERED,this.onFragBuffered,this);a.on(f.Events.FRAG_LOADED,this.onFragLoaded,this)};b._unregisterListeners=function(){var a=this.hls;a.off(f.Events.BUFFER_APPENDED,this.onBufferAppended,this);a.off(f.Events.FRAG_BUFFERED,this.onFragBuffered,this);a.off(f.Events.FRAG_LOADED,this.onFragLoaded,this)};b.destroy=function(){this._unregisterListeners();this.fragments=this.timeRanges=null};b.getAppendedFrag=function(a,b){if(b===g.PlaylistLevelType.MAIN){var c=
this.activeFragment,d=this.activeParts;if(!c)return null;if(d)for(var e=d.length;e--;){var f=d[e],k=f?f.end:c.appendedPTS;if(f.start<=a&&void 0!==k&&a<=k)return 9<e&&(this.activeParts=d.slice(e-9)),f}else if(c.start<=a&&void 0!==c.appendedPTS&&a<=c.appendedPTS)return c}return this.getBufferedFrag(a,b)};b.getBufferedFrag=function(a,b){for(var c=this.fragments,d=Object.keys(c),e=d.length;e--;){var f=c[d[e]];if((null===f||void 0===f?void 0:f.body.type)===b&&f.buffered)if(f=f.body,f.start<=a&&a<=f.end)return f}return null};
b.detectEvictedFragments=function(a,b,c){var d=this;Object.keys(this.fragments).forEach(function(e){var f=d.fragments[e];f&&(f.buffered?(e=f.range[a])&&e.time.some(function(a){(a=!d.isTimeBuffered(a.startPTS,a.endPTS,b))&&d.removeFragment(f.body);return a}):f.body.type===c&&d.removeFragment(f.body))})};b.detectPartialFragments=function(a){var b=this,c=this.timeRanges,e=a.frag,f=a.part;if(c&&"initSegment"!==e.sn){a=d(e);var k=this.fragments[a];k&&(Object.keys(c).forEach(function(a){var d=e.elementaryStreams[a];
d&&(k.range[a]=b.getBufferedTimes(e,f,null!==f||!0===d.partial,c[a]))}),k.loaded=null,Object.keys(k.range).length?k.buffered=!0:this.removeFragment(k.body))}};b.fragBuffered=function(a){a=d(a);if(a=this.fragments[a])a.loaded=null,a.buffered=!0};b.getBufferedTimes=function(a,b,c,d){c={time:[],partial:c};var e=b?b.start:a.start;b=b?b.end:a.end;var f=a.minEndPTS||b;a=a.maxStartPTS||e;for(var k=0;k<d.length;k++){var g=d.start(k)-this.bufferPadding,m=d.end(k)+this.bufferPadding;if(a>=g&&f<=m){c.time.push({startPTS:Math.max(e,
d.start(k)),endPTS:Math.min(b,d.end(k))});break}else if(e<m&&b>g)c.partial=!0,c.time.push({startPTS:Math.max(e,d.start(k)),endPTS:Math.min(b,d.end(k))});else if(b<=g)break}return c};b.getPartialFragment=function(a){var b=null,c,d,f,k=0,g=this.bufferPadding,l=this.fragments;Object.keys(l).forEach(function(m){if((m=l[m])&&e(m))d=m.body.start-g,f=m.body.end+g,a>=d&&a<=f&&(c=Math.min(a-d,f-a),k<=c&&(b=m.body,k=c))});return b};b.getState=function(a){a=d(a);return(a=this.fragments[a])?a.buffered?e(a)?n.PARTIAL:
n.OK:n.APPENDING:n.NOT_LOADED};b.isTimeBuffered=function(a,b,c){for(var d,e,f=0;f<c.length;f++){d=c.start(f)-this.bufferPadding;e=c.end(f)+this.bufferPadding;if(a>=d&&b<=e)return!0;if(b<=d)break}return!1};b.onFragLoaded=function(a,b){var c=b.frag,e=b.part;"initSegment"===c.sn||(c.bitrateTest||e)||(e=d(c),this.fragments[e]={body:c,loaded:b,buffered:!1,range:Object.create(null)})};b.onBufferAppended=function(a,b){var c=this,d=b.frag,e=b.part,f=b.timeRanges;if(d.type===g.PlaylistLevelType.MAIN)if(this.activeFragment=
d,e){var k=this.activeParts;k||(this.activeParts=k=[]);k.push(e)}else this.activeParts=null;this.timeRanges=f;Object.keys(f).forEach(function(a){var b=f[a];c.detectEvictedFragments(a,b);if(!e)for(a=0;a<b.length;a++)d.appendedPTS=Math.max(b.end(a),d.appendedPTS||0)})};b.onFragBuffered=function(a,b){this.detectPartialFragments(b)};b.hasFragment=function(a){a=d(a);return!!this.fragments[a]};b.removeFragmentsInRange=function(a,b,c){var d=this;Object.keys(this.fragments).forEach(function(e){if((e=d.fragments[e])&&
e.buffered)e=e.body,e.type===c&&(e.start<b&&e.end>a)&&d.removeFragment(e)})};b.removeFragment=function(a){var b=d(a);a.stats.loaded=0;a.clearElementaryStreamInfo();delete this.fragments[b]};b.removeAllFragments=function(){this.fragments=Object.create(null);this.activeParts=this.activeFragment=null};return a}()},"./src/controller/gap-controller.ts":function(c,a,b){b.r(a);b.d(a,"STALL_MINIMUM_DURATION_MS",function(){return n});b.d(a,"MAX_START_GAP_JUMP",function(){return k});b.d(a,"SKIP_BUFFER_HOLE_STEP_SECONDS",
function(){return t});b.d(a,"SKIP_BUFFER_RANGE_START",function(){return l});b.d(a,"default",function(){return w});var e=b("./src/utils/buffer-helper.ts"),d=b("./src/errors.ts"),f=b("./src/events.ts"),g=b("./src/utils/logger.ts"),n=250,k=2,t=0.1,l=0.05,w=function(){function a(b,c,d,e){this.config=void 0;this.media=null;this.hls=this.fragmentTracker=void 0;this.nudgeRetry=0;this.stallReported=!1;this.stalled=null;this.seeking=this.moved=!1;this.config=b;this.media=c;this.fragmentTracker=d;this.hls=
e}var b=a.prototype;b.destroy=function(){this.hls=this.fragmentTracker=this.media=null};b.poll=function(a,b){var c=this.config,d=this.media,f=this.stalled;if(null!==d){var m=d.currentTime,l=d.seeking,v=this.seeking&&!l,p=!this.seeking&&l;this.seeking=l;if(m!==a)this.moved=!0,null!==f&&(this.stallReported&&(c=self.performance.now()-f,g.logger.warn("playback not stuck anymore @"+m+", after "+Math.round(c)+"ms"),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0);else{if(p||v)this.stalled=null;
if(!(d.paused&&!l||d.ended||0===d.playbackRate||!e.BufferHelper.getBuffered(d).length))if(v=e.BufferHelper.bufferInfo(d,m,0),p=v.nextStart||0,0<v.len||p){if(l){var x=v.len>k,r=!p||b&&b.start<=m||p-m>k&&!this.fragmentTracker.getPartialFragment(m);if(x||r)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var w,p=Math.max(p,v.start||0)-m,x=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,x=(null===x||void 0===x?0:null===(w=x.details)||void 0===w?0:w.live)?2*x.details.targetduration:
k;if(0<p&&p<=x){this._trySkipBufferHole(null);return}}w=self.performance.now();if(null===f)this.stalled=w;else{f=w-f;if(!l&&f>=n&&(this._reportStall(v),!this.media))return;m=e.BufferHelper.bufferInfo(d,m,c.maxBufferHole);this._tryFixBufferStall(m,f)}}}}};b._tryFixBufferStall=function(a,b){var c=this.config,d=this.fragmentTracker,e=this.media;if(null!==e&&(d=d.getPartialFragment(e.currentTime),(!d||!this._trySkipBufferHole(d)&&this.media)&&a.len>c.maxBufferHole&&b>1E3*c.highBufferWatchdogPeriod))g.logger.warn("Trying to nudge playhead over buffer-hole"),
this.stalled=null,this._tryNudgeBuffer()};b._reportStall=function(a){var b=this.hls,c=this.media;!this.stallReported&&c&&(this.stallReported=!0,g.logger.warn("Playback stalling at @"+c.currentTime+" due to low buffer ("+JSON.stringify(a)+")"),b.trigger(f.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:a.len}))};b._trySkipBufferHole=function(a){var b=this.config,c=this.hls,k=this.media;if(null===k)return 0;for(var r=k.currentTime,m=0,y=e.BufferHelper.getBuffered(k),
v=0;v<y.length;v++){var p=y.start(v);if(r+b.maxBufferHole>=m&&r<p)return b=Math.max(p+l,k.currentTime+t),g.logger.warn("skipping hole, adjusting currentTime from "+r+" to "+b),this.moved=!0,this.stalled=null,k.currentTime=b,a&&c.trigger(f.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+r+" to "+b,frag:a}),b;m=y.end(v)}return 0};b._tryNudgeBuffer=function(){var a=this.config,b=this.hls,c=this.media,
e=this.nudgeRetry;if(null!==c){var k=c.currentTime;this.nudgeRetry++;e<a.nudgeMaxRetry?(a=k+(e+1)*a.nudgeOffset,g.logger.warn("Nudging 'currentTime' from "+k+" to "+a),c.currentTime=a,b.trigger(f.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(g.logger.error("Playhead still not moving while enough data buffered @"+k+" after "+a.nudgeMaxRetry+" nudges"),b.trigger(f.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_STALLED_ERROR,
fatal:!0}))}};return a}()},"./src/controller/id3-track-controller.ts":function(c,a,b){b.r(a);var e=b("./src/polyfills/number.ts"),d=b("./src/events.ts"),f=b("./src/utils/texttrack-utils.ts"),g=b("./src/demux/id3.ts"),n=b("./src/loader/date-range.ts"),k=b("./src/types/demuxer.ts");c=function(){function a(b){this.hls=void 0;this.media=this.id3Track=null;this.dateRangeCuesAppended={};this.hls=b;this._registerListeners()}var b=a.prototype;b.destroy=function(){this._unregisterListeners();this.media=this.id3Track=
null;this.dateRangeCuesAppended={};this.hls=null};b._registerListeners=function(){var a=this.hls;a.on(d.Events.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(d.Events.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(d.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.on(d.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this);a.on(d.Events.BUFFER_FLUSHING,this.onBufferFlushing,this);a.on(d.Events.LEVEL_UPDATED,this.onLevelUpdated,this)};b._unregisterListeners=function(){var a=this.hls;
a.off(d.Events.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(d.Events.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(d.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.off(d.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this);a.off(d.Events.BUFFER_FLUSHING,this.onBufferFlushing,this);a.off(d.Events.LEVEL_UPDATED,this.onLevelUpdated,this)};b.onMediaAttached=function(a,b){this.media=b.media};b.onMediaDetaching=function(){this.id3Track&&(Object(f.clearCurrentCues)(this.id3Track),
this.media=this.id3Track=null,this.dateRangeCuesAppended={})};b.onManifestLoading=function(){this.dateRangeCuesAppended={}};b.createTrack=function(a){a=this.getID3Track(a.textTracks);a.mode="hidden";return a};b.getID3Track=function(a){if(this.media){for(var b=0;b<a.length;b++){var c=a[b];if("metadata"===c.kind&&"id3"===c.label)return Object(f.sendAddTrackEvent)(c,this.media),c}return this.media.addTextTrack("metadata","id3")}};b.onFragParsingMetadata=function(a,b){if(this.media){var c=this.hls.config,
d=c.enableEmsgMetadataCues,c=c.enableID3MetadataCues;if(d||c){var e=b.frag,f=b.samples,l=b.details;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var e=l.edge||e.end,l=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,n=!1,m={},y=0;y<f.length;y++){var v=f[y].type;if((v!==k.MetadataSchema.emsg||d)&&c){var p=g.getID3Frames(f[y].data);if(p){var x=f[y].pts,qa=e;0>=qa-x&&(qa=x+0.25);for(var R=0;R<p.length;R++){var t=p[R];g.isTimeStampFrame(t)||(n=new l(x,qa,""),n.value=t,v&&(n.type=v),
this.id3Track.addCue(n),m[t.key]=null,n=!0)}}}}n&&this.updateId3CueEnds(m)}}};b.updateId3CueEnds=function(a){var b,c=null===(b=this.id3Track)||void 0===b?void 0:b.cues;if(c)for(b=c.length;b--;){var d,e=c[b],f=null===(d=e.value)||void 0===d?void 0:d.key;if(f&&f in a){var k=a[f];k&&e.endTime!==k&&(e.endTime=k);a[f]=e.startTime}}};b.onBufferFlushing=function(a,b){var c=b.startOffset,d=b.endOffset,e=b.type,g=this.id3Track,l=this.hls;if(l){var l=l.config,n=l.enableEmsgMetadataCues,m=l.enableID3MetadataCues;
if(g&&(n||m))Object(f.removeCuesInRange)(g,c,d,"audio"===e?function(a){return a.type===k.MetadataSchema.audioId3&&m}:"video"===e?function(a){return a.type===k.MetadataSchema.emsg&&n}:function(a){return a.type===k.MetadataSchema.audioId3&&m||a.type===k.MetadataSchema.emsg&&n})}};b.onLevelUpdated=function(a,b){var c=this,d=b.details;if(this.media&&d.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var f=this.dateRangeCuesAppended,g=this.id3Track,l=d.dateRanges,t=Object.keys(l);if(g)for(var m=
Object.keys(f).filter(function(a){return!t.includes(a)}),y=function(a){var b=m[a];Object.keys(f[b].cues).forEach(function(a){g.removeCue(f[b].cues[a])});delete f[b]},v=m.length;v--;)y(v);y=d.fragments[d.fragments.length-1];if(0!==t.length&&Object(e.isFiniteNumber)(null===y||void 0===y?void 0:y.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var p=y.programDateTime/1E3-y.start,x=d.edge||y.end,qa=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,d=function(a){a=t[a];
var b=l[a],d=f[a],e=(null===d||void 0===d?void 0:d.cues)||{},m=(null===d||void 0===d?void 0:d.durationKnown)||!1,v=b.startDate.getTime()/1E3-p,g=x,y=b.endDate;if(y)g=y.getTime()/1E3-p,m=!0;else if(b.endOnNext&&!m&&(y=t.reduce(function(a,c){var d=l[c];d.class===b.class&&(d.id!==c&&d.startDate>b.startDate)&&a.push(d);return a},[]).sort(function(a,b){return a.startDate.getTime()-b.startDate.getTime()})[0]))g=y.startDate.getTime()/1E3-p,m=!0;for(var y=Object.keys(b.attr),r=0;r<y.length;r++){var w=y[r];
if(!(w===n.DateRangeAttribute.ID||w===n.DateRangeAttribute.CLASS||w===n.DateRangeAttribute.START_DATE||w===n.DateRangeAttribute.DURATION||w===n.DateRangeAttribute.END_DATE||w===n.DateRangeAttribute.END_ON_NEXT)){var q=e[w];if(q)m&&!d.durationKnown&&(q.endTime=g);else{var z=b.attr[w],q=new qa(v,g,"");if(w===n.DateRangeAttribute.SCTE35_OUT||w===n.DateRangeAttribute.SCTE35_IN)z=Uint8Array.from(z.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer;q.value={key:w,
data:z};q.type=k.MetadataSchema.dateRange;c.id3Track.addCue(q);e[w]=q}}}f[a]={cues:e,dateRange:b,durationKnown:m}},y=0;y<t.length;y++)d(y)}}};return a}();a["default"]=c},"./src/controller/latency-controller.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}
b.r(a);b.d(a,"default",function(){return k});var f=b("./src/errors.ts"),g=b("./src/events.ts"),n=b("./src/utils/logger.ts"),k=function(){function a(b){var c=this;this.config=this.hls=void 0;this.levelDetails=this.media=null;this.stallCount=this.currentTime=0;this._latency=null;this.timeupdateHandler=function(){return c.timeupdate()};this.hls=b;this.config=b.config;this.registerListeners()}var b=a.prototype;b.destroy=function(){this.unregisterListeners();this.onMediaDetaching();this.hls=this.timeupdateHandler=
this.levelDetails=null};b.registerListeners=function(){this.hls.on(g.Events.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this);this.hls.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this);this.hls.on(g.Events.LEVEL_UPDATED,this.onLevelUpdated,this);this.hls.on(g.Events.ERROR,this.onError,this)};b.unregisterListeners=function(){this.hls.off(g.Events.MEDIA_ATTACHED,this.onMediaAttached);this.hls.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching);
this.hls.off(g.Events.MANIFEST_LOADING,this.onManifestLoading);this.hls.off(g.Events.LEVEL_UPDATED,this.onLevelUpdated);this.hls.off(g.Events.ERROR,this.onError)};b.onMediaAttached=function(a,b){this.media=b.media;this.media.addEventListener("timeupdate",this.timeupdateHandler)};b.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)};b.onManifestLoading=function(){this._latency=this.levelDetails=null;this.stallCount=0};b.onLevelUpdated=
function(a,b){var c=b.details;this.levelDetails=c;c.advanced&&this.timeupdate();!c.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)};b.onError=function(a,b){b.details===f.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,n.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))};b.timeupdate=function(){var a=this.media,b=this.levelDetails;if(a&&b){this.currentTime=a.currentTime;var c=this.computeLatency();if(null!==c){this._latency=
c;var d=this.config,e=d.maxLiveSyncPlaybackRate;d.lowLatencyMode&&1!==e&&(d=this.targetLatency,null!==d&&(c-=d,d=Math.min(this.maxLatency,d+b.targetduration),b.live&&c<d&&0.05<c&&1<this.forwardBufferLength?(b=Math.min(2,Math.max(1,e)),e=Math.round(20*(2/(1+Math.exp(-0.75*c-this.edgeStalled))))/20,a.playbackRate=Math.min(b,Math.max(1,e))):1!==a.playbackRate&&0!==a.playbackRate&&(a.playbackRate=1)))}}};b.estimateLiveEdge=function(){var a=this.levelDetails;return null===a?null:a.edge+a.age};b.computeLatency=
function(){var a=this.estimateLiveEdge();return null===a?null:a-this.currentTime};d(a,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var a=this.config,b=this.levelDetails;return void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:b?a.liveMaxLatencyDurationCount*b.targetduration:0}},{key:"targetLatency",get:function(){var a=this.levelDetails;if(null===a)return null;var b=a.holdBack,c=a.partHoldBack,a=a.targetduration,d=this.config,e=d.liveSyncDuration,
f=d.liveSyncDurationCount,k=this.hls.userConfig,b=d.lowLatencyMode?c||b:b;if(k.liveSyncDuration||k.liveSyncDurationCount||0===b)b=void 0!==e?e:f*a;return b+Math.min(1*this.stallCount,a)}},{key:"liveSyncPosition",get:function(){var a=this.estimateLiveEdge(),b=this.targetLatency,c=this.levelDetails;if(null===a||null===b||null===c)return null;var d=c.edge,e=d-(this.config.lowLatencyMode&&c.partTarget||c.targetduration);return Math.min(Math.max(d-c.totalduration,a-b-this.edgeStalled),e)}},{key:"drift",
get:function(){var a=this.levelDetails;return null===a?1:a.drift}},{key:"edgeStalled",get:function(){var a=this.levelDetails;return null===a?0:Math.max(a.age-3*(this.config.lowLatencyMode&&a.partTarget||a.targetduration),0)}},{key:"forwardBufferLength",get:function(){var a=this.media,b=this.levelDetails;if(!a||!b)return 0;var c=a.buffered.length;return(c?a.buffered.end(c-1):b.edge)-this.currentTime}}]);return a}()},"./src/controller/level-controller.ts":function(c,a,b){function e(){e=Object.assign?
Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}function d(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function f(a,b,c){b&&d(a.prototype,b);c&&d(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}function g(a,b){a.prototype=Object.create(b.prototype);
a.prototype.constructor=a;n(a,b)}function n(a,b){n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return n(a,b)}b.r(a);b.d(a,"default",function(){return A});var k=b("./src/types/level.ts"),t=b("./src/events.ts"),l=b("./src/errors.ts"),w=b("./src/utils/codecs.ts"),r=b("./src/controller/level-helper.ts");c=b("./src/controller/base-playlist-controller.ts");var C=b("./src/types/loader.ts"),z=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),A=function(a){function b(c){c=
a.call(this,c,"[level-controller]")||this;c._levels=[];c._firstLevel=-1;c._startLevel=void 0;c.currentLevelIndex=-1;c.manualLevelIndex=-1;c.onParsedComplete=void 0;c._registerListeners();return c}g(b,a);var c=b.prototype;c._registerListeners=function(){var a=this.hls;a.on(t.Events.MANIFEST_LOADED,this.onManifestLoaded,this);a.on(t.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.on(t.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.on(t.Events.FRAG_LOADED,this.onFragLoaded,this);a.on(t.Events.ERROR,
this.onError,this)};c._unregisterListeners=function(){var a=this.hls;a.off(t.Events.MANIFEST_LOADED,this.onManifestLoaded,this);a.off(t.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.off(t.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.off(t.Events.FRAG_LOADED,this.onFragLoaded,this);a.off(t.Events.ERROR,this.onError,this)};c.destroy=function(){this._unregisterListeners();this.manualLevelIndex=-1;this._levels.length=0;a.prototype.destroy.call(this)};c.startLoad=function(){this._levels.forEach(function(a){a.loadError=
0});a.prototype.startLoad.call(this)};c.onManifestLoaded=function(a,b){var c=[],d=[],e=[],f,g={},n,u=!1,q=!1,D=!1;b.levels.forEach(function(a){var b=a.attrs;u=u||!(!a.width||!a.height);q=q||!!a.videoCodec;D=D||!!a.audioCodec;z&&(a.audioCodec&&-1!==a.audioCodec.indexOf("mp4a.40.34"))&&(a.audioCodec=void 0);var d=a.bitrate+"-"+a.attrs.RESOLUTION+"-"+a.attrs.CODECS;(n=g[d])?n.url.push(a.url):(n=new k.Level(a),g[d]=n,c.push(n));b&&(b.AUDIO&&Object(r.addGroupId)(n,"audio",b.AUDIO),b.SUBTITLES&&Object(r.addGroupId)(n,
"text",b.SUBTITLES))});if((u||q)&&D)c=c.filter(function(a){var b=a.width,c=a.height;return!!a.videoCodec||!(!b||!c)});c=c.filter(function(a){var b=a.audioCodec;a=a.videoCodec;return(!b||Object(w.isCodecSupportedInMp4)(b,"audio"))&&(!a||Object(w.isCodecSupportedInMp4)(a,"video"))});b.audioTracks&&(d=b.audioTracks.filter(function(a){return!a.audioCodec||Object(w.isCodecSupportedInMp4)(a.audioCodec,"audio")}),Object(r.assignTrackIdsByGroup)(d));b.subtitles&&(e=b.subtitles,Object(r.assignTrackIdsByGroup)(e));
if(0<c.length){f=c[0].bitrate;c.sort(function(a,b){return a.bitrate-b.bitrate});this._levels=c;for(var A=0;A<c.length;A++)if(c[A].bitrate===f){this._firstLevel=A;this.log("manifest loaded, "+c.length+" level(s) found, first bitrate: "+f);break}d={levels:c,audioTracks:d,subtitleTracks:e,firstLevel:this._firstLevel,stats:b.stats,audio:D,video:q,altAudio:!(D&&!q)&&d.some(function(a){return!!a.url})};this.hls.trigger(t.Events.MANIFEST_PARSED,d);(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&
this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(t.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:b.url,reason:"no level with compatible codecs found in manifest"})};c.onError=function(b,c){var d;a.prototype.onError.call(this,b,c);if(!c.fatal){var e=c.context,f=this._levels[this.currentLevelIndex];if(e&&(e.type===C.PlaylistContextType.AUDIO_TRACK&&f.audioGroupIds&&e.groupId===f.audioGroupIds[f.urlId]||e.type===
C.PlaylistContextType.SUBTITLE_TRACK&&f.textGroupIds&&e.groupId===f.textGroupIds[f.urlId]))this.redundantFailover(this.currentLevelIndex);else{var f=!1,k=!0,g;switch(c.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:case l.ErrorDetails.KEY_LOAD_ERROR:case l.ErrorDetails.KEY_LOAD_TIMEOUT:c.frag&&(d=c.frag.type===C.PlaylistLevelType.MAIN?c.frag.level:this.currentLevelIndex,(e=this._levels[d])?(e.fragmentError++,e.fragmentError>this.hls.config.fragLoadingMaxRetry&&
(g=d)):g=d);break;case l.ErrorDetails.LEVEL_LOAD_ERROR:case l.ErrorDetails.LEVEL_LOAD_TIMEOUT:e&&(e.deliveryDirectives&&(k=!1),g=e.level);f=!0;break;case l.ErrorDetails.REMUX_ALLOC_ERROR:g=null!=(d=c.level)?d:this.currentLevelIndex,f=!0}void 0!==g&&this.recoverLevel(c,g,f,k)}}};c.recoverLevel=function(a,b,c,d){var e=a.details,f=this._levels[b];f.loadError++;if(c)if(this.retryLoadingOrFail(a))a.levelRetry=!0;else{this.currentLevelIndex=-1;return}if(d)if(c=f.url.length,1<c&&f.loadError<c)a.levelRetry=
!0,this.redundantFailover(b);else if(-1===this.manualLevelIndex){b=-1;f=this._levels;for(c=f.length;c--;)if(d=(c+this.currentLevelIndex)%f.length,d!==this.currentLevelIndex&&0===f[d].loadError){b=d;break}-1<b&&this.currentLevelIndex!==b&&(this.warn(e+": switch to "+b),a.levelRetry=!0,this.hls.nextAutoLevel=b)}};c.redundantFailover=function(a){var b=this._levels[a],c=b.url.length;if(1<c){var d=(b.urlId+1)%c;this.warn("Switching to redundant URL-id "+d);this._levels.forEach(function(a){a.urlId=d});
this.level=a}};c.onFragLoaded=function(a,b){var c=b.frag;void 0!==c&&c.type===C.PlaylistLevelType.MAIN&&(c=this._levels[c.level],void 0!==c&&(c.fragmentError=0,c.loadError=0))};c.onLevelLoaded=function(a,b){var c,d=b.level,e=b.details,f=this._levels[d];if(f)if(d===this.currentLevelIndex)0===f.fragmentError&&(this.retryCount=f.loadError=0),this.playlistLoaded(d,b,f.details);else{if(null!==(c=b.deliveryDirectives)&&void 0!==c&&c.skip)e.deltaUpdateFailed=!0}else{var k;this.warn("Invalid level index "+
d);if(null!==(k=b.deliveryDirectives)&&void 0!==k&&k.skip)e.deltaUpdateFailed=!0}};c.onAudioTrackSwitched=function(a,b){var c=this.hls.levels[this.currentLevelIndex];if(c&&c.audioGroupIds){for(var d=-1,e=this.hls.audioTracks[b.id].groupId,f=0;f<c.audioGroupIds.length;f++)if(c.audioGroupIds[f]===e){d=f;break}d!==c.urlId&&(c.urlId=d,this.startLoad())}};c.loadPlaylist=function(a){var b=this.currentLevelIndex,c=this._levels[b];if(this.canLoad&&c&&0<c.url.length){var d=c.urlId,c=c.url[d];if(a)try{c=a.addDirectives(c)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+
e)}this.log("Attempt loading level index "+b+(a?" at sn "+a.msn+" part "+a.part:"")+" with URL-id "+d+" "+c);this.clearTimer();this.hls.trigger(t.Events.LEVEL_LOADING,{url:c,level:b,id:d,deliveryDirectives:a||null})}};c.removeLevel=function(a,b){var c=function(a,c){return c!==b},d=this._levels.filter(function(d,e){return e!==a?!0:1<d.url.length&&void 0!==b?(d.url=d.url.filter(c),d.audioGroupIds&&(d.audioGroupIds=d.audioGroupIds.filter(c)),d.textGroupIds&&(d.textGroupIds=d.textGroupIds.filter(c)),
d.urlId=0,!0):!1}).map(function(a,b){var c=a.details;null!==c&&(void 0!==c&&c.fragments)&&c.fragments.forEach(function(a){a.level=b});return a});this._levels=d;this.hls.trigger(t.Events.LEVELS_UPDATED,{levels:d})};f(b,[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(a){var b,c=this._levels;if(0!==c.length&&!(this.currentLevelIndex===a&&null!==(b=c[a])&&void 0!==b&&b.details)){if(0>a||a>=c.length){b=
0>a;this.hls.trigger(t.Events.ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.LEVEL_SWITCH_ERROR,level:a,fatal:b,reason:"invalid level idx"});if(b)return;a=Math.min(a,c.length-1)}this.clearTimer();var d=this.currentLevelIndex;b=c[d];c=c[a];this.log("switching to level "+a+" from "+d);this.currentLevelIndex=a;a=e({},c,{level:a,maxBitrate:c.maxBitrate,uri:c.uri,urlId:c.urlId});delete a._urlId;this.hls.trigger(t.Events.LEVEL_SWITCHING,a);a=c.details;if(!a||a.live)a=this.switchParams(c.uri,
null===b||void 0===b?void 0:b.details),this.loadPlaylist(a)}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(a){this.manualLevelIndex=a;void 0===this._startLevel&&(this._startLevel=a);-1!==a&&(this.level=a)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(a){this._firstLevel=a}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var a=this.hls.config.startLevel;return void 0!==a?a:this._firstLevel}return this._startLevel},set:function(a){this._startLevel=
a}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(a){this.level=a;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=a)}}]);return b}(c["default"])},"./src/controller/level-helper.ts":function(c,a,b){function e(){e=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}
function d(a,b,c){switch(b){case "audio":a.audioGroupIds||(a.audioGroupIds=[]);a.audioGroupIds.push(c);break;case "text":a.textGroupIds||(a.textGroupIds=[]),a.textGroupIds.push(c)}}function f(a){var b={};a.forEach(function(a){var c=a.groupId||"";a.id=b[c]=b[c]||0;b[c]++})}function g(a,b,c){n(a[b],a[c])}function n(a,b){var c=b.startPTS;if(Object(D.isFiniteNumber)(c)){var d=0;b.sn>a.sn?(d=c-a.start,c=a):(d=a.start-c,c=b);c.duration!==d&&(c.duration=d)}else b.start=b.sn>a.sn?a.cc===b.cc&&a.minEndPTS?
a.start+(a.minEndPTS-a.start):a.start+a.duration:Math.max(a.start-b.duration,0)}function k(a,b,c,d,e,f){0>=d-c&&(m.logger.warn("Fragment should have a positive duration",b),d=c+b.duration,f=e+b.duration);var k=c,g=d,l=b.startPTS,u=b.endPTS;Object(D.isFiniteNumber)(l)&&(k=Math.abs(l-c),Object(D.isFiniteNumber)(b.deltaPTS)?b.deltaPTS=Math.max(k,b.deltaPTS):b.deltaPTS=k,k=Math.max(c,l),c=Math.min(c,l),e=Math.min(e,b.startDTS),g=Math.min(d,u),d=Math.max(d,u),f=Math.max(f,b.endDTS));b.duration=d-c;l=c-
b.start;b.appendedPTS=d;b.start=b.startPTS=c;b.maxStartPTS=k;b.startDTS=e;b.endPTS=d;b.minEndPTS=g;b.endDTS=f;c=b.sn;if(!a||c<a.startSN||c>a.endSN)return 0;c-=a.startSN;d=a.fragments;d[c]=b;for(b=c;0<b;b--)n(d[b],d[b-1]);for(b=c;b<d.length-1;b++)n(d[b],d[b+1]);a.fragmentHint&&n(d[d.length-1],a.fragmentHint);a.PTSKnown=a.alignedSliding=!0;return l}function t(a,b){for(var c=null,d=a.fragments,e=d.length-1;0<=e;e--){var f=d[e].initSegment;if(f){c=f;break}}a.fragmentHint&&delete a.fragmentHint.endPTS;
var g=0,n;r(a,b,function(a,d){a.relurl&&(g=a.cc-d.cc);Object(D.isFiniteNumber)(a.startPTS)&&Object(D.isFiniteNumber)(a.endPTS)&&(d.start=d.startPTS=a.startPTS,d.startDTS=a.startDTS,d.appendedPTS=a.appendedPTS,d.maxStartPTS=a.maxStartPTS,d.endPTS=a.endPTS,d.endDTS=a.endDTS,d.minEndPTS=a.minEndPTS,d.duration=a.endPTS-a.startPTS,d.duration&&(n=d),b.PTSKnown=b.alignedSliding=!0);d.elementaryStreams=a.elementaryStreams;d.loader=a.loader;d.stats=a.stats;d.urlId=a.urlId;a.initSegment&&(c=d.initSegment=a.initSegment)});
c&&(b.fragmentHint?b.fragments.concat(b.fragmentHint):b.fragments).forEach(function(a){var b;if(!a.initSegment||a.initSegment.relurl===(null===(b=c)||void 0===b?void 0:b.relurl))a.initSegment=c});if(b.skippedSegments)if(b.deltaUpdateFailed=b.fragments.some(function(a){return!a}),b.deltaUpdateFailed){m.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(d=b.skippedSegments;d--;)b.fragments.shift();b.startSN=b.fragments[0].sn;b.startCC=b.fragments[0].cc}else b.canSkipDateRanges&&
(b.dateRanges=l(a.dateRanges,b.dateRanges,b.recentlyRemovedDateranges));d=b.fragments;if(g){m.logger.warn("discontinuity sliding from playlist, take drift into account");for(e=0;e<d.length;e++)d[e].cc+=g}b.skippedSegments&&(b.startCC=b.fragments[0].cc);w(a.partList,b.partList,function(a,b){b.elementaryStreams=a.elementaryStreams;b.stats=a.stats});n?k(b,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):C(a,b);d.length&&(b.totalduration=b.edge-d[0].start);b.driftStartTime=a.driftStartTime;b.driftStart=a.driftStart;
d=b.advancedDateTime;b.advanced&&d?(e=b.edge,b.driftStart||(b.driftStartTime=d,b.driftStart=e),b.driftEndTime=d,b.driftEnd=e):(b.driftEndTime=a.driftEndTime,b.driftEnd=a.driftEnd,b.advancedDateTime=a.advancedDateTime)}function l(a,b,c){var d=e({},a);c&&c.forEach(function(a){delete d[a]});Object.keys(b).forEach(function(a){var c=new y.DateRange(b[a].attr,d[a]);c.isValid?d[a]=c:m.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(b[a].attr)+'"')});return d}function w(a,
b,c){if(a&&b)for(var d=0,e=0,f=a.length;e<=f;e++){var k=a[e],m=b[e+d];k&&m&&k.index===m.index&&k.fragment.sn===m.fragment.sn?c(k,m):d--}}function r(a,b,c){var d=b.skippedSegments,e=Math.max(a.startSN,b.startSN)-b.startSN,f=(a.fragmentHint?1:0)+(d?b.endSN:Math.min(a.endSN,b.endSN))-b.startSN,k=b.startSN-a.startSN,m=b.fragmentHint?b.fragments.concat(b.fragmentHint):b.fragments;for(a=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;e<=f;e++){var g=a[k+e],l=m[e];d&&(!l&&e<d)&&(l=b.fragments[e]=
g);g&&l&&c(g,l)}}function C(a,b){var c=b.startSN+b.skippedSegments-a.startSN,d=a.fragments;0>c||c>=d.length||z(b,d[c].start)}function z(a,b){if(b){for(var c=a.fragments,d=a.skippedSegments;d<c.length;d++)c[d].start+=b;a.fragmentHint&&(a.fragmentHint.start+=b)}}function A(a,b){var c=1E3*a.levelTargetDuration,d=c/2,e=a.age,f=0<e&&e<3*c,k=b.loading.end-b.loading.start,m=a.availabilityDelay;!1===a.updated?f&&(c=333*a.misses,d=Math.max(Math.min(d,2*k),c),a.availabilityDelay=(a.availabilityDelay||0)+d):
f?(m=Math.min(m||c/2,e),a.availabilityDelay=m,d=m+c-e):d=c-k;return Math.round(d)}function q(a,b,c){if(!a||!a.details)return null;a=a.details;var d=a.fragments[b-a.startSN];return d?d:(d=a.fragmentHint)&&d.sn===b?d:b<a.startSN&&c&&c.sn===b?c:null}function u(a,b,c){if(!a||!a.details)return null;if(a=a.details.partList)for(var d=a.length;d--;){var e=a[d];if(e.index===c&&e.fragment.sn===b)return e}return null}b.r(a);b.d(a,"addGroupId",function(){return d});b.d(a,"assignTrackIdsByGroup",function(){return f});
b.d(a,"updatePTS",function(){return g});b.d(a,"updateFragPTSDTS",function(){return k});b.d(a,"mergeDetails",function(){return t});b.d(a,"mapPartIntersection",function(){return w});b.d(a,"mapFragmentIntersection",function(){return r});b.d(a,"adjustSliding",function(){return C});b.d(a,"addSliding",function(){return z});b.d(a,"computeReloadInterval",function(){return A});b.d(a,"getFragmentWithSN",function(){return q});b.d(a,"getPartWith",function(){return u});var D=b("./src/polyfills/number.ts"),m=b("./src/utils/logger.ts"),
y=b("./src/loader/date-range.ts")},"./src/controller/stream-controller.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}function f(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;g(a,b)}function g(a,b){g=Object.setPrototypeOf?Object.setPrototypeOf.bind():
function(a,b){a.__proto__=b;return a};return g(a,b)}b.r(a);b.d(a,"default",function(){return m});var n=b("./src/polyfills/number.ts"),k=b("./src/controller/base-stream-controller.ts"),t=b("./src/is-supported.ts"),l=b("./src/events.ts"),w=b("./src/utils/buffer-helper.ts"),r=b("./src/controller/fragment-tracker.ts"),C=b("./src/types/loader.ts"),z=b("./src/loader/fragment.ts"),A=b("./src/demux/transmuxer-interface.ts"),q=b("./src/types/transmuxer.ts"),u=b("./src/controller/gap-controller.ts"),D=b("./src/errors.ts"),
m=function(a){function b(c,d){var e;e=a.call(this,c,d,"[stream-controller]")||this;e.audioCodecSwap=!1;e.gapController=null;e.level=-1;e._forceStartLoad=!1;e.altAudio=!1;e.audioOnly=!1;e.fragPlaying=null;e.onvplaying=null;e.onvseeked=null;e.fragLastKbps=0;e.couldBacktrack=!1;e.backtrackFragment=null;e.audioCodecSwitch=!1;e.videoBuffer=null;e._registerListeners();return e}f(b,a);var c=b.prototype;c._registerListeners=function(){var a=this.hls;a.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this);
a.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this);a.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this);a.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.on(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this);a.on(l.Events.ERROR,this.onError,this);a.on(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.on(l.Events.AUDIO_TRACK_SWITCHED,
this.onAudioTrackSwitched,this);a.on(l.Events.BUFFER_CREATED,this.onBufferCreated,this);a.on(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this);a.on(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this);a.on(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)};c._unregisterListeners=function(){var a=this.hls;a.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.off(l.Events.MANIFEST_PARSED,
this.onManifestParsed,this);a.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this);a.off(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this);a.off(l.Events.ERROR,this.onError,this);a.off(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.off(l.Events.BUFFER_CREATED,this.onBufferCreated,this);a.off(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this);a.off(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,
this);a.off(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)};c.onHandlerDestroying=function(){this._unregisterListeners();this.onMediaDetaching()};c.startLoad=function(a){if(this.levels){var b=this.lastCurrentTime,c=this.hls;this.stopLoad();this.setInterval(100);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var d=c.startLevel;-1===d&&(c.config.testBandwidth&&1<this.levels.length?(d=0,this.bitrateTest=!0):d=c.nextAutoLevel);this.level=c.nextLoadLevel=d;this.loadedmetadata=!1}0<b&&
-1===a&&(this.log("Override startPosition with lastCurrentTime @"+b.toFixed(3)),a=b);this.state=k.State.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a;this.tick()}else this._forceStartLoad=!0,this.state=k.State.STOPPED};c.stopLoad=function(){this._forceStartLoad=!1;a.prototype.stopLoad.call(this)};c.doTick=function(){switch(this.state){case k.State.IDLE:this.doTickIdle();break;case k.State.WAITING_LEVEL:var a,b=this.levels,c=this.level;if((b=null===b||void 0===b?void 0:null===
(a=b[c])||void 0===a?void 0:a.details)&&(!b.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(b))break;this.state=k.State.IDLE;break}break;case k.State.FRAG_LOADING_WAITING_RETRY:if(a=self.performance.now(),c=this.retryDate,!c||a>=c||null!==(b=this.media)&&void 0!==b&&b.seeking)this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=k.State.IDLE}this.onTickEnd()};c.onTickEnd=function(){a.prototype.onTickEnd.call(this);this.checkBuffer();
this.checkFragmentChanged()};c.doTickIdle=function(){var a,b,c=this.hls,d=this.levels,e=this.media,f=c.config,m=c.nextLoadLevel;if(!(null===this.levelLastLoaded||!e&&(this.startFragRequested||!f.startFragPrefetch)))if((!this.altAudio||!this.audioOnly)&&d&&d[m])if(d=d[m],this.level=c.nextLoadLevel=m,c=d.details,!c||this.state===k.State.WAITING_LEVEL||c.live&&this.levelLastLoaded!==m)this.state=k.State.WAITING_LEVEL;else if(m=this.getMainFwdBufferInfo(),null!==m&&(f=m.len,d=this.getMaxBufferLength(d.maxBitrate),
!(f>=d)))if(this._streamEnded(m,c))a={},this.altAudio&&(a.type="video"),this.hls.trigger(l.Events.BUFFER_EOS,a),this.state=k.State.ENDED;else{this.backtrackFragment&&this.backtrackFragment.start>m.end&&(this.backtrackFragment=null);d=this.backtrackFragment?this.backtrackFragment.start:m.end;f=this.getNextFragment(d,c);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==r.FragmentState.OK){var p,m=(null!=(p=this.backtrackFragment)?p:f).sn-c.startSN;
if((p=c.fragments[m-1])&&f.cc===p.cc)f=p,this.fragmentTracker.removeFragment(p)}else this.backtrackFragment&&m.len&&(this.backtrackFragment=null);f&&(this.fragmentTracker.getState(f)===r.FragmentState.OK&&this.nextLoadPosition>d)&&(p=this.audioOnly&&!this.altAudio?z.ElementaryStreamTypes.AUDIO:z.ElementaryStreamTypes.VIDEO,e&&this.afterBufferFlushed(e,p,C.PlaylistLevelType.MAIN),f=this.getNextFragment(this.nextLoadPosition,c));f&&(f.initSegment&&(!f.initSegment.data&&!this.bitrateTest)&&(f=f.initSegment),
"identity"===(null===(a=f.decryptdata)||void 0===a?void 0:a.keyFormat)&&!(null!==(b=f.decryptdata)&&void 0!==b&&b.key)?this.loadKey(f,c):this.loadFragment(f,c,d))}};c.loadFragment=function(b,c,d){var e,f=this.fragmentTracker.getState(b);this.fragCurrent=b;f===r.FragmentState.NOT_LOADED?"initSegment"===b.sn?this._loadInitSegment(b):this.bitrateTest?(this.log("Fragment "+b.sn+" of level "+b.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(b)):(this.startFragRequested=
!0,a.prototype.loadFragment.call(this,b,c,d)):f===r.FragmentState.APPENDING?this.reduceMaxBufferLength(b.duration)&&this.fragmentTracker.removeFragment(b):0===(null===(e=this.media)||void 0===e?void 0:e.buffered.length)&&this.fragmentTracker.removeAllFragments()};c.getAppendedFrag=function(a){return(a=this.fragmentTracker.getAppendedFrag(a,C.PlaylistLevelType.MAIN))&&"fragment"in a?a.fragment:a};c.getBufferedFrag=function(a){return this.fragmentTracker.getBufferedFrag(a,C.PlaylistLevelType.MAIN)};
c.followingBufferedFrag=function(a){return a?this.getBufferedFrag(a.end+0.5):null};c.immediateLevelSwitch=function(){this.abortCurrentFrag();this.flushMainBuffer(0,Number.POSITIVE_INFINITY)};c.nextLevelSwitch=function(){var a=this.levels,b=this.media;if(null!==b&&void 0!==b&&b.readyState){var c=this.getAppendedFrag(b.currentTime);c&&1<c.start&&this.flushMainBuffer(0,c.start-1);!b.paused&&a?(a=a[this.hls.nextLoadLevel],a=(c=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*a.maxBitrate/
(1E3*c)+1:0):a=0;if(b=this.getBufferedFrag(b.currentTime+a))if(a=this.followingBufferedFrag(b))this.abortCurrentFrag(),c=a.duration,b=Math.max(b.end,(a.maxStartPTS?a.maxStartPTS:a.start)+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,0.5*c),0.75*c)),this.flushMainBuffer(b,Number.POSITIVE_INFINITY)}};c.abortCurrentFrag=function(){var a=this.fragCurrent;this.backtrackFragment=this.fragCurrent=null;null!==a&&(void 0!==a&&a.loader)&&a.loader.abort();switch(this.state){case k.State.KEY_LOADING:case k.State.FRAG_LOADING:case k.State.FRAG_LOADING_WAITING_RETRY:case k.State.PARSING:case k.State.PARSED:this.state=
k.State.IDLE}this.nextLoadPosition=this.getLoadPosition()};c.flushMainBuffer=function(b,c){a.prototype.flushMainBuffer.call(this,b,c,this.altAudio?"video":null)};c.onMediaAttached=function(b,c){a.prototype.onMediaAttached.call(this,b,c);var d=c.media;this.onvplaying=this.onMediaPlaying.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);d.addEventListener("playing",this.onvplaying);d.addEventListener("seeked",this.onvseeked);this.gapController=new u["default"](this.config,d,this.fragmentTracker,
this.hls)};c.onMediaDetaching=function(){var b=this.media;b&&(this.onvplaying&&this.onvseeked)&&(b.removeEventListener("playing",this.onvplaying),b.removeEventListener("seeked",this.onvseeked),this.videoBuffer=this.onvplaying=this.onvseeked=null);this.fragPlaying=null;this.gapController&&(this.gapController.destroy(),this.gapController=null);a.prototype.onMediaDetaching.call(this)};c.onMediaPlaying=function(){this.tick()};c.onMediaSeeked=function(){var a=this.media,a=a?a.currentTime:null;Object(n.isFiniteNumber)(a)&&
this.log("Media seeked to "+a.toFixed(3));this.tick()};c.onManifestLoading=function(){this.log("Trigger BUFFER_RESET");this.hls.trigger(l.Events.BUFFER_RESET,void 0);this.fragmentTracker.removeAllFragments();this.couldBacktrack=!1;this.startPosition=this.lastCurrentTime=0;this.backtrackFragment=this.fragPlaying=null};c.onManifestParsed=function(a,b){var c=!1,d=!1,e;b.levels.forEach(function(a){if(e=a.audioCodec)-1!==e.indexOf("mp4a.40.2")&&(c=!0),-1!==e.indexOf("mp4a.40.5")&&(d=!0)});(this.audioCodecSwitch=
c&&d&&!Object(t.changeTypeSupported)())&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=b.levels;this.startFragRequested=!1};c.onLevelLoading=function(a,b){var c=this.levels;if(c&&this.state===k.State.IDLE&&(c=c[b.level],!c.details||c.details.live&&this.levelLastLoaded!==b.level||this.waitForCdnTuneIn(c.details)))this.state=k.State.WAITING_LEVEL};c.onLevelLoaded=function(a,b){var c,d=this.levels,e=b.level,f=b.details,m=f.totalduration;if(d){this.log("Level "+
e+" loaded ["+f.startSN+","+f.endSN+"], cc ["+f.startCC+", "+f.endCC+"] duration:"+m);if((m=this.fragCurrent)&&(this.state===k.State.FRAG_LOADING||this.state===k.State.FRAG_LOADING_WAITING_RETRY)&&m.level!==b.level&&m.loader)this.state=k.State.IDLE,this.backtrackFragment=null,m.loader.abort();d=d[e];m=0;if(f.live||null!==(c=d.details)&&void 0!==c&&c.live){f.fragments[0]||(f.deltaUpdateFailed=!0);if(f.deltaUpdateFailed)return;m=this.alignPlaylists(f,d.details)}d.details=f;this.levelLastLoaded=e;this.hls.trigger(l.Events.LEVEL_UPDATED,
{details:f,level:e});if(this.state===k.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(f))return;this.state=k.State.IDLE}this.startFragRequested?f.live&&this.synchronizeToLiveEdge(f):this.setStartPosition(f,m);this.tick()}else this.warn("Levels were reset while loading level "+e)};c._handleFragmentLoadProgress=function(a){var b,c=a.frag,d=a.part;a=a.payload;var e=this.levels;if(e){var f=e[c.level];if(e=f.details){var k=f.videoCodec,m=e.PTSKnown||!e.live,p=null===(b=c.initSegment)||void 0===b?void 0:
b.data;b=this._getAudioCodec(f);var f=this.transmuxer=this.transmuxer||new A["default"](this.hls,C.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),g=d?d.index:-1,g=new q.ChunkMetadata(c.level,c.sn,c.stats.chunkCount,a.byteLength,g,-1!==g);f.push(a,p,b,k,c,d,e.totalduration,m,g,this.initPTS[c.cc])}else this.warn("Dropping fragment "+c.sn+" of level "+c.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+
c.sn+" of level "+c.level+" will not be buffered")};c.onAudioTrackSwitching=function(a,b){var c=this.altAudio,d=b.id;if(!b.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var e=this.fragCurrent;null!==e&&(void 0!==e&&e.loader)&&(this.log("Switching to main audio track, cancel main fragment load"),e.loader.abort());this.resetTransmuxer();this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();
e=this.hls;c&&e.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"});e.trigger(l.Events.AUDIO_TRACK_SWITCHED,{id:d})}};c.onAudioTrackSwitched=function(a,b){var c=!!this.hls.audioTracks[b.id].url;if(c){var d=this.videoBuffer;d&&this.mediaBuffer!==d&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=d)}this.altAudio=c;this.tick()};c.onBufferCreated=function(a,b){var c=b.tracks,d,e,f=!1,k;for(k in c){var m=
c[k];if("main"===m.id){if(e=k,d=m,"video"===k&&(m=c[k]))this.videoBuffer=m.buffer}else f=!0}f&&d?(this.log("Alternate track found, use "+e+".buffered to schedule main fragment loading"),this.mediaBuffer=d.buffer):this.mediaBuffer=this.media};c.onFragBuffered=function(a,b){var c=b.frag,d=b.part;if(!(c&&c.type!==C.PlaylistLevelType.MAIN))if(this.fragContextChanged(c))this.warn("Fragment "+c.sn+(d?" p: "+d.index:"")+" of level "+c.level+" finished buffering, but was aborted. state: "+this.state),this.state===
k.State.PARSED&&(this.state=k.State.IDLE);else{var e=d?d.stats:c.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first));"initSegment"!==c.sn&&(this.fragPrevious=c);this.fragBufferedComplete(c,d)}};c.onError=function(a,b){switch(b.details){case D.ErrorDetails.FRAG_LOAD_ERROR:case D.ErrorDetails.FRAG_LOAD_TIMEOUT:case D.ErrorDetails.KEY_LOAD_ERROR:case D.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(C.PlaylistLevelType.MAIN,b);break;case D.ErrorDetails.LEVEL_LOAD_ERROR:case D.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==
k.State.ERROR&&(b.fatal?(this.warn(""+b.details),this.state=k.State.ERROR):!b.levelRetry&&this.state===k.State.WAITING_LEVEL&&(this.state=k.State.IDLE));break;case D.ErrorDetails.BUFFER_FULL_ERROR:if("main"===b.parent&&(this.state===k.State.PARSING||this.state===k.State.PARSED)){var c=!0,d=this.getFwdBufferInfo(this.media,C.PlaylistLevelType.MAIN);d&&0.5<d.len&&(c=!this.reduceMaxBufferLength(d.len));c&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch());
this.resetLoadingState()}}};c.checkBuffer=function(){var a=this.media,b=this.gapController;if(a&&b&&a.readyState){if(this.loadedmetadata||!w.BufferHelper.getBuffered(a).length)b.poll(this.lastCurrentTime,this.state!==k.State.IDLE?this.fragCurrent:null);this.lastCurrentTime=a.currentTime}};c.onFragLoadEmergencyAborted=function(){this.state=k.State.IDLE;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tickImmediate()};c.onBufferFlushed=function(a,b){var c=
b.type;if(c!==z.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio)this.afterBufferFlushed((c===z.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,c,C.PlaylistLevelType.MAIN)};c.onLevelsUpdated=function(a,b){this.levels=b.levels};c.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap};c.seekToStartPos=function(){var a=this.media;if(a){var b=a.currentTime,c=this.startPosition;if(0<=c&&b<c)if(a.seeking)this.log("could not seek to "+c+", already seeking at "+
b);else{var d=w.BufferHelper.getBuffered(a),d=(d.length?d.start(0):0)-c;if(0<d&&(d<this.config.maxBufferHole||d<this.config.maxFragLookUpTolerance))this.log("adjusting start position by "+d+" to match buffer start"),this.startPosition=c+=d;this.log("seek to target start position "+c+" from current time "+b);a.currentTime=c}}};c._getAudioCodec=function(a){a=this.config.defaultAudioCodec||a.audioCodec;this.audioCodecSwap&&a&&(this.log("Swapping audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":
"mp4a.40.5");return a};c._loadBitrateTestFrag=function(a){var b=this;a.bitrateTest=!0;this._doFragLoad(a).then(function(c){var d=b.hls;if(c&&!d.nextLoadLevel&&!b.fragContextChanged(a)){b.fragLoadError=0;b.state=k.State.IDLE;b.startFragRequested=!1;b.bitrateTest=!1;var e=a.stats;e.parsing.start=e.parsing.end=e.buffering.start=e.buffering.end=self.performance.now();d.trigger(l.Events.FRAG_LOADED,c);a.bitrateTest=!1}})};c._handleTransmuxComplete=function(a){var b,c=this.hls,d=a.remuxResult;a=a.chunkMeta;
var e=this.getCurrentContext(a);if(e){var f=e.frag,m=e.part,p=e.level,g=d.video,e=d.text,u=d.id3,r=d.initSegment,v=p.details,q=this.altAudio?void 0:d.audio;if(!this.fragContextChanged(f)){this.state=k.State.PARSING;r&&(r.tracks&&(this._bufferInitSegment(p,r.tracks,f,a),c.trigger(l.Events.FRAG_PARSING_INIT_SEGMENT,{frag:f,id:"main",tracks:r.tracks})),p=r.initPTS,r=r.timescale,Object(n.isFiniteNumber)(p)&&(this.initPTS[f.cc]=p,c.trigger(l.Events.INIT_PTS_FOUND,{frag:f,id:"main",initPTS:p,timescale:r})));
if(g&&!1!==d.independent){if(v){var d=g.startPTS,r=g.endPTS,p=g.startDTS,y=g.endDTS;if(m)m.elementaryStreams[g.type]={startPTS:d,endPTS:r,startDTS:p,endDTS:y};else if(g.firstKeyFrame&&g.independent&&(this.couldBacktrack=!0),g.dropped&&g.independent){var t=this.getMainFwdBufferInfo();if((t?t.end:this.getLoadPosition())+this.config.maxBufferHole<(g.firstKeyFramePTS?g.firstKeyFramePTS:d)-this.config.maxBufferHole){this.backtrack(f);return}f.setElementaryStreamInfo(g.type,f.start,r,f.start,y,!0)}f.setElementaryStreamInfo(g.type,
d,r,p,y);this.backtrackFragment&&(this.backtrackFragment=f);this.bufferFragmentData(g,f,m,a)}}else if(!1===d.independent){this.backtrack(f);return}q&&(g=q.startPTS,d=q.endPTS,r=q.startDTS,p=q.endDTS,m&&(m.elementaryStreams[z.ElementaryStreamTypes.AUDIO]={startPTS:g,endPTS:d,startDTS:r,endDTS:p}),f.setElementaryStreamInfo(z.ElementaryStreamTypes.AUDIO,g,d,r,p),this.bufferFragmentData(q,f,m,a));v&&(null!==u&&void 0!==u&&null!==(b=u.samples)&&void 0!==b&&b.length)&&c.trigger(l.Events.FRAG_PARSING_METADATA,
{id:"main",frag:f,details:v,samples:u.samples});v&&e&&c.trigger(l.Events.FRAG_PARSING_USERDATA,{id:"main",frag:f,details:v,samples:e.samples})}}else this.warn("The loading context changed while buffering fragment "+a.sn+" of level "+a.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(a.level)};c._bufferInitSegment=function(a,b,c,d){var e=this;if(this.state===k.State.PARSING){this.audioOnly=!!b.audio&&!b.video;this.altAudio&&!this.audioOnly&&delete b.audio;var f=b.audio,m=b.video,
p=b.audiovideo;if(f){var g=a.audioCodec,n=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(g&&(g=-1!==g.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==f.metadata.channelCount&&-1===n.indexOf("firefox")&&(g="mp4a.40.5"));-1!==n.indexOf("android")&&"audio/mpeg"!==f.container&&(g="mp4a.40.2",this.log("Android: force audio codec to "+g));a.audioCodec&&a.audioCodec!==g&&this.log('Swapping manifest audio codec "'+a.audioCodec+'" for "'+g+'"');f.levelCodec=g;f.id="main";this.log("Init audio buffer, container:"+
f.container+", codecs[selected/level/parsed]=["+(g||"")+"/"+(a.audioCodec||"")+"/"+f.codec+"]")}m&&(m.levelCodec=a.videoCodec,m.id="main",this.log("Init video buffer, container:"+m.container+", codecs[level/parsed]=["+(a.videoCodec||"")+"/"+m.codec+"]"));p&&this.log("Init audiovideo buffer, container:"+p.container+", codecs[level/parsed]=["+(a.attrs.CODECS||"")+"/"+p.codec+"]");this.hls.trigger(l.Events.BUFFER_CODECS,b);Object.keys(b).forEach(function(a){var f=b[a].initSegment;null!==f&&(void 0!==
f&&f.byteLength)&&e.hls.trigger(l.Events.BUFFER_APPENDING,{type:a,data:f,frag:c,part:null,chunkMeta:d,parent:c.type})});this.tick()}};c.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,C.PlaylistLevelType.MAIN)};c.backtrack=function(a){this.couldBacktrack=!0;this.backtrackFragment=a;this.resetTransmuxer();this.flushBufferGap(a);this.fragmentTracker.removeFragment(a);this.fragPrevious=null;this.nextLoadPosition=a.start;this.state=k.State.IDLE};
c.checkFragmentChanged=function(){var a=this.media,b=null;if(a&&1<a.readyState&&!1===a.seeking){var c=a.currentTime;w.BufferHelper.isBuffered(a,c)?b=this.getAppendedFrag(c):w.BufferHelper.isBuffered(a,c+0.1)&&(b=this.getAppendedFrag(c+0.1));if(b&&(this.backtrackFragment=null,a=this.fragPlaying,c=b.level,!a||b.sn!==a.sn||a.level!==c||b.urlId!==a.urlId))this.hls.trigger(l.Events.FRAG_CHANGED,{frag:b}),(!a||a.level!==c)&&this.hls.trigger(l.Events.LEVEL_SWITCHED,{level:c}),this.fragPlaying=b}};d(b,[{key:"nextLevel",
get:function(){var a=this.nextBufferedFrag;return a?a.level:-1}},{key:"currentFrag",get:function(){var a=this.media;return a?this.fragPlaying||this.getAppendedFrag(a.currentTime):null}},{key:"currentProgramDateTime",get:function(){var a=this.media;if(a){var a=a.currentTime,b=this.currentFrag;if(b&&Object(n.isFiniteNumber)(a)&&Object(n.isFiniteNumber)(b.programDateTime))return new Date(b.programDateTime+1E3*(a-b.start))}return null}},{key:"currentLevel",get:function(){var a=this.currentFrag;return a?
a.level:-1}},{key:"nextBufferedFrag",get:function(){var a=this.currentFrag;return a?this.followingBufferedFrag(a):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]);return b}(k["default"])},"./src/crypt/aes-crypto.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return e});var e=function(){function a(b,c){this.aesIV=this.subtle=void 0;this.subtle=b;this.aesIV=c}a.prototype.decrypt=function(a,b){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},b,a)};return a}()},
"./src/crypt/aes-decryptor.ts":function(c,a,b){function e(a){var b=a.byteLength,c=b&&(new DataView(a.buffer)).getUint8(b-1);return c?Object(d.sliceUint8)(a,0,b-c):a}b.r(a);b.d(a,"removePadding",function(){return e});b.d(a,"default",function(){return f});var d=b("./src/utils/typed-array.ts"),f=function(){function a(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),
new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.keySize=this.ksRows=0;this.invKeySchedule=this.keySchedule=void 0;this.initTable()}var b=a.prototype;b.uint8ArrayToUint32Array_=function(a){a=new DataView(a);for(var b=new Uint32Array(4),c=0;4>c;c++)b[c]=a.getUint32(4*c);return b};b.initTable=function(){for(var a=this.sBox,b=this.invSBox,c=this.subMix,d=c[0],e=c[1],f=c[2],c=c[3],g=this.invSubMix,n=g[0],q=g[1],
u=g[2],g=g[3],D=new Uint32Array(256),m=0,y=0,v=0,v=0;256>v;v++)D[v]=128>v?v<<1:v<<1^283;for(v=0;256>v;v++){var p=y^y<<1^y<<2^y<<3^y<<4,p=p>>>8^p&255^99;a[m]=p;b[p]=m;var x=D[m],h=D[x],R=D[h],O=257*D[p]^16843008*p;d[m]=O<<24|O>>>8;e[m]=O<<16|O>>>16;f[m]=O<<8|O>>>24;c[m]=O;O=16843009*R^65537*h^257*x^16843008*m;n[p]=O<<24|O>>>8;q[p]=O<<16|O>>>16;u[p]=O<<8|O>>>24;g[p]=O;m?(m=x^D[D[D[R^x]]],y^=D[D[y]]):m=y=1}};b.expandKey=function(a){a=this.uint8ArrayToUint32Array_(a);for(var b=!0,c=0;c<a.length&&b;)b=
a[c]===this.key[c],c++;if(!b){this.key=a;var d=this.keySize=a.length;if(4!==d&&6!==d&&8!==d)throw Error("Invalid aes key size="+d);var b=this.ksRows=4*(d+6+1),e,c=this.keySchedule=new Uint32Array(b),f=this.invKeySchedule=new Uint32Array(b),g=this.sBox,n=this.rcon;e=this.invSubMix;var q=e[0],u=e[1],D=e[2],m=e[3],y;for(e=0;e<b;e++)e<d?y=c[e]=a[e]:(0===e%d?(y=y<<8|y>>>24,y=g[y>>>24]<<24|g[y>>>16&255]<<16|g[y>>>8&255]<<8|g[y&255],y^=n[e/d|0]<<24):6<d&&4===e%d&&(y=g[y>>>24]<<24|g[y>>>16&255]<<16|g[y>>>
8&255]<<8|g[y&255]),c[e]=y=(c[e-d]^y)>>>0);for(a=0;a<b;a++)e=b-a,y=a&3?c[e]:c[e-4],f[a]=4>a||4>=e?y:q[g[y>>>24]]^u[g[y>>>16&255]]^D[g[y>>>8&255]]^m[g[y&255]],f[a]>>>=0}};b.networkToHostOrderSwap=function(a){return a<<24|(a&65280)<<8|(a&16711680)>>8|a>>>24};b.decrypt=function(a,b,c){var d=this.keySize+6,e=this.invKeySchedule,f=this.invSBox,g=this.invSubMix,n=g[0],q=g[1],u=g[2],g=g[3],D=this.uint8ArrayToUint32Array_(c);c=D[0];var m=D[1],y=D[2],D=D[3];a=new Int32Array(a);for(var v=new Int32Array(a.length),
p,x,h,R,O,ca,V,va,U,ra,X,P,W,N=this.networkToHostOrderSwap;b<a.length;){va=N(a[b]);U=N(a[b+1]);ra=N(a[b+2]);X=N(a[b+3]);O=va^e[0];ca=X^e[1];V=ra^e[2];R=U^e[3];P=4;for(W=1;W<d;W++)p=n[O>>>24]^q[ca>>16&255]^u[V>>8&255]^g[R&255]^e[P],x=n[ca>>>24]^q[V>>16&255]^u[R>>8&255]^g[O&255]^e[P+1],h=n[V>>>24]^q[R>>16&255]^u[O>>8&255]^g[ca&255]^e[P+2],R=n[R>>>24]^q[O>>16&255]^u[ca>>8&255]^g[V&255]^e[P+3],O=p,ca=x,V=h,P+=4;p=f[O>>>24]<<24^f[ca>>16&255]<<16^f[V>>8&255]<<8^f[R&255]^e[P];x=f[ca>>>24]<<24^f[V>>16&255]<<
16^f[R>>8&255]<<8^f[O&255]^e[P+1];h=f[V>>>24]<<24^f[R>>16&255]<<16^f[O>>8&255]<<8^f[ca&255]^e[P+2];R=f[R>>>24]<<24^f[O>>16&255]<<16^f[ca>>8&255]<<8^f[V&255]^e[P+3];v[b]=N(p^c);v[b+1]=N(R^m);v[b+2]=N(h^y);v[b+3]=N(x^D);c=va;m=U;y=ra;D=X;b+=4}return v.buffer};return a}()},"./src/crypt/decrypter.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return t});var e=b("./src/crypt/aes-crypto.ts"),d=b("./src/crypt/fast-aes-key.ts"),f=b("./src/crypt/aes-decryptor.ts"),g=b("./src/utils/logger.ts"),n=b("./src/utils/mp4-tools.ts"),
k=b("./src/utils/typed-array.ts"),t=function(){function a(b,c,d){d=(void 0===d?{}:d).removePKCS7Padding;d=void 0===d?!0:d;this.logEnabled=!0;this.removePKCS7Padding=this.config=this.observer=void 0;this.currentResult=this.currentIV=this.remainderData=this.fastAesKey=this.key=this.softwareDecrypter=this.subtle=null;this.observer=b;this.config=c;if(this.removePKCS7Padding=d)try{var e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(f){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}
var b=a.prototype;b.destroy=function(){this.observer=null};b.isSync=function(){return this.config.enableSoftwareAES};b.flush=function(){var a=this.currentResult;if(a)return a=new Uint8Array(a),this.reset(),this.removePKCS7Padding?Object(f.removePadding)(a):a;this.reset()};b.reset=function(){this.remainderData=this.currentIV=this.currentResult=null;this.softwareDecrypter&&(this.softwareDecrypter=null)};b.decrypt=function(a,b,c,d){this.config.enableSoftwareAES?(this.softwareDecrypt(new Uint8Array(a),
b,c),(a=this.flush())&&d(a.buffer)):this.webCryptoDecrypt(new Uint8Array(a),b,c).then(d)};b.softwareDecrypt=function(a,b,c){var d=this.currentIV,e=this.currentResult,g=this.remainderData;this.logOnce("JS AES decrypt");g&&(a=Object(n.appendUint8Array)(g,a),this.remainderData=null);a=this.getValidChunk(a);if(!a.length)return null;d&&(c=d);d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new f["default"]);d.expandKey(b);this.currentResult=d.decrypt(a.buffer,0,c);this.currentIV=Object(k.sliceUint8)(a,
-16).buffer;return!e?null:e};b.webCryptoDecrypt=function(a,b,c){var f=this,k=this.subtle;if(this.key!==b||!this.fastAesKey)this.key=b,this.fastAesKey=new d["default"](k,b);return this.fastAesKey.expandKey().then(function(b){return!k?Promise.reject(Error("web crypto not initialized")):(new e["default"](k,c)).decrypt(a.buffer,b)}).catch(function(d){return f.onWebCryptoError(d,a,b,c)})};b.onWebCryptoError=function(a,b,c,d){g.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",a);this.logEnabled=
this.config.enableSoftwareAES=!0;return this.softwareDecrypt(b,c,d)};b.getValidChunk=function(a){var b=a,c=a.length-a.length%16;c!==a.length&&(b=Object(k.sliceUint8)(a,0,c),this.remainderData=Object(k.sliceUint8)(a,c));return b};b.logOnce=function(a){this.logEnabled&&(g.logger.log("[decrypter.ts]: "+a),this.logEnabled=!1)};return a}()},"./src/crypt/fast-aes-key.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return e});var e=function(){function a(b,c){this.key=this.subtle=void 0;this.subtle=
b;this.key=c}a.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])};return a}()},"./src/demux/aacdemuxer.ts":function(c,a,b){function e(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;d(a,b)}function d(a,b){d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return d(a,b)}b.r(a);c=b("./src/demux/base-audio-demuxer.ts");var f=b("./src/demux/adts.ts"),g=b("./src/utils/logger.ts"),
n=b("./src/demux/id3.ts");b=function(a){function b(c,d){var e;e=a.call(this)||this;e.observer=void 0;e.config=void 0;e.observer=c;e.config=d;return e}e(b,a);var c=b.prototype;c.resetInitSegment=function(b,c,d,e){a.prototype.resetInitSegment.call(this,b,c,d,e);this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:c,duration:e,inputTimeScale:9E4,dropped:0}};b.probe=function(a){if(!a)return!1;for(var b=(n.getID3Data(a,0)||[]).length,
c=a.length;b<c;b++)if(f.probe(a,b))return g.logger.log("ADTS sync word found !"),!0;return!1};c.canParse=function(a,b){return f.canParse(a,b)};c.appendFrame=function(a,b,c){f.initTrackConfig(a,this.observer,b,c,a.manifestCodec);if((a=f.appendFrame(a,b,c,this.basePTS,this.frameIndex))&&0===a.missing)return a};return b}(c["default"]);a["default"]=b},"./src/demux/adts.ts":function(c,a,b){function e(a,b,c,d){var e,f;f=navigator.userAgent.toLowerCase();var k=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,
16E3,12E3,11025,8E3,7350];e=((b[c+2]&192)>>>6)+1;var g=(b[c+2]&60)>>>2;if(g>k.length-1)a.trigger(u.Events.ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+g});else{a=(b[c+2]&1)<<2;a|=(b[c+3]&192)>>>6;A.logger.log("manifest codec:"+d+", ADTS type:"+e+", samplingIndex:"+g);if(/firefox/i.test(f))6<=g?(e=5,b=Array(4),f=g-3):(e=2,b=Array(2),f=g);else if(-1!==f.indexOf("android"))e=2,b=Array(2),f=g;else if(e=5,b=Array(4),d&&(-1!==
d.indexOf("mp4a.40.29")||-1!==d.indexOf("mp4a.40.5"))||!d&&6<=g)f=g-3;else{if(d&&-1!==d.indexOf("mp4a.40.2")&&(6<=g&&1===a||/vivaldi/i.test(f))||!d&&1===a)e=2,b=Array(2);f=g}b[0]=e<<3;b[0]|=(g&14)>>1;b[1]|=(g&1)<<7;b[1]|=a<<3;5===e&&(b[1]|=(f&14)>>1,b[2]=(f&1)<<7,b[2]|=8,b[3]=0);return{config:b,samplerate:k[g],channelCount:a,codec:"mp4a.40."+e,manifestCodec:d}}}function d(a,b){return 255===a[b]&&240===(a[b+1]&246)}function f(a,b){return a[b+1]&1?7:9}function g(a,b){return(a[b+3]&3)<<11|a[b+4]<<3|
(a[b+5]&224)>>>5}function n(a,b){return b+5<a.length}function k(a,b){return b+1<a.length&&d(a,b)}function t(a,b){return n(a,b)&&d(a,b)&&g(a,b)<=a.length-b}function l(a,b){if(k(a,b)){var c=f(a,b);if(b+c>=a.length)return!1;var d=g(a,b);if(d<=c)return!1;c=b+d;return c===a.length||k(a,c)}return!1}function w(a,b,c,d,f){if(!a.samplerate&&(b=e(b,c,d,f)))a.config=b.config,a.samplerate=b.samplerate,a.channelCount=b.channelCount,a.codec=b.codec,a.manifestCodec=b.manifestCodec,A.logger.log("parsed codec:"+a.codec+
", rate:"+b.samplerate+", channels:"+b.channelCount)}function r(a){return 9216E4/a}function h(a,b){var c=f(a,b);if(b+c<=a.length){var d=g(a,b)-c;if(0<d)return{headerLength:c,frameLength:d}}}function z(a,b,c,d,e){d+=e*(9216E4/a.samplerate);if(e=h(b,c)){var f=e.headerLength,k=f+e.frameLength,g=Math.max(0,c+k-b.length);g?(e=new Uint8Array(k-f),e.set(b.subarray(c+f,b.length),0)):e=b.subarray(c+f,c+k);b={unit:e,pts:d};g||a.samples.push(b);return{sample:b,length:k,missing:g}}a=b.length-c;e=new Uint8Array(a);
e.set(b.subarray(c,b.length),0);return{sample:{unit:e,pts:d},length:a,missing:-1}}b.r(a);b.d(a,"getAudioConfig",function(){return e});b.d(a,"isHeaderPattern",function(){return d});b.d(a,"getHeaderLength",function(){return f});b.d(a,"getFullFrameLength",function(){return g});b.d(a,"canGetFrameLength",function(){return n});b.d(a,"isHeader",function(){return k});b.d(a,"canParse",function(){return t});b.d(a,"probe",function(){return l});b.d(a,"initTrackConfig",function(){return w});b.d(a,"getFrameDuration",
function(){return r});b.d(a,"parseFrameHeader",function(){return h});b.d(a,"appendFrame",function(){return z});var A=b("./src/utils/logger.ts"),q=b("./src/errors.ts"),u=b("./src/events.ts")},"./src/demux/base-audio-demuxer.ts":function(c,a,b){b.r(a);b.d(a,"initPTSFn",function(){return t});var e=b("./src/polyfills/number.ts"),d=b("./src/demux/id3.ts"),f=b("./src/types/demuxer.ts"),g=b("./src/demux/dummy-demuxed-track.ts"),n=b("./src/utils/mp4-tools.ts"),k=b("./src/utils/typed-array.ts");c=function(){function a(){this._id3Track=
this._audioTrack=void 0;this.frameIndex=0;this.initPTS=this.basePTS=this.cachedData=null}var b=a.prototype;b.resetInitSegment=function(a,b,c,d){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9E4,sequenceNumber:0,samples:[],dropped:0}};b.resetTimeStamp=function(a){this.initPTS=a;this.resetContiguity()};b.resetContiguity=function(){this.basePTS=null;this.frameIndex=0};b.canParse=function(a,b){return!1};b.appendFrame=function(a,b,c){};b.demux=function(a,b){this.cachedData&&(a=Object(n.appendUint8Array)(this.cachedData,
a),this.cachedData=null);var c=d.getID3Data(a,0),l=c?c.length:0,q,u,w=this._audioTrack,m=this._id3Track;u=c?d.getTimeStamp(c):void 0;var y=a.length;if(null===this.basePTS||0===this.frameIndex&&Object(e.isFiniteNumber)(u))this.basePTS=t(u,b,this.initPTS);c&&0<c.length&&m.samples.push({pts:this.basePTS,dts:this.basePTS,data:c,type:f.MetadataSchema.audioId3});for(u=this.basePTS;l<y;)this.canParse(a,l)?(c=this.appendFrame(w,a,l))?(this.frameIndex++,u=c.sample.pts,q=l+=c.length):l=y:d.canParse(a,l)?(c=
d.getID3Data(a,l),m.samples.push({pts:u,dts:u,data:c,type:f.MetadataSchema.audioId3}),q=l+=c.length):l++,l===y&&q!==y&&(c=Object(k.sliceUint8)(a,q),this.cachedData=this.cachedData?Object(n.appendUint8Array)(this.cachedData,c):c);return{audioTrack:w,videoTrack:Object(g.dummyTrack)(),id3Track:m,textTrack:Object(g.dummyTrack)()}};b.demuxSampleAes=function(a,b,c){return Promise.reject(Error("["+this+"] This demuxer does not support Sample-AES decryption"))};b.flush=function(a){if(a=this.cachedData)this.cachedData=
null,this.demux(a,0);return{audioTrack:this._audioTrack,videoTrack:Object(g.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(g.dummyTrack)()}};b.destroy=function(){};return a}();var t=function(a,b,c){return Object(e.isFiniteNumber)(a)?90*a:9E4*b+(c||0)};a["default"]=c},"./src/demux/chunk-cache.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return e});var e=function(){function a(){this.chunks=[];this.dataLength=0}var b=a.prototype;b.push=function(a){this.chunks.push(a);this.dataLength+=
a.length};b.flush=function(){var a=this.chunks,b=this.dataLength;if(a.length)if(1===a.length)a=a[0];else{for(var b=new Uint8Array(b),c=0,d=0;d<a.length;d++){var e=a[d];b.set(e,c);c+=e.length}a=b}else return new Uint8Array(0);this.reset();return a};b.reset=function(){this.dataLength=this.chunks.length=0};return a}()},"./src/demux/dummy-demuxed-track.ts":function(c,a,b){function e(a,b){void 0===a&&(a="");void 0===b&&(b=9E4);return{type:a,id:-1,pid:-1,inputTimeScale:b,sequenceNumber:-1,samples:[],dropped:0}}
b.r(a);b.d(a,"dummyTrack",function(){return e})},"./src/demux/exp-golomb.ts":function(c,a,b){b.r(a);var e=b("./src/utils/logger.ts");c=function(){function a(b){this.bitsAvailable=this.word=this.bytesAvailable=this.data=void 0;this.data=b;this.bytesAvailable=b.byteLength;this.bitsAvailable=this.word=0}var b=a.prototype;b.loadWord=function(){var a=this.data,b=this.bytesAvailable,c=a.byteLength-b,d=new Uint8Array(4),b=Math.min(4,b);if(0===b)throw Error("no bytes available");d.set(a.subarray(c,c+b));
this.word=(new DataView(d.buffer)).getUint32(0);this.bitsAvailable=8*b;this.bytesAvailable-=b};b.skipBits=function(a){var b;this.bitsAvailable>a||(a-=this.bitsAvailable,b=a>>3,a-=b>>3,this.bytesAvailable-=b,this.loadWord());this.word<<=a;this.bitsAvailable-=a};b.readBits=function(a){var b=Math.min(this.bitsAvailable,a),c=this.word>>>32-b;32<a&&e.logger.error("Cannot read more than 32 bits at a time");this.bitsAvailable-=b;0<this.bitsAvailable?this.word<<=b:0<this.bytesAvailable&&this.loadWord();b=
a-b;return 0<b&&this.bitsAvailable?c<<b|this.readBits(b):c};b.skipLZ=function(){var a;for(a=0;a<this.bitsAvailable;++a)if(0!==(this.word&2147483648>>>a))return this.word<<=a,this.bitsAvailable-=a,a;this.loadWord();return a+this.skipLZ()};b.skipUEG=function(){this.skipBits(1+this.skipLZ())};b.skipEG=function(){this.skipBits(1+this.skipLZ())};b.readUEG=function(){var a=this.skipLZ();return this.readBits(a+1)-1};b.readEG=function(){var a=this.readUEG();return 1&a?1+a>>>1:-1*(a>>>1)};b.readBoolean=function(){return 1===
this.readBits(1)};b.readUByte=function(){return this.readBits(8)};b.readUShort=function(){return this.readBits(16)};b.readUInt=function(){return this.readBits(32)};b.skipScalingList=function(a){for(var b=8,c=8,d=0;d<a;d++)0!==c&&(c=this.readEG(),c=(b+c+256)%256),b=0===c?b:c};b.readSPS=function(){var a=0,b=0,c=0,d=0,e,f,r,h=this.readUByte.bind(this),z=this.readBits.bind(this),A=this.readUEG.bind(this),q=this.readBoolean.bind(this),u=this.skipBits.bind(this),D=this.skipEG.bind(this),m=this.skipUEG.bind(this);
e=this.skipScalingList.bind(this);h();r=h();z(5);u(3);h();m();if(100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r)if(r=A(),3===r&&u(1),m(),m(),u(1),q()){f=3!==r?8:12;for(r=0;r<f;r++)q()&&(6>r?e(16):e(64))}m();e=A();if(0===e)A();else if(1===e){u(1);D();D();e=A();for(r=0;r<e;r++)D()}m();u(1);D=A();m=A();z=z(1);0===z&&u(1);u(1);q()&&(a=A(),b=A(),c=A(),d=A());A=[1,1];if(q()&&q())switch(h()){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];
break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:A=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(D+1)-2*a-2*b),height:16*(2-z)*(m+1)-(z?2:4)*(c+d),pixelRatio:A}};b.readSliceType=function(){this.readUByte();this.readUEG();return this.readUEG()};return a}();
a["default"]=c},"./src/demux/id3.ts":function(c,a,b){b.r(a);b.d(a,"isHeader",function(){return e});b.d(a,"isFooter",function(){return d});b.d(a,"getID3Data",function(){return f});b.d(a,"canParse",function(){return n});b.d(a,"getTimeStamp",function(){return k});b.d(a,"isTimeStampFrame",function(){return t});b.d(a,"getID3Frames",function(){return l});b.d(a,"decodeFrame",function(){return w});b.d(a,"utf8ArrayToStr",function(){return h});b.d(a,"testables",function(){return z});var e=function(a,b){return b+
10<=a.length&&73===a[b]&&68===a[b+1]&&51===a[b+2]&&255>a[b+3]&&255>a[b+4]&&128>a[b+6]&&128>a[b+7]&&128>a[b+8]&&128>a[b+9]?!0:!1},d=function(a,b){return b+10<=a.length&&51===a[b]&&68===a[b+1]&&73===a[b+2]&&255>a[b+3]&&255>a[b+4]&&128>a[b+6]&&128>a[b+7]&&128>a[b+8]&&128>a[b+9]?!0:!1},f=function(a,b){for(var c=b,f=0;e(a,b);){var f=f+10,k=g(a,b+6),f=f+k;d(a,b+10)&&(f+=10);b+=f}if(0<f)return a.subarray(c,c+f)},g=function(a,b){var c=0,c=(a[b]&127)<<21,c=c|(a[b+1]&127)<<14,c=c|(a[b+2]&127)<<7;return c|=
a[b+3]&127},n=function(a,b){return e(a,b)&&g(a,b+6)+10<=a.length-b},k=function(a){a=l(a);for(var b=0;b<a.length;b++){var c=a[b];if(t(c))return 8===c.data.byteLength?(b=new Uint8Array(c.data),a=b[3]&1,b=(b[4]<<23)+(b[5]<<15)+(b[6]<<7)+b[7],b/=45,a&&(b+=4.772185884E7),a=Math.round(b)):a=void 0,a}},t=function(a){return a&&"PRIV"===a.key&&"com.apple.streaming.transportStreamTimestamp"===a.info},l=function(a){for(var b=0,c=[];e(a,b);){for(var f=g(a,b+6),b=b+10,f=b+f;b+8<f;){var k;k=a.subarray(b);var l=
String.fromCharCode(k[0],k[1],k[2],k[3]),p=g(k,4);k={type:l,size:p,data:k.subarray(10,10+p)};(l=w(k))&&c.push(l);b+=k.size+10}d(a,b)&&(b+=10)}return c},w=function(a){if("PRIV"===a.type){if(2>a.size)a=void 0;else{var b=h(a.data,!0),c=new Uint8Array(a.data.subarray(b.length+1));a={key:a.type,info:b,data:c.buffer}}return a}return"W"===a.type[0]?("WXXX"===a.type?2>a.size?a=void 0:(c=1,b=h(a.data.subarray(c),!0),c+=b.length+1,c=h(a.data.subarray(c)),a={key:a.type,info:b,data:c}):(b=h(a.data),a={key:a.type,
data:b}),a):r(a)},r=function(a){if(!(2>a.size)){if("TXXX"===a.type){var b=1,c=h(a.data.subarray(b),!0),b=b+(c.length+1),b=h(a.data.subarray(b));return{key:a.type,info:c,data:b}}c=h(a.data.subarray(1));return{key:a.type,data:c}}},h=function(a,b){void 0===b&&(b=!1);var c;!A&&"undefined"!==typeof self.TextDecoder&&(A=new self.TextDecoder("utf-8"));if(c=A){c=c.decode(a);if(b){var d=c.indexOf("\x00");return-1!==d?c.substring(0,d):c}return c.replace(/\0/g,"")}c=a.length;for(var e,f,p="",k=0;k<c;){d=a[k++];
if(0===d&&b)break;else if(0===d||3===d)continue;switch(d>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:p+=String.fromCharCode(d);break;case 12:case 13:e=a[k++];p+=String.fromCharCode((d&31)<<6|e&63);break;case 14:e=a[k++],f=a[k++],p+=String.fromCharCode((d&15)<<12|(e&63)<<6|(f&63)<<0)}}return p},z={decodeTextFrame:r},A},"./src/demux/mp3demuxer.ts":function(c,a,b){function e(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;d(a,b)}function d(a,b){d=Object.setPrototypeOf?
Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return d(a,b)}b.r(a);c=b("./src/demux/base-audio-demuxer.ts");var f=b("./src/demux/id3.ts"),g=b("./src/utils/logger.ts"),n=b("./src/demux/mpegaudio.ts");b=function(a){function b(){return a.apply(this,arguments)||this}e(b,a);var c=b.prototype;c.resetInitSegment=function(b,c,d,e){a.prototype.resetInitSegment.call(this,b,c,d,e);this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],
manifestCodec:c,duration:e,inputTimeScale:9E4,dropped:0}};b.probe=function(a){if(!a)return!1;for(var b=(f.getID3Data(a,0)||[]).length,c=a.length;b<c;b++)if(n.probe(a,b))return g.logger.log("MPEG Audio sync word found !"),!0;return!1};c.canParse=function(a,b){return n.canParse(a,b)};c.appendFrame=function(a,b,c){if(null!==this.basePTS)return n.appendFrame(a,b,c,this.basePTS,this.frameIndex)};return b}(c["default"]);a["default"]=b},"./src/demux/mp4demuxer.ts":function(c,a,b){b.r(a);var e=b("./src/polyfills/number.ts"),
d=b("./src/types/demuxer.ts"),f=b("./src/utils/mp4-tools.ts"),g=b("./src/demux/dummy-demuxed-track.ts"),n=/\/emsg[-/]ID3/i;c=function(){function a(b,c){this.remainderData=null;this.timeOffset=0;this.txtTrack=this.id3Track=this.audioTrack=this.videoTrack=this.config=void 0;this.config=c}var b=a.prototype;b.resetTimeStamp=function(){};b.resetInitSegment=function(a,b,c,d){var e=Object(f.parseInitSegment)(a);a=this.videoTrack=Object(g.dummyTrack)("video",1);b=this.audioTrack=Object(g.dummyTrack)("audio",
1);c=this.txtTrack=Object(g.dummyTrack)("text",1);this.id3Track=Object(g.dummyTrack)("id3",1);this.timeOffset=0;if(e.video){var k=e.video,n=k.timescale,u=k.codec;a.id=k.id;a.timescale=c.timescale=n;a.codec=u}e.audio&&(e=e.audio,k=e.timescale,n=e.codec,b.id=e.id,b.timescale=k,b.codec=n);c.id=f.RemuxerTrackIdConfig.text;a.sampleDuration=0;a.duration=b.duration=d};b.resetContiguity=function(){};a.probe=function(a){a=16384<a.length?a.subarray(0,16384):a;return 0<Object(f.findBox)(a,["moof"]).length};
b.demux=function(a,b){this.timeOffset=b;var c=a,d=this.videoTrack,e=this.txtTrack;this.config.progressive?(this.remainderData&&(c=Object(f.appendUint8Array)(this.remainderData,a)),c=Object(f.segmentValidRange)(c),this.remainderData=c.remainder,d.samples=c.valid||new Uint8Array):d.samples=c;c=this.extractID3Track(d,b);e.samples=Object(f.parseSamples)(b,d);return{videoTrack:d,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}};b.flush=function(){var a=this.timeOffset,b=this.videoTrack,c=
this.txtTrack;b.samples=this.remainderData||new Uint8Array;this.remainderData=null;var d=this.extractID3Track(b,this.timeOffset);c.samples=Object(f.parseSamples)(a,b);return{videoTrack:b,audioTrack:Object(g.dummyTrack)(),id3Track:d,textTrack:Object(g.dummyTrack)()}};b.extractID3Track=function(a,b){var c=this.id3Track;if(a.samples.length){var k=Object(f.findBox)(a.samples,["emsg"]);k&&k.forEach(function(a){var k=Object(f.parseEmsg)(a);n.test(k.schemeIdUri)&&(a=Object(e.isFiniteNumber)(k.presentationTime)?
k.presentationTime/k.timeScale:b+k.presentationTimeDelta/k.timeScale,k=k.payload,c.samples.push({data:k,len:k.byteLength,dts:a,pts:a,type:d.MetadataSchema.emsg}))})}return c};b.demuxSampleAes=function(a,b,c){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))};b.destroy=function(){};return a}();a["default"]=c},"./src/demux/mpegaudio.ts":function(c,a,b){function e(a,b,c,e,f){if(!(c+24>b.length)){var k=d(b,c);if(k&&c+k.frameLength<=b.length)return e+=f*(9E4*k.samplesPerFrame/
k.sampleRate),b={unit:b.subarray(c,c+k.frameLength),pts:e,dts:e},a.config=[],a.channelCount=k.channelCount,a.samplerate=k.sampleRate,a.samples.push(b),{sample:b,length:k.frameLength,missing:0}}}function d(a,b){var c=a[b+1]>>3&3,d=a[b+1]>>1&3,e=a[b+2]>>4&15,f=a[b+2]>>2&3;if(1!==c&&0!==e&&15!==e&&3!==f){var k=a[b+3]>>6,e=1E3*l[14*(3===c?3-d:3===d?3:4)+e-1],f=h[3*(3===c?0:2===c?1:2)+f],g=3===k?1:2,p=r[c][d],n=C[d],c=8*p*n,p=Math.floor(p*e/f+(a[b+2]>>1&1))*n;null===t&&(t=(n=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?
parseInt(n[1]):0);t&&87>=t&&(2===d&&224E3<=e&&0===k)&&(a[b+3]|=128);return{sampleRate:f,channelCount:g,frameLength:p,samplesPerFrame:c}}}function f(a,b){return 255===a[b]&&224===(a[b+1]&224)&&0!==(a[b+1]&6)}function g(a,b){return b+1<a.length&&f(a,b)}function n(a,b){return f(a,b)&&4<=a.length-b}function k(a,b){if(b+1<a.length&&f(a,b)){var c=d(a,b),e=4;null!==c&&(void 0!==c&&c.frameLength)&&(e=c.frameLength);c=b+e;return c===a.length||g(a,c)}return!1}b.r(a);b.d(a,"appendFrame",function(){return e});
b.d(a,"parseHeader",function(){return d});b.d(a,"isHeaderPattern",function(){return f});b.d(a,"isHeader",function(){return g});b.d(a,"canParse",function(){return n});b.d(a,"probe",function(){return k});var t=null,l=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],h=[44100,48E3,32E3,22050,24E3,16E3,11025,
12E3,8E3],r=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],C=[0,1,1,4]},"./src/demux/sample-aes.ts":function(c,a,b){b.r(a);var e=b("./src/crypt/decrypter.ts"),d=b("./src/demux/tsdemuxer.ts");c=function(){function a(b,c,d){this.decrypter=this.keyData=void 0;this.keyData=d;this.decrypter=new e["default"](b,c,{removePKCS7Padding:!1})}var b=a.prototype;b.decryptBuffer=function(a,b){this.decrypter.decrypt(a,this.keyData.key.buffer,this.keyData.iv.buffer,b)};b.decryptAacSample=function(a,b,c,d){var e=
a[b].unit;if(!(16>=e.length)){var f=e.subarray(16,e.length-e.length%16),f=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),g=this;this.decryptBuffer(f,function(f){f=new Uint8Array(f);e.set(f,16);d||g.decryptAacSamples(a,b+1,c)})}};b.decryptAacSamples=function(a,b,c){for(;;b++){if(b>=a.length){c();break}if(!(32>a[b].unit.length)){var d=this.decrypter.isSync();this.decryptAacSample(a,b,c,d);if(!d)break}}};b.getAvcEncryptedData=function(a){for(var b=new Int8Array(16*Math.floor((a.length-48)/160)+16),
c=0,d=32;d<a.length-16;d+=160,c+=16)b.set(a.subarray(d,d+16),c);return b};b.getAvcDecryptedUnit=function(a,b){for(var c=new Uint8Array(b),d=0,e=32;e<a.length-16;e+=160,d+=16)a.set(c.subarray(d,d+16),e);return a};b.decryptAvcSample=function(a,b,c,e,f,g){var h=Object(d.discardEPB)(f.data),z=this.getAvcEncryptedData(h),A=this;this.decryptBuffer(z.buffer,function(d){f.data=A.getAvcDecryptedUnit(h,d);g||A.decryptAvcSamples(a,b,c+1,e)})};b.decryptAvcSamples=function(a,b,c,d){if(a instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");
for(;;b++,c=0){if(b>=a.length){d();break}for(var e=a[b].units;!(c>=e.length);c++){var f=e[c];if(!(48>=f.data.length||1!==f.type&&5!==f.type)){var g=this.decrypter.isSync();this.decryptAvcSample(a,b,c,d,f,g);if(!g)return}}}};return a}();a["default"]=c},"./src/demux/transmuxer-interface.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return l});var e=b("./node_modules/webworkify-webpack/index.js");b.n(e);var d=b("./src/events.ts"),f=b("./src/demux/transmuxer.ts"),g=b("./src/utils/logger.ts"),
n=b("./src/errors.ts");c=b("./src/utils/mediasource-helper.ts");var k=b("./node_modules/eventemitter3/index.js");b.n(k);var h=Object(c.getMediaSource)()||{isTypeSupported:function(){return!1}},l=function(){function a(b,c,l,r){var u=this;this.observer=this.id=this.hls=void 0;this.part=this.frag=null;this.onwmsg=this.worker=void 0;this.transmuxer=null;this.onFlush=this.onTransmuxComplete=void 0;this.hls=b;this.id=c;this.onTransmuxComplete=l;this.onFlush=r;l=b.config;r=function(a,c){c=c||{};c.frag=u.frag;
c.id=u.id;b.trigger(a,c)};this.observer=new k.EventEmitter;this.observer.on(d.Events.FRAG_DECRYPTED,r);this.observer.on(d.Events.ERROR,r);r={mp4:h.isTypeSupported("video/mp4"),mpeg:h.isTypeSupported("audio/mpeg"),mp3:h.isTypeSupported('audio/mp4; codecs="mp3"')};var w=navigator.vendor;if(l.enableWorker&&"undefined"!==typeof Worker){g.logger.log("demuxing in webworker");var m;try{m=this.worker=e("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",
this.onwmsg),m.onerror=function(a){b.trigger(d.Events.ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:Error(a.message+"  ("+a.filename+":"+a.lineno+")")})},m.postMessage({cmd:"init",typeSupported:r,vendor:w,id:c,config:JSON.stringify(l)})}catch(y){g.logger.warn("Error in worker:",y),g.logger.error("Error while initializing DemuxerWorker, fallback to inline"),m&&self.URL.revokeObjectURL(m.objectURL),this.transmuxer=new f["default"](this.observer,
r,l,w,c),this.worker=null}}else this.transmuxer=new f["default"](this.observer,r,l,w,c)}var b=a.prototype;b.destroy=function(){var a=this.worker;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.worker=null,this.onwmsg=void 0;else if(a=this.transmuxer)a.destroy(),this.transmuxer=null;(a=this.observer)&&a.removeAllListeners();this.hls=this.observer=this.frag=null};b.push=function(a,b,c,d,e,k,m,l,n,p){var x,h,t=this;n.transmuxing.start=self.performance.now();var r=this.transmuxer,
w=this.worker,V=k?k.start:e.start,va=e.decryptdata,U=this.frag,ra=!(U&&e.cc===U.cc),X=!(U&&n.level===U.level),P=U?n.sn-U.sn:-1,W=this.part?n.part-this.part.index:-1,N=0===P&&1<n.id&&n.id===(null===U||void 0===U?void 0:U.stats.chunkCount),N=!X&&(1===P||0===P&&(1===W||N&&0>=W)),E=self.performance.now();if(X||P||0===e.stats.parsing.start)e.stats.parsing.start=E;if(k&&(W||!N))k.stats.parsing.start=E;U=!(U&&(null===(x=e.initSegment)||void 0===x?void 0:x.url)===(null===(h=U.initSegment)||void 0===h?void 0:
h.url));x=new f.TransmuxState(ra,N,l,X,V,U);if(!N||ra||U)g.logger.log("[transmuxer-interface, "+e.type+"]: Starting new transmux session for sn: "+n.sn+" p: "+n.part+" level: "+n.level+" id: "+n.id+"\n        discontinuity: "+ra+"\n        trackSwitch: "+X+"\n        contiguous: "+N+"\n        accurateTimeOffset: "+l+"\n        timeOffset: "+V+"\n        initSegmentChange: "+U),b=new f.TransmuxConfig(c,d,b,m,p),this.configureTransmuxer(b);this.frag=e;this.part=k;w?w.postMessage({cmd:"demux",data:a,
decryptdata:va,chunkMeta:n,state:x},a instanceof ArrayBuffer?[a]:[]):r&&(a=r.push(a,va,n,x),Object(f.isPromise)(a)?a.then(function(a){t.handleTransmuxComplete(a)}):this.handleTransmuxComplete(a))};b.flush=function(a){var b=this;a.transmuxing.start=self.performance.now();var c=this.transmuxer,d=this.worker;d?d.postMessage({cmd:"flush",chunkMeta:a}):c&&(c=c.flush(a),Object(f.isPromise)(c)?c.then(function(c){b.handleFlushResult(c,a)}):this.handleFlushResult(c,a))};b.handleFlushResult=function(a,b){var c=
this;a.forEach(function(a){c.handleTransmuxComplete(a)});this.onFlush(b)};b.onWorkerMessage=function(a){a=a.data;var b=this.hls;switch(a.event){case "init":self.URL.revokeObjectURL(this.worker.objectURL);break;case "transmuxComplete":this.handleTransmuxComplete(a.data);break;case "flush":this.onFlush(a.data);break;case "workerLog":if(g.logger[a.data.logType])g.logger[a.data.logType](a.data.message);break;default:a.data=a.data||{},a.data.frag=this.frag,a.data.id=this.id,b.trigger(a.event,a.data)}};
b.configureTransmuxer=function(a){var b=this.worker,c=this.transmuxer;b?b.postMessage({cmd:"configure",config:a}):c&&c.configure(a)};b.handleTransmuxComplete=function(a){a.chunkMeta.transmuxing.end=self.performance.now();this.onTransmuxComplete(a)};return a}()},"./src/demux/transmuxer-worker.ts":function(c,a,b){function e(a){var b=new l.EventEmitter,c=function(b,c){a.postMessage({event:b,data:c})};b.on(k.Events.FRAG_DECRYPTED,c);b.on(k.Events.ERROR,c);var e=function(){var a=function(a){h.logger[a]=
function(b){c("workerLog",{logType:a,message:b})}},b;for(b in h.logger)a(b)};a.addEventListener("message",function(f){f=f.data;switch(f.cmd){case "init":var k=JSON.parse(f.config);a.transmuxer=new n["default"](b,f.typeSupported,k,f.vendor,f.id);Object(h.enableLogs)(k.debug);e();c("init",null);break;case "configure":a.transmuxer.configure(f.config);break;case "demux":f=a.transmuxer.push(f.data,f.decryptdata,f.chunkMeta,f.state);Object(n.isPromise)(f)?f.then(function(b){d(a,b)}):d(a,f);break;case "flush":var l=
f.chunkMeta;f=a.transmuxer.flush(l);Object(n.isPromise)(f)?f.then(function(b){g(a,b,l)}):g(a,f,l)}})}function d(a,b){if(!b.remuxResult.audio&&!b.remuxResult.video&&!b.remuxResult.text&&!b.remuxResult.id3&&!b.remuxResult.initSegment)return!1;var c=[],d=b.remuxResult,e=d.audio,d=d.video;e&&f(c,e);d&&f(c,d);a.postMessage({event:"transmuxComplete",data:b},c);return!0}function f(a,b){b.data1&&a.push(b.data1.buffer);b.data2&&a.push(b.data2.buffer)}function g(a,b,c){b.reduce(function(b,c){return d(a,c)||
b},!1)||a.postMessage({event:"transmuxComplete",data:b[0]});a.postMessage({event:"flush",data:c})}b.r(a);b.d(a,"default",function(){return e});var n=b("./src/demux/transmuxer.ts"),k=b("./src/events.ts"),h=b("./src/utils/logger.ts"),l=b("./node_modules/eventemitter3/index.js");b.n(l)},"./src/demux/transmuxer.ts":function(c,a,b){function e(a,b){var c=null;0<a.byteLength&&(null!=b&&null!=b.key&&null!==b.iv&&null!=b.method)&&(c=b);return c}function d(a){return"then"in a&&a.then instanceof Function}b.r(a);
b.d(a,"default",function(){return q});b.d(a,"isPromise",function(){return d});b.d(a,"TransmuxConfig",function(){return u});b.d(a,"TransmuxState",function(){return D});var f=b("./src/events.ts"),g=b("./src/errors.ts"),n=b("./src/crypt/decrypter.ts");c=b("./src/demux/aacdemuxer.ts");var k=b("./src/demux/mp4demuxer.ts");a=b("./src/demux/tsdemuxer.ts");var h=b("./src/demux/mp3demuxer.ts"),l=b("./src/remux/mp4-remuxer.ts"),w=b("./src/remux/passthrough-remuxer.ts"),r=b("./src/utils/logger.ts"),C;try{C=
self.performance.now.bind(self.performance)}catch(z){r.logger.debug("Unable to use Performance API on this environment"),C=self.Date.now}var A=[{demux:a["default"],remux:l["default"]},{demux:k["default"],remux:w["default"]},{demux:c["default"],remux:l["default"]},{demux:h["default"],remux:l["default"]}],q=function(){function a(b,c,d,e,f){this.probe=this.decrypter=this.remuxer=this.demuxer=this.id=this.vendor=this.config=this.typeSupported=this.observer=void 0;this.decryptionPromise=null;this.currentTransmuxState=
this.transmuxConfig=void 0;this.observer=b;this.typeSupported=c;this.config=d;this.vendor=e;this.id=f}var b=a.prototype;b.configure=function(a){this.transmuxConfig=a;this.decrypter&&this.decrypter.reset()};b.push=function(a,b,c,d){var f=this,k=c.transmuxing;k.executeStart=C();var g=new Uint8Array(a),m=this.config,n=this.currentTransmuxState;a=this.transmuxConfig;d&&(this.currentTransmuxState=d);var l=d||n,y=l.contiguous;d=l.discontinuity;var n=l.trackSwitch,h=l.accurateTimeOffset,u=l.timeOffset,l=
l.initSegmentChange,t=a.audioCodec,r=a.videoCodec,q=a.defaultInitPts,w=a.duration,D=a.initSegmentData;(d||n||l)&&this.resetInitSegment(D,t,r,w);(d||l)&&this.resetInitialTimestamp(q);y||this.resetContiguity();if((b=e(g,b))&&"AES-128"===b.method)if(y=this.getDecrypter(),m.enableSoftwareAES){g=y.softwareDecrypt(g,b.key.buffer,b.iv.buffer);if(!g)return k.executeEnd=C(),{remuxResult:{},chunkMeta:c};g=new Uint8Array(g)}else return this.decryptionPromise=y.webCryptoDecrypt(g,b.key.buffer,b.iv.buffer).then(function(a){a=
f.push(a,null,c);f.decryptionPromise=null;return a});this.needsProbing(g,d,n)&&this.configureTransmuxer(g,a);a=this.transmux(g,b,u,h,c);g=this.currentTransmuxState;g.contiguous=!0;g.discontinuity=!1;g.trackSwitch=!1;k.executeEnd=C();return a};b.flush=function(a){var b=this,c=a.transmuxing;c.executeStart=C();var e=this.decrypter,k=this.currentTransmuxState,m=this.decryptionPromise;if(m)return m.then(function(){return b.flush(a)});var l=[],k=k.timeOffset;e&&(e=e.flush())&&l.push(this.push(e,null,a));
e=this.demuxer;m=this.remuxer;if(!e||!m)return this.observer.emit(f.Events.ERROR,f.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),c.executeEnd=C(),[{remuxResult:{},chunkMeta:a}];c=e.flush(k);if(d(c))return c.then(function(c){b.flushRemux(l,c,a);return l});this.flushRemux(l,c,a);return l};b.flushRemux=function(a,b,c){var d=b.audioTrack,e=b.videoTrack,f=b.id3Track;b=b.textTrack;var k=this.currentTransmuxState,
g=k.accurateTimeOffset,k=k.timeOffset;r.logger.log("[transmuxer.ts]: Flushed fragment "+c.sn+(-1<c.part?" p: "+c.part:"")+" of level "+c.level);d=this.remuxer.remux(d,e,f,b,k,g,!0,this.id);a.push({remuxResult:d,chunkMeta:c});c.transmuxing.executeEnd=C()};b.resetInitialTimestamp=function(a){var b=this.demuxer,c=this.remuxer;b&&c&&(b.resetTimeStamp(a),c.resetTimeStamp(a))};b.resetContiguity=function(){var a=this.demuxer,b=this.remuxer;a&&b&&(a.resetContiguity(),b.resetNextTimestamp())};b.resetInitSegment=
function(a,b,c,d){var e=this.demuxer,f=this.remuxer;e&&f&&(e.resetInitSegment(a,b,c,d),f.resetInitSegment(a,b,c))};b.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0);this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)};b.transmux=function(a,b,c,d,e){return b&&"SAMPLE-AES"===b.method?this.transmuxSampleAes(a,b,c,d,e):this.transmuxUnencrypted(a,c,d,e)};b.transmuxUnencrypted=function(a,b,c,d){a=this.demuxer.demux(a,b,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a.audioTrack,
a.videoTrack,a.id3Track,a.textTrack,b,c,!1,this.id),chunkMeta:d}};b.transmuxSampleAes=function(a,b,c,d,e){var f=this;return this.demuxer.demuxSampleAes(a,b,c).then(function(a){return{remuxResult:f.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,c,d,!1,f.id),chunkMeta:e}})};b.configureTransmuxer=function(a,b){for(var c=this.config,d=this.observer,e=this.typeSupported,f=this.vendor,g=b.audioCodec,m=b.defaultInitPts,l=b.duration,n=b.initSegmentData,y=b.videoCodec,h,u=0,t=A.length;u<t;u++)if(A[u].demux.probe(a)){h=
A[u];break}h||(r.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),h={demux:k["default"],remux:w["default"]});var u=this.demuxer,t=this.remuxer,q=h.remux;h=h.demux;if(!t||!(t instanceof q))this.remuxer=new q(d,c,e,f);if(!u||!(u instanceof h))this.demuxer=new h(d,c,e),this.probe=h.probe;this.resetInitSegment(n,g,y,l);this.resetInitialTimestamp(m)};b.needsProbing=function(a,b,c){return!this.demuxer||!this.remuxer||b||c};b.getDecrypter=function(){var a=this.decrypter;
a||(a=this.decrypter=new n["default"](this.observer,this.config));return a};return a}(),u=function(a,b,c,d,e){this.defaultInitPts=this.duration=this.initSegmentData=this.videoCodec=this.audioCodec=void 0;this.audioCodec=a;this.videoCodec=b;this.initSegmentData=c;this.duration=d;this.defaultInitPts=e},D=function(a,b,c,d,e,f){this.initSegmentChange=this.timeOffset=this.trackSwitch=this.accurateTimeOffset=this.contiguous=this.discontinuity=void 0;this.discontinuity=a;this.contiguous=b;this.accurateTimeOffset=
c;this.trackSwitch=d;this.timeOffset=e;this.initSegmentChange=f}},"./src/demux/tsdemuxer.ts":function(c,a,b){function e(){e=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}function d(a,b,c,d){return{key:a,frame:!1,pts:b,dts:c,units:[],debug:d,length:0}}function f(a){var b=0,c,d,e,f,k,g=a.data;if(!a||0===a.size)return null;for(;19>g[0].length&&
1<g.length;)c=new Uint8Array(g[0].length+g[1].length),c.set(g[0]),c.set(g[1],g[0].length),g[0]=c,g.splice(1,1);c=g[0];if(1===(c[0]<<16)+(c[1]<<8)+c[2]){if((d=(c[4]<<8)+c[5])&&d>a.size-6)return null;e=c[7];e&192&&(f=536870912*(c[9]&14)+4194304*(c[10]&255)+16384*(c[11]&254)+128*(c[12]&255)+(c[13]&254)/2,e&64?(k=536870912*(c[14]&14)+4194304*(c[15]&255)+16384*(c[16]&254)+128*(c[17]&255)+(c[18]&254)/2,54E5<f-k&&(z.logger.warn(Math.round((f-k)/9E4)+"s delta between PTS and DTS, align them"),f=k)):k=f);
e=c[8];var l=e+9;if(a.size<=l)return null;a.size-=l;a=new Uint8Array(a.size);for(var n=0,h=g.length;n<h;n++){c=g[n];var t=c.byteLength;if(l)if(l>t){l-=t;continue}else c=c.subarray(l),t-=l,l=0;a.set(c,b);b+=t}d&&(d-=e+3);return{data:a,pts:f,dts:k,len:d}}return null}function g(a,b){if(a.units.length&&a.frame){if(void 0===a.pts){var c=b.samples,d=c.length;if(d)c=c[d-1],a.pts=c.pts,a.dts=c.dts;else{b.dropped++;return}}b.samples.push(a)}a.debug.length&&z.logger.log(a.pts+"/"+a.dts+":"+a.debug)}function n(a){for(var b=
a.byteLength,c=[],d=1;d<b-2;)0===a[d]&&0===a[d+1]&&3===a[d+2]?(c.push(d+2),d+=2):d++;if(0===c.length)return a;for(var b=b-c.length,e=new Uint8Array(b),f=0,d=0;d<b;f++,d++)f===c[0]&&(f++,c.shift()),e[d]=a[f];return e}b.r(a);b.d(a,"discardEPB",function(){return n});var k=b("./src/demux/adts.ts"),h=b("./src/demux/mpegaudio.ts"),l=b("./src/demux/exp-golomb.ts"),w=b("./src/demux/sample-aes.ts"),r=b("./src/events.ts"),C=b("./src/utils/mp4-tools.ts"),z=b("./src/utils/logger.ts"),A=b("./src/errors.ts"),q=
b("./src/types/demuxer.ts");c=function(){function a(b,c,d){this.typeSupported=this.config=this.observer=void 0;this.sampleAes=null;this.pmtParsed=!1;this.videoCodec=this.audioCodec=void 0;this._duration=0;this._pmtId=-1;this._txtTrack=this._id3Track=this._audioTrack=this._avcTrack=void 0;this.remainderData=this.avcSample=this.aacOverFlow=null;this.observer=b;this.config=c;this.typeSupported=d}a.probe=function(a){return 71===a[0]&&71===a[188]};a.createTrack=function(a,b){return{container:"video"===
a||"audio"===a?"video/mp2t":void 0,type:a,id:C.RemuxerTrackIdConfig[a],pid:-1,inputTimeScale:9E4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===a?b:void 0}};var b=a.prototype;b.resetInitSegment=function(b,c,d,e){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=a.createTrack("video");this._audioTrack=a.createTrack("audio",e);this._id3Track=a.createTrack("id3");this._txtTrack=a.createTrack("text");this._audioTrack.segmentCodec="aac";this.remainderData=this.avcSample=this.aacOverFlow=null;this.audioCodec=
c;this.videoCodec=d;this._duration=e};b.resetTimeStamp=function(){};b.resetContiguity=function(){var a=this._audioTrack,b=this._avcTrack,c=this._id3Track;a&&(a.pesData=null);b&&(b.pesData=null);c&&(c.pesData=null);this.aacOverFlow=null};b.demux=function(a,b,c,d){void 0===c&&(c=!1);void 0===d&&(d=!1);c||(this.sampleAes=null);var e;b=this._avcTrack;var k=this._audioTrack,g=this._id3Track,l=this._txtTrack,n=b.pid,h=b.pesData,t=k.pid,u=g.pid,q=k.pesData,w=g.pesData,D=null,W=this.pmtParsed,N=this._pmtId,
E=a.length;this.remainderData&&(a=Object(C.appendUint8Array)(this.remainderData,a),E=a.length,this.remainderData=null);if(188>E&&!d)return this.remainderData=a,{audioTrack:k,videoTrack:b,id3Track:g,textTrack:l};E-=E%188;E<a.byteLength&&!d&&(this.remainderData=new Uint8Array(a.buffer,E,a.buffer.byteLength-E));for(var H=0,K=0;K<E;K+=188)if(71===a[K]){var Q=!!(a[K+1]&64),F=((a[K+1]&31)<<8)+a[K+2],I=void 0;if(1<(a[K+3]&48)>>4){if(I=K+5+a[K+4],I===K+188)continue}else I=K+4;switch(F){case n:Q&&(h&&(e=f(h))&&
this.parseAVCPES(b,l,e,!1),h={data:[],size:0});h&&(h.data.push(a.subarray(I,K+188)),h.size+=K+188-I);break;case t:if(Q){if(q&&(e=f(q)))switch(k.segmentCodec){case "aac":this.parseAACPES(k,e);break;case "mp3":this.parseMPEGPES(k,e)}q={data:[],size:0}}q&&(q.data.push(a.subarray(I,K+188)),q.size+=K+188-I);break;case u:Q&&(w&&(e=f(w))&&this.parseID3PES(g,e),w={data:[],size:0});w&&(w.data.push(a.subarray(I,K+188)),w.size+=K+188-I);break;case 0:Q&&(I+=a[I]+1);N=this._pmtId=(a[I+10]&31)<<8|a[I+11];break;
case N:Q&&(I+=a[I]+1);n=a;t=I;I=this.typeSupported;u=c;Q={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"};F=t+3+((n[t+1]&15)<<8|n[t+2])-4;for(t+=12+((n[t+10]&15)<<8|n[t+11]);t<F;){var B=(n[t+1]&31)<<8|n[t+2];switch(n[t]){case 207:if(!u){z.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===Q.audio&&(Q.audio=B);break;case 21:-1===Q.id3&&(Q.id3=B);break;case 219:if(!u){z.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");
break}case 27:-1===Q.avc&&(Q.avc=B);break;case 3:case 4:!0!==I.mpeg&&!0!==I.mp3?z.logger.log("MPEG audio found, not supported in this browser"):-1===Q.audio&&(Q.audio=B,Q.segmentCodec="mp3");break;case 36:z.logger.warn("Unsupported HEVC stream type found")}t+=((n[t+3]&15)<<8|n[t+4])+5}I=Q;n=I.avc;0<n&&(b.pid=n);t=I.audio;0<t&&(k.pid=t,k.segmentCodec=I.segmentCodec);u=I.id3;0<u&&(g.pid=u);null!==D&&!W&&(z.logger.log("unknown PID '"+D+"' in TS found"),D=null);W=this.pmtParsed=!0;break;case 17:case 8191:break;
default:D=F}}else H++;0<H&&this.observer.emit(r.Events.ERROR,r.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+H+" TS packet/s that do not start with 0x47"});b.pesData=h;k.pesData=q;g.pesData=w;a={audioTrack:k,videoTrack:b,id3Track:g,textTrack:l};d&&this.extractRemainingSamples(a);return a};b.flush=function(){var a=this.remainderData;this.remainderData=null;a=a?this.demux(a,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,
id3Track:this._id3Track,textTrack:this._txtTrack};this.extractRemainingSamples(a);return this.sampleAes?this.decrypt(a,this.sampleAes):a};b.extractRemainingSamples=function(a){var b=a.audioTrack,c=a.videoTrack,d=a.id3Track;a=a.textTrack;var e=c.pesData,k=b.pesData,g=d.pesData,l;e&&(l=f(e))?(this.parseAVCPES(c,a,l,!0),c.pesData=null):c.pesData=e;if(k&&(l=f(k))){switch(b.segmentCodec){case "aac":this.parseAACPES(b,l);break;case "mp3":this.parseMPEGPES(b,l)}b.pesData=null}else null!==k&&(void 0!==k&&
k.size)&&z.logger.log("last AAC PES packet truncated,might overlap between fragments"),b.pesData=k;g&&(l=f(g))?(this.parseID3PES(d,l),d.pesData=null):d.pesData=g};b.demuxSampleAes=function(a,b,c){a=this.demux(a,c,!0,!this.config.progressive);b=this.sampleAes=new w["default"](this.observer,this.config,b);return this.decrypt(a,b)};b.decrypt=function(a,b){return new Promise(function(c){var d=a.audioTrack,e=a.videoTrack;d.samples&&"aac"===d.segmentCodec?b.decryptAacSamples(d.samples,0,function(){e.samples?
b.decryptAvcSamples(e.samples,0,0,function(){c(a)}):c(a)}):e.samples&&b.decryptAvcSamples(e.samples,0,0,function(){c(a)})})};b.destroy=function(){this._duration=0};b.parseAVCPES=function(a,b,c,e){var f=this,k=this.parseAVCNALu(a,c.data),h=this.avcSample,t,u=!1;c.data=null;h&&(k.length&&!a.audFound)&&(g(h,a),h=this.avcSample=d(!1,c.pts,c.dts,""));k.forEach(function(e){switch(e.type){case 1:t=!0;h||(h=f.avcSample=d(!0,c.pts,c.dts,""));h.frame=!0;var k=e.data;if(u&&4<k.length&&(k=(new l["default"](k)).readSliceType(),
2===k||4===k||7===k||9===k))h.key=!0;break;case 5:t=!0;h||(h=f.avcSample=d(!0,c.pts,c.dts,""));h.key=!0;h.frame=!0;break;case 6:t=!0;Object(C.parseSEIMessageFromNALu)(n(e.data),c.pts,b.samples);break;case 7:u=t=!0;if(!a.sps){k=(new l["default"](e.data)).readSPS();a.width=k.width;a.height=k.height;a.pixelRatio=k.pixelRatio;a.sps=[e.data];a.duration=f._duration;for(var k=e.data.subarray(1,4),p="avc1.",r=0;3>r;r++){var q=k[r].toString(16);2>q.length&&(q="0"+q);p+=q}a.codec=p}break;case 8:t=!0;a.pps||
(a.pps=[e.data]);break;case 9:t=!1;a.audFound=!0;h&&g(h,a);h=f.avcSample=d(!1,c.pts,c.dts,"");break;case 12:t=!0;break;default:t=!1,h&&(h.debug+="unknown NAL "+e.type+" ")}h&&t&&h.units.push(e)});e&&h&&(g(h,a),this.avcSample=null)};b.getLastNalUnit=function(a){var b,c=this.avcSample,d;if(!c||0===c.units.length)c=a[a.length-1];if(null!==(b=c)&&void 0!==b&&b.units)a=c.units,d=a[a.length-1];return d};b.parseAVCNALu=function(a,b){var c=b.byteLength,d=a.naluState||0,e=d,f=[],k=0,g,l=-1,n=0;-1===d&&(l=
0,n=b[0]&31,d=0,k=1);for(;k<c;)if(g=b[k++],d)if(1===d)d=g?0:2;else if(g)if(1===g){if(0<=l)d={data:b.subarray(l,k-d-1),type:n},f.push(d);else if(g=this.getLastNalUnit(a.samples))if(e&&k<=4-e&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-e)),d=k-d-1,0<d){var h=new Uint8Array(g.data.byteLength+d);h.set(g.data,0);h.set(b.subarray(0,d),g.data.byteLength);g.data=h;g.state=0}k<c?(d=b[k]&31,l=k,n=d,d=0):d=-1}else d=0;else d=3;else d=g?0:1;0<=l&&0<=d&&(c={data:b.subarray(l,c),type:n,state:d},f.push(c));
if(0===f.length&&(c=this.getLastNalUnit(a.samples)))e=new Uint8Array(c.data.byteLength+b.byteLength),e.set(c.data,0),e.set(b,c.data.byteLength),c.data=e;a.naluState=d;return f};b.parseAACPES=function(a,b){var c=0,d=this.aacOverFlow,e=b.data;if(d){this.aacOverFlow=null;var f=d.missing,g=d.sample.unit.byteLength;-1===f?(f=new Uint8Array(g+e.byteLength),f.set(d.sample.unit,0),f.set(e,g),e=f):(d.sample.unit.set(e.subarray(0,f),g-f),a.samples.push(d.sample),c=d.missing)}g=c;for(f=e.length;g<f-1&&!k.isHeader(e,
g);g++);if(g!==c){var l;g<f-1?(c="AAC PES did not start with ADTS header,offset:"+g,l=!1):(c="no ADTS header found in AAC PES",l=!0);z.logger.warn("parsing error:"+c);this.observer.emit(r.Events.ERROR,r.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,fatal:l,reason:c});if(l)return}k.initTrackConfig(a,this.observer,e,g,this.audioCodec);if(void 0!==b.pts)d=b.pts;else if(d)c=k.getFrameDuration(a.samplerate),d=d.sample.pts+c;else{z.logger.warn("[tsdemuxer]: AAC PES unknown PTS");
return}for(c=0;g<f;)if(l=k.appendFrame(a,e,g,d,c),g+=l.length,l.missing){this.aacOverFlow=l;break}else for(c++;g<f-1&&!k.isHeader(e,g);g++);};b.parseMPEGPES=function(a,b){var c=b.data,d=c.length,e=0,f=0,k=b.pts;if(void 0===k)z.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");else for(;f<d;)if(h.isHeader(c,f)){var g=h.appendFrame(a,c,f,k,e);if(g)f+=g.length,e++;else break}else f++};b.parseID3PES=function(a,b){if(void 0===b.pts)z.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");else{var c=e({},b,{type:this._avcTrack?
q.MetadataSchema.emsg:q.MetadataSchema.audioId3});a.samples.push(c)}};return a}();a["default"]=c},"./src/empty.js":function(c,a){c.exports=void 0},"./src/errors.ts":function(c,a,b){b.r(a);b.d(a,"ErrorTypes",function(){return e});b.d(a,"ErrorDetails",function(){return d});var e;(function(a){a.NETWORK_ERROR="networkError";a.MEDIA_ERROR="mediaError";a.KEY_SYSTEM_ERROR="keySystemError";a.MUX_ERROR="muxError";a.OTHER_ERROR="otherError"})(e||(e={}));var d;(function(a){a.KEY_SYSTEM_NO_KEYS="keySystemNoKeys";
a.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess";a.KEY_SYSTEM_NO_SESSION="keySystemNoSession";a.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed";a.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData";a.MANIFEST_LOAD_ERROR="manifestLoadError";a.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut";a.MANIFEST_PARSING_ERROR="manifestParsingError";a.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError";a.LEVEL_EMPTY_ERROR="levelEmptyError";a.LEVEL_LOAD_ERROR="levelLoadError";a.LEVEL_LOAD_TIMEOUT=
"levelLoadTimeOut";a.LEVEL_SWITCH_ERROR="levelSwitchError";a.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError";a.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut";a.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError";a.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut";a.FRAG_LOAD_ERROR="fragLoadError";a.FRAG_LOAD_TIMEOUT="fragLoadTimeOut";a.FRAG_DECRYPT_ERROR="fragDecryptError";a.FRAG_PARSING_ERROR="fragParsingError";a.REMUX_ALLOC_ERROR="remuxAllocError";a.KEY_LOAD_ERROR="keyLoadError";a.KEY_LOAD_TIMEOUT=
"keyLoadTimeOut";a.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError";a.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError";a.BUFFER_APPEND_ERROR="bufferAppendError";a.BUFFER_APPENDING_ERROR="bufferAppendingError";a.BUFFER_STALLED_ERROR="bufferStalledError";a.BUFFER_FULL_ERROR="bufferFullError";a.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole";a.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall";a.INTERNAL_EXCEPTION="internalException";a.INTERNAL_ABORTED="aborted";a.UNKNOWN="unknown"})(d||(d={}))},"./src/events.ts":function(c,
a,b){b.r(a);b.d(a,"Events",function(){return e});var e;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching";a.MEDIA_ATTACHED="hlsMediaAttached";a.MEDIA_DETACHING="hlsMediaDetaching";a.MEDIA_DETACHED="hlsMediaDetached";a.BUFFER_RESET="hlsBufferReset";a.BUFFER_CODECS="hlsBufferCodecs";a.BUFFER_CREATED="hlsBufferCreated";a.BUFFER_APPENDING="hlsBufferAppending";a.BUFFER_APPENDED="hlsBufferAppended";a.BUFFER_EOS="hlsBufferEos";a.BUFFER_FLUSHING="hlsBufferFlushing";a.BUFFER_FLUSHED="hlsBufferFlushed";a.MANIFEST_LOADING=
"hlsManifestLoading";a.MANIFEST_LOADED="hlsManifestLoaded";a.MANIFEST_PARSED="hlsManifestParsed";a.LEVEL_SWITCHING="hlsLevelSwitching";a.LEVEL_SWITCHED="hlsLevelSwitched";a.LEVEL_LOADING="hlsLevelLoading";a.LEVEL_LOADED="hlsLevelLoaded";a.LEVEL_UPDATED="hlsLevelUpdated";a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated";a.LEVELS_UPDATED="hlsLevelsUpdated";a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated";a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching";a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched";a.AUDIO_TRACK_LOADING=
"hlsAudioTrackLoading";a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded";a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated";a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared";a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch";a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading";a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded";a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed";a.CUES_PARSED="hlsCuesParsed";a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound";a.INIT_PTS_FOUND="hlsInitPtsFound";a.FRAG_LOADING=
"hlsFragLoading";a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted";a.FRAG_LOADED="hlsFragLoaded";a.FRAG_DECRYPTED="hlsFragDecrypted";a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment";a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata";a.FRAG_PARSING_METADATA="hlsFragParsingMetadata";a.FRAG_PARSED="hlsFragParsed";a.FRAG_BUFFERED="hlsFragBuffered";a.FRAG_CHANGED="hlsFragChanged";a.FPS_DROP="hlsFpsDrop";a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping";a.ERROR="hlsError";a.DESTROYING="hlsDestroying";
a.KEY_LOADING="hlsKeyLoading";a.KEY_LOADED="hlsKeyLoaded";a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached";a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(e||(e={}))},"./src/hls.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);b.d(a,"default",function(){return m});
var f=b("./node_modules/url-toolkit/src/url-toolkit.js");b.n(f);var g=b("./src/loader/playlist-loader.ts"),n=b("./src/loader/key-loader.ts"),k=b("./src/controller/id3-track-controller.ts"),h=b("./src/controller/latency-controller.ts"),l=b("./src/controller/level-controller.ts"),w=b("./src/controller/fragment-tracker.ts"),r=b("./src/controller/stream-controller.ts"),C=b("./src/is-supported.ts"),z=b("./src/utils/logger.ts"),A=b("./src/config.ts"),q=b("./node_modules/eventemitter3/index.js");b.n(q);
var u=b("./src/events.ts"),D=b("./src/errors.ts"),m=function(){function a(b){void 0===b&&(b={});this.networkControllers=this.coreComponents=this.userConfig=this.config=void 0;this._emitter=new q.EventEmitter;this.cmcdController=this.emeController=this.subtitleTrackController=this.audioTrackController=this.streamController=this.levelController=this.latencyController=this.capLevelController=this.bufferController=this.abrController=this._autoLevelCapping=void 0;this.url=this._media=null;var c=this.config=
Object(A.mergeConfig)(a.DefaultConfig,b);this.userConfig=b;Object(z.enableLogs)(c.debug);this._autoLevelCapping=-1;c.progressive&&Object(A.enableStreamingMode)(c);var d=c.bufferController,e=c.capLevelController,f=c.fpsController;b=this.abrController=new c.abrController(this);var d=this.bufferController=new d(this),e=this.capLevelController=new e(this),m=new f(this),u=new g["default"](this),D=new n["default"](this),v=new k["default"](this),C=this.levelController=new l["default"](this),f=new w.FragmentTracker(this),
X=this.streamController=new r["default"](this,f);e.setStreamController(X);m.setStreamController(X);this.networkControllers=u=[u,D,C,X];b=[b,d,e,m,v,f];this.audioTrackController=this.createController(c.audioTrackController,null,u);this.createController(c.audioStreamController,f,u);this.subtitleTrackController=this.createController(c.subtitleTrackController,null,u);this.createController(c.subtitleStreamController,f,u);this.createController(c.timelineController,null,b);this.emeController=this.createController(c.emeController,
null,b);this.cmcdController=this.createController(c.cmcdController,null,b);this.latencyController=this.createController(h["default"],null,b);this.coreComponents=b}a.isSupported=function(){return Object(C.isSupported)()};var b=a.prototype;b.createController=function(a,b,c){return a?(a=b?new a(this,b):new a(this),c&&c.push(a),a):null};b.on=function(a,b,c){void 0===c&&(c=this);this._emitter.on(a,b,c)};b.once=function(a,b,c){void 0===c&&(c=this);this._emitter.once(a,b,c)};b.removeAllListeners=function(a){this._emitter.removeAllListeners(a)};
b.off=function(a,b,c,d){void 0===c&&(c=this);this._emitter.off(a,b,c,d)};b.listeners=function(a){return this._emitter.listeners(a)};b.emit=function(a,b,c){return this._emitter.emit(a,b,c)};b.trigger=function(a,b){if(this.config.debug)return this.emit(a,a,b);try{return this.emit(a,a,b)}catch(c){z.logger.error("An internal error happened while handling event "+a+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.trigger(u.Events.ERROR,{type:D.ErrorTypes.OTHER_ERROR,details:D.ErrorDetails.INTERNAL_EXCEPTION,
fatal:!1,event:a,error:c})}return!1};b.listenerCount=function(a){return this._emitter.listenerCount(a)};b.destroy=function(){z.logger.log("destroy");this.trigger(u.Events.DESTROYING,void 0);this.detachMedia();this.removeAllListeners();this._autoLevelCapping=-1;this.url=null;this.networkControllers.forEach(function(a){return a.destroy()});this.networkControllers.length=0;this.coreComponents.forEach(function(a){return a.destroy()});this.coreComponents.length=0};b.attachMedia=function(a){z.logger.log("attachMedia");
this._media=a;this.trigger(u.Events.MEDIA_ATTACHING,{media:a})};b.detachMedia=function(){z.logger.log("detachMedia");this.trigger(u.Events.MEDIA_DETACHING,void 0);this._media=null};b.loadSource=function(a){this.stopLoad();var b=this.media,c=this.url,d=this.url=f.buildAbsoluteURL(self.location.href,a,{alwaysNormalize:!0});z.logger.log("loadSource:"+d);b&&(c&&c!==d&&this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(b));this.trigger(u.Events.MANIFEST_LOADING,{url:a})};b.startLoad=
function(a){void 0===a&&(a=-1);z.logger.log("startLoad("+a+")");this.networkControllers.forEach(function(b){b.startLoad(a)})};b.stopLoad=function(){z.logger.log("stopLoad");this.networkControllers.forEach(function(a){a.stopLoad()})};b.swapAudioCodec=function(){z.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()};b.recoverMediaError=function(){z.logger.log("recoverMediaError");var a=this._media;this.detachMedia();a&&this.attachMedia(a)};b.removeLevel=function(a,b){void 0===b&&(b=
0);this.levelController.removeLevel(a,b)};d(a,[{key:"levels",get:function(){var a=this.levelController.levels;return a?a:[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(a){z.logger.log("set currentLevel:"+a);this.loadLevel=a;this.abrController.clearTimer();this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(a){z.logger.log("set nextLevel:"+a);this.levelController.manualLevel=
a;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(a){z.logger.log("set loadLevel:"+a);this.levelController.manualLevel=a}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(a){this.levelController.nextLoadLevel=a}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(a){z.logger.log("set firstLevel:"+a);this.levelController.firstLevel=
a}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(a){z.logger.log("set startLevel:"+a);-1!==a&&(a=Math.max(a,this.minAutoLevel));this.levelController.startLevel=a}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(a){a=!!a;a!==this.config.capLevelToPlayerSize&&(a?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=
a)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(a){this._autoLevelCapping!==a&&(z.logger.log("set autoLevelCapping:"+a),this._autoLevelCapping=a)}},{key:"bandwidthEstimate",get:function(){var a=this.abrController.bwEstimator;return!a?NaN:a.getEstimate()}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var a=this.levels,
b=this.config.minAutoBitrate;if(!a)return 0;for(var c=a.length,d=0;d<c;d++)if(a[d].maxBitrate>=b)return d;return 0}},{key:"maxAutoLevel",get:function(){var a=this.levels,b=this.autoLevelCapping;return-1===b&&a&&a.length?a.length-1:b}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(a){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,a)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},
{key:"audioTracks",get:function(){var a=this.audioTrackController;return a?a.audioTracks:[]}},{key:"audioTrack",get:function(){var a=this.audioTrackController;return a?a.audioTrack:-1},set:function(a){var b=this.audioTrackController;b&&(b.audioTrack=a)}},{key:"subtitleTracks",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTrack:-1},set:function(a){var b=this.subtitleTrackController;
b&&(b.subtitleTrack=a)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var a=this.subtitleTrackController;return a?a.subtitleDisplay:!1},set:function(a){var b=this.subtitleTrackController;b&&(b.subtitleDisplay=a)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(a){this.config.lowLatencyMode=a}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},
{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.3"}},{key:"Events",get:function(){return u.Events}},{key:"ErrorTypes",get:function(){return D.ErrorTypes}},{key:"ErrorDetails",get:function(){return D.ErrorDetails}},
{key:"DefaultConfig",get:function(){return!a.defaultConfig?A.hlsDefaultConfig:a.defaultConfig},set:function(b){a.defaultConfig=b}}]);return a}();m.defaultConfig=void 0},"./src/is-supported.ts":function(c,a,b){function e(){var a=Object(f.getMediaSource)();if(!a)return!1;var b=self.SourceBuffer||self.WebKitSourceBuffer,a=a&&"function"===typeof a.isTypeSupported&&a.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),b=!b||b.prototype&&"function"===typeof b.prototype.appendBuffer&&"function"===
typeof b.prototype.remove;return!!a&&!!b}function d(){var a,b=self.SourceBuffer||self.WebKitSourceBuffer;return"function"===typeof(null===b||void 0===b?void 0:null===(a=b.prototype)||void 0===a?void 0:a.changeType)}b.r(a);b.d(a,"isSupported",function(){return e});b.d(a,"changeTypeSupported",function(){return d});var f=b("./src/utils/mediasource-helper.ts")},"./src/loader/date-range.ts":function(c,a,b){function e(){e=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=
arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}function d(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function f(a,b,c){b&&d(a.prototype,b);c&&d(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);b.d(a,"DateRangeAttribute",function(){return h});b.d(a,"DateRange",function(){return l});var g=b("./src/polyfills/number.ts"),
n=b("./src/utils/attr-list.ts"),k=b("./src/utils/logger.ts"),h;(function(a){a.ID="ID";a.CLASS="CLASS";a.START_DATE="START-DATE";a.DURATION="DURATION";a.END_DATE="END-DATE";a.END_ON_NEXT="END-ON-NEXT";a.PLANNED_DURATION="PLANNED-DURATION";a.SCTE35_OUT="SCTE35-OUT";a.SCTE35_IN="SCTE35-IN"})(h||(h={}));var l=function(){function a(b,c){this._badValueForSameId=this._endDate=this._startDate=this.attr=void 0;if(c){var d=c.attr,f;for(f in d)if(Object.prototype.hasOwnProperty.call(b,f)&&b[f]!==d[f]){k.logger.warn('DATERANGE tag attribute: "'+
f+'" does not match for tags with ID: "'+b.ID+'"');this._badValueForSameId=f;break}b=e(new n.AttrList({}),d,b)}this.attr=b;this._startDate=new Date(b[h.START_DATE]);h.END_DATE in this.attr&&(d=new Date(this.attr[h.END_DATE]),Object(g.isFiniteNumber)(d.getTime())&&(this._endDate=d))}f(a,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;
var a=this.duration;return null!==a?new Date(this._startDate.getTime()+1E3*a):null}},{key:"duration",get:function(){if(h.DURATION in this.attr){var a=this.attr.decimalFloatingPoint(h.DURATION);if(Object(g.isFiniteNumber)(a))return a}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1E3;return null}},{key:"plannedDuration",get:function(){return h.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(h.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(h.END_ON_NEXT)}},
{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Object(g.isFiniteNumber)(this.startDate.getTime())&&(null===this.duration||0<=this.duration)&&(!this.endOnNext||!!this.class)}}]);return a}()},"./src/loader/fragment-loader.ts":function(c,a,b){function e(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;n(a,b)}function d(a){var b="function"===typeof Map?new Map:void 0;d=function(a){function c(){return f(a,arguments,k(this).constructor)}if(null===a||-1===Function.toString.call(a).indexOf("[native code]"))return a;
if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});return n(c,a)};return d(a)}function f(a,b,c){f=g()?Reflect.construct.bind():function(a,b,c){var d=[null];d.push.apply(d,b);a=new (Function.bind.apply(a,d));c&&n(a,c.prototype);return a};return f.apply(null,arguments)}function g(){if("undefined"===
typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function n(a,b){n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return n(a,b)}function k(a){k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)};return k(a)}function h(a,b){void 0===b&&(b=
null);var c=b||a,d={frag:a,part:b,responseType:"arraybuffer",url:c.url,headers:{},rangeStart:0,rangeEnd:0},e=c.byteRangeStartOffset,c=c.byteRangeEndOffset;Object(l.isFiniteNumber)(e)&&Object(l.isFiniteNumber)(c)&&(d.rangeStart=e,d.rangeEnd=c);return d}b.r(a);b.d(a,"default",function(){return C});b.d(a,"LoadError",function(){return z});var l=b("./src/polyfills/number.ts"),w=b("./src/errors.ts"),r=Math.pow(2,17),C=function(){function a(b){this.config=void 0;this.loader=null;this.partLoadTimeout=-1;
this.config=b}var b=a.prototype;b.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};b.abort=function(){this.loader&&this.loader.abort()};b.load=function(a,b){var c=this,d=a.url;if(!d)return Promise.reject(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:a,networkDetails:null},"Fragment does not have a "+(d?"part list":"url")));this.abort();var e=this.config,f=e.fLoader,k=e.loader;return new Promise(function(d,g){c.loader&&c.loader.destroy();
var l=c.loader=a.loader=f?new f(e):new k(e),n=h(a),q={timeout:e.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:e.fragLoadingMaxRetryTimeout,highWaterMark:"initSegment"===a.sn?Infinity:r};a.stats=l.stats;l.load(n,q,{onSuccess:function(b,e,f,k){c.resetLoader(a,l);d({frag:a,part:null,payload:b.data,networkDetails:k})},onError:function(b,d,e){c.resetLoader(a,l);g(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:a,response:b,networkDetails:e}))},onAbort:function(b,
d,e){c.resetLoader(a,l);g(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:a,networkDetails:e}))},onTimeout:function(b,d,e){c.resetLoader(a,l);g(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:a,networkDetails:e}))},onProgress:function(c,d,e,f){b&&b({frag:a,part:null,payload:e,networkDetails:f})}})})};b.loadPart=function(a,b,c){var d=this;this.abort();var e=this.config,f=e.fLoader,k=e.loader;return new Promise(function(g,
l){d.loader&&d.loader.destroy();var n=d.loader=a.loader=f?new f(e):new k(e),q=h(a,b),A={timeout:e.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:e.fragLoadingMaxRetryTimeout,highWaterMark:r};b.stats=n.stats;n.load(q,A,{onSuccess:function(e,f,k,l){d.resetLoader(a,n);d.updateStatsFromPart(a,b);e={frag:a,part:b,payload:e.data,networkDetails:l};c(e);g(e)},onError:function(c,e,f){d.resetLoader(a,n);l(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:a,
part:b,response:c,networkDetails:f}))},onAbort:function(c,e,f){a.stats.aborted=b.stats.aborted;d.resetLoader(a,n);l(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:a,part:b,networkDetails:f}))},onTimeout:function(c,e,f){d.resetLoader(a,n);l(new z({type:w.ErrorTypes.NETWORK_ERROR,details:w.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:a,part:b,networkDetails:f}))}})})};b.updateStatsFromPart=function(a,b){var c=a.stats,d=b.stats,e=d.total;c.loaded+=d.loaded;
if(e){var f=Math.round(a.duration/b.duration),e=Math.min(Math.round(c.loaded/e),f),f=(f-e)*Math.round(c.loaded/e);c.total=c.loaded+f}else c.total=Math.max(c.loaded,c.total);c=c.loading;d=d.loading;c.start?c.first+=d.first-d.start:(c.start=d.start,c.first=d.first);c.end=d.end};b.resetLoader=function(a,b){a.loader=null;this.loader===b&&(self.clearTimeout(this.partLoadTimeout),this.loader=null);b.destroy()};return a}(),z=function(a){function b(c){var d;d=arguments.length;for(var e=Array(1<d?d-1:0),f=
1;f<d;f++)e[f-1]=arguments[f];d=a.call.apply(a,[this].concat(e))||this;d.data=void 0;d.data=c;return d}e(b,a);return b}(d(Error))},"./src/loader/fragment.ts":function(c,a,b){function e(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;d(a,b)}function d(a,b){d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return d(a,b)}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=
!0);Object.defineProperty(a,d.key,d)}}function g(a,b,c){b&&f(a.prototype,b);c&&f(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);b.d(a,"ElementaryStreamTypes",function(){return r});b.d(a,"BaseSegment",function(){return C});b.d(a,"Fragment",function(){return z});b.d(a,"Part",function(){return A});var n=b("./src/polyfills/number.ts"),k=b("./node_modules/url-toolkit/src/url-toolkit.js");b.n(k);var h=b("./src/utils/logger.ts"),l=b("./src/loader/level-key.ts"),w=b("./src/loader/load-stats.ts"),
r;(function(a){a.AUDIO="audio";a.VIDEO="video";a.AUDIOVIDEO="audiovideo"})(r||(r={}));var C=function(){function a(b){var c;this._url=this._byteRange=null;this.relurl=this.baseurl=void 0;this.elementaryStreams=(c={},c[r.AUDIO]=null,c[r.VIDEO]=null,c[r.AUDIOVIDEO]=null,c);this.baseurl=b}a.prototype.setByteRange=function(a,b){var c=a.split("@",2),d=[];d[0]=1===c.length?b?b.byteRangeEndOffset:0:parseInt(c[1]);d[1]=parseInt(c[0])+d[0];this._byteRange=d};g(a,[{key:"byteRange",get:function(){return!this._byteRange?
[]:this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){!this._url&&(this.baseurl&&this.relurl)&&(this._url=Object(k.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0}));return this._url||""},set:function(a){this._url=a}}]);return a}(),z=function(a){function b(c,d){var e;e=a.call(this,d)||this;e._decryptdata=null;e.rawProgramDateTime=null;e.programDateTime=
null;e.tagList=[];e.duration=0;e.sn=0;e.levelkey=void 0;e.type=void 0;e.loader=null;e.level=-1;e.cc=0;e.startPTS=void 0;e.endPTS=void 0;e.appendedPTS=void 0;e.startDTS=void 0;e.endDTS=void 0;e.start=0;e.deltaPTS=void 0;e.maxStartPTS=void 0;e.minEndPTS=void 0;e.stats=new w.LoadStats;e.urlId=0;e.data=void 0;e.bitrateTest=!1;e.title=null;e.initSegment=null;e.type=c;return e}e(b,a);var c=b.prototype;c.createInitializationVector=function(a){for(var b=new Uint8Array(16),c=12;16>c;c++)b[c]=a>>8*(15-c)&255;
return b};c.setDecryptDataFromLevelKey=function(a,b){var c=a;if("AES-128"===(null===a||void 0===a?void 0:a.method)&&a.uri&&!a.iv)c=l.LevelKey.fromURI(a.uri),c.method=a.method,c.iv=this.createInitializationVector(b),c.keyFormat="identity";return c};c.setElementaryStreamInfo=function(a,b,c,d,e,f){void 0===f&&(f=!1);var k=this.elementaryStreams,g=k[a];g?(g.startPTS=Math.min(g.startPTS,b),g.endPTS=Math.max(g.endPTS,c),g.startDTS=Math.min(g.startDTS,d),g.endDTS=Math.max(g.endDTS,e)):k[a]={startPTS:b,endPTS:c,
startDTS:d,endDTS:e,partial:f}};c.clearElementaryStreamInfo=function(){var a=this.elementaryStreams;a[r.AUDIO]=null;a[r.VIDEO]=null;a[r.AUDIOVIDEO]=null};g(b,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var a=this.sn;"number"!==typeof a&&(this.levelkey&&("AES-128"===this.levelkey.method&&!this.levelkey.iv)&&h.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),a=
0);this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,a)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime||!Object(n.isFiniteNumber)(this.programDateTime))return null;var a=!Object(n.isFiniteNumber)(this.duration)?0:this.duration;return this.programDateTime+1E3*a}},{key:"encrypted",get:function(){var a;return null!==(a=this.decryptdata)&&void 0!==a&&a.keyFormat&&this.decryptdata.uri?
!0:!1}}]);return b}(C),A=function(a){function b(c,d,e,f,k){e=a.call(this,e)||this;e.fragOffset=0;e.duration=0;e.gap=!1;e.independent=!1;e.relurl=void 0;e.fragment=void 0;e.index=void 0;e.stats=new w.LoadStats;e.duration=c.decimalFloatingPoint("DURATION");e.gap=c.bool("GAP");e.independent=c.bool("INDEPENDENT");e.relurl=c.enumeratedString("URI");e.fragment=d;e.index=f;(c=c.enumeratedString("BYTERANGE"))&&e.setByteRange(c,k);k&&(e.fragOffset=k.fragOffset+k.duration);return e}e(b,a);g(b,[{key:"start",
get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var a=this.elementaryStreams;return!(!a.audio&&!a.video&&!a.audiovideo)}}]);return b}(C)},"./src/loader/key-loader.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return g});var e=b("./src/events.ts"),d=b("./src/errors.ts"),f=b("./src/utils/logger.ts"),g=function(){function a(b){this.hls=void 0;this.loaders={};this.decrypturl=this.decryptkey=null;
this.hls=b;this.registerListeners()}var b=a.prototype;b.startLoad=function(a){};b.stopLoad=function(){this.destroyInternalLoaders()};b.registerListeners=function(){this.hls.on(e.Events.KEY_LOADING,this.onKeyLoading,this)};b.unregisterListeners=function(){this.hls.off(e.Events.KEY_LOADING,this.onKeyLoading)};b.destroyInternalLoaders=function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={}};b.destroy=function(){this.unregisterListeners();this.destroyInternalLoaders()};
b.onKeyLoading=function(a,b){var c=b.frag,d=c.type,k=this.loaders[d];if(c.decryptdata){var g=c.decryptdata.uri;if(g!==this.decrypturl||null===this.decryptkey){var n=this.hls.config;k&&(f.logger.warn("abort previous key loader for type:"+d),k.abort());g?(d=c.loader=this.loaders[d]=new n.loader(n),this.decrypturl=g,this.decryptkey=null,c={url:g,frag:c,responseType:"arraybuffer"},n={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:n.fragLoadingRetryDelay,maxRetryDelay:n.fragLoadingMaxRetryTimeout,
highWaterMark:0},g={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},d.load(c,n,g)):f.logger.warn("key uri is falsy")}else this.decryptkey&&(c.decryptdata.key=this.decryptkey,this.hls.trigger(e.Events.KEY_LOADED,{frag:c}))}else f.logger.warn("Missing decryption data on fragment in onKeyLoading")};b.loadsuccess=function(a,b,c){b=c.frag;b.decryptdata?(this.decryptkey=b.decryptdata.key=new Uint8Array(a.data),b.loader=null,delete this.loaders[b.type],
this.hls.trigger(e.Events.KEY_LOADED,{frag:b})):f.logger.error("after key load, decryptdata unset")};b.loaderror=function(a,b){var c=b.frag,f=c.loader;f&&f.abort();delete this.loaders[c.type];this.hls.trigger(e.Events.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:a})};b.loadtimeout=function(a,b){var c=b.frag,f=c.loader;f&&f.abort();delete this.loaders[c.type];this.hls.trigger(e.Events.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_TIMEOUT,
fatal:!1,frag:c})};return a}()},"./src/loader/level-details.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);b.d(a,"LevelDetails",function(){return g});var f=b("./src/polyfills/number.ts"),g=function(){function a(b){this.alignedSliding=this.PTSKnown=
!1;this.averagetargetduration=void 0;this.endSN=this.endCC=0;this.fragmentHint=this.fragments=void 0;this.partList=null;this.dateRanges=void 0;this.live=!0;this.ageHeader=0;this.advancedDateTime=void 0;this.advanced=this.updated=!0;this.availabilityDelay=void 0;this.misses=0;this.needSidxRanges=!1;this.startSN=this.startCC=0;this.startTimeOffset=null;this.totalduration=this.targetduration=0;this.type=null;this.url=void 0;this.m3u8="";this.version=null;this.canBlockReload=!1;this.canSkipUntil=0;this.canSkipDateRanges=
!1;this.skippedSegments=0;this.recentlyRemovedDateranges=void 0;this.partTarget=this.holdBack=this.partHoldBack=0;this.renditionReports=this.preloadHint=void 0;this.tuneInGoal=0;this.deltaUpdateFailed=void 0;this.driftEnd=this.driftStart=this.driftEndTime=this.driftStartTime=0;this.fragments=[];this.dateRanges={};this.url=b}a.prototype.reloaded=function(a){if(a){var b=this.lastPartSn-a.lastPartSn,c=this.lastPartIndex-a.lastPartIndex;this.updated=this.endSN!==a.endSN||!!c||!!b;this.advanced=this.endSN>
a.endSN||0<b||0===b&&0<c;this.misses=this.updated||this.advanced?Math.floor(0.6*a.misses):a.misses+1;this.availabilityDelay=a.availabilityDelay}else this.updated=this.advanced=!0};d(a,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(f.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var a=this.driftEndTime-this.driftStartTime;
return 0<a?1E3*(this.driftEnd-this.driftStart)/a:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var a;return null!==(a=this.partList)&&void 0!==a&&a.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var a;return null!==(a=this.fragments)&&void 0!==a&&a.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,
0)/1E3:0}},{key:"lastPartIndex",get:function(){var a;return null!==(a=this.partList)&&void 0!==a&&a.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var a;return null!==(a=this.partList)&&void 0!==a&&a.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]);return a}()},"./src/loader/level-key.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);
Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}b.r(a);b.d(a,"LevelKey",function(){return g});var f=b("./node_modules/url-toolkit/src/url-toolkit.js");b.n(f);var g=function(){function a(b,c){this.iv=this.key=this.keyID=this.keyFormatVersions=this.keyFormat=this.method=this._uri=null;this._uri=c?Object(f.buildAbsoluteURL)(b,c,{alwaysNormalize:!0}):b}a.fromURL=function(b,c){return new a(b,c)};a.fromURI=function(b){return new a(b)};
d(a,[{key:"uri",get:function(){return this._uri}}]);return a}()},"./src/loader/load-stats.ts":function(c,a,b){b.r(a);b.d(a,"LoadStats",function(){return e});var e=function(){this.aborted=!1;this.bwEstimate=this.chunkCount=this.total=this.retry=this.loaded=0;this.loading={start:0,first:0,end:0};this.parsing={start:0,end:0};this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(c,a,b){function e(a,b){["video","audio","text"].forEach(function(c){var d=a.filter(function(a){return Object(A.isCodecType)(a,
c)});if(d.length){var e=d.filter(function(a){return 0===a.lastIndexOf("avc1",0)||0===a.lastIndexOf("mp4a",0)});b[c+"Codec"]=0<e.length?e[0]:d[0];a=a.filter(function(a){return-1===d.indexOf(a)})}});b.unknownCodecs=a}function d(a,b){for(var c=a[b],d=b;d--;){var e=a[d];if(!e)break;e.programDateTime=c.programDateTime-1E3*e.duration;c=e}}function f(a,b){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):null!==b&&(void 0!==b&&b.programDateTime)&&(a.programDateTime=b.endProgramDateTime);
Object(n.isFiniteNumber)(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}function g(a,b,c,d){a.relurl=b.URI;b.BYTERANGE&&a.setByteRange(b.BYTERANGE);a.level=c;a.sn="initSegment";d&&(a.levelkey=d);a.initSegment=null}b.r(a);b.d(a,"default",function(){return v});var n=b("./src/polyfills/number.ts"),k=b("./node_modules/url-toolkit/src/url-toolkit.js");b.n(k);var h=b("./src/loader/date-range.ts"),l=b("./src/loader/fragment.ts"),w=b("./src/loader/level-details.ts"),r=b("./src/loader/level-key.ts"),
C=b("./src/utils/attr-list.ts"),z=b("./src/utils/logger.ts"),A=b("./src/utils/codecs.ts"),q=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,u=/#EXT-X-MEDIA:(.*)/g,D=RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),m=RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,
/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),y=/\.(mp4|m4s|m4v|m4a)$/i,v=function(){function a(){}a.findGroup=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.id===b)return d}};a.convertAVC1ToAVCOTI=function(a){var b=a.split(".");2<b.length&&(a=b.shift()+".",a+=parseInt(b.shift()).toString(16),a+=("000"+parseInt(b.shift()).toString(16)).slice(-4));
return a};a.resolve=function(a,b){return k.buildAbsoluteURL(b,a,{alwaysNormalize:!0})};a.parseMasterPlaylist=function(b,c){var d=[],f={},k=!1;q.lastIndex=0;for(var g;null!=(g=q.exec(b));)if(g[1]){var l=new C.AttrList(g[1]);g={attrs:l,bitrate:l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),name:l.NAME,url:a.resolve(g[2],c)};var n=l.decimalResolution("RESOLUTION");n&&(g.width=n.width,g.height=n.height);e((l.CODECS||"").split(/[ ,]+/).filter(function(a){return a}),g);g.videoCodec&&
-1!==g.videoCodec.indexOf("avc1")&&(g.videoCodec=a.convertAVC1ToAVCOTI(g.videoCodec));d.push(g)}else g[3]&&(l=new C.AttrList(g[3]),l["DATA-ID"]&&(k=!0,f[l["DATA-ID"]]=l));return{levels:d,sessionData:k?f:null}};a.parseMasterPlaylistMedia=function(b,c,d,e){void 0===e&&(e=[]);var f,g=[],k=0;for(u.lastIndex=0;null!==(f=u.exec(b));)if(f=new C.AttrList(f[1]),f.TYPE===d){f={attrs:f,bitrate:0,id:k++,groupId:f["GROUP-ID"],instreamId:f["INSTREAM-ID"],name:f.NAME||f.LANGUAGE||"",type:d,"default":f.bool("DEFAULT"),
autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:f.LANGUAGE,url:f.URI?a.resolve(f.URI,c):""};if(e.length){var l=a.findGroup(e,f.groupId)||e[0],n=l.audioCodec;n&&(f.audioCodec=n);(l=l.textCodec)&&(f.textCodec=l)}g.push(f)}return g};a.parseLevelPlaylist=function(a,b,c,e,p){var q=new w.LevelDetails(b),u=q.fragments,A=null,v=0,X=0,P=0,W=0,N=null,E=new l.Fragment(e,b),H,K,Q,F=-1,I=!1;D.lastIndex=0;for(q.m3u8=a;null!==(H=D.exec(a));){I&&(I=!1,E=new l.Fragment(e,b),E.start=P,E.sn=v,E.cc=W,E.level=
c,A&&(E.initSegment=A,E.rawProgramDateTime=A.rawProgramDateTime,A.rawProgramDateTime=null));var B=H[1];if(B)E.duration=parseFloat(B),H=(" "+H[2]).slice(1),E.title=H||null,E.tagList.push(H?["INF",B,H]:["INF",B]);else if(H[3])Object(n.isFiniteNumber)(E.duration)&&(E.start=P,Q&&(E.levelkey=Q),E.sn=v,E.level=c,E.cc=W,E.urlId=p,u.push(E),E.relurl=(" "+H[3]).slice(1),f(E,N),N=E,P+=E.duration,v++,X=0,I=!0);else if(H[4])B=(" "+H[4]).slice(1),N?E.setByteRange(B,N):E.setByteRange(B);else if(H[5])E.rawProgramDateTime=
(" "+H[5]).slice(1),E.tagList.push(["PROGRAM-DATE-TIME",E.rawProgramDateTime]),-1===F&&(F=u.length);else if(H=H[0].match(m)){for(K=1;K<H.length&&"undefined"===typeof H[K];K++);var G=(" "+H[K]).slice(1),B=(" "+H[K+1]).slice(1);K=H[K+2]?(" "+H[K+2]).slice(1):"";switch(G){case "PLAYLIST-TYPE":q.type=B.toUpperCase();break;case "MEDIA-SEQUENCE":v=q.startSN=parseInt(B);break;case "SKIP":B=new C.AttrList(B);H=B.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(H)){for(G=q.skippedSegments=H;G--;)u.unshift(null);
v+=H}if(B=B.enumeratedString("RECENTLY-REMOVED-DATERANGES"))q.recentlyRemovedDateranges=B.split("\t");break;case "TARGETDURATION":q.targetduration=parseFloat(B);break;case "VERSION":q.version=parseInt(B);break;case "EXTM3U":break;case "ENDLIST":q.live=!1;break;case "#":if(B||K)E.tagList.push(K?[B,K]:[B]);break;case "DISCONTINUITY":W++;E.tagList.push(["DIS"]);break;case "GAP":E.tagList.push([G]);break;case "BITRATE":E.tagList.push([G,B]);break;case "DATERANGE":H=new C.AttrList(B);H=new h.DateRange(H,
q.dateRanges[H.ID]);H.isValid||q.skippedSegments?q.dateRanges[H.id]=H:z.logger.warn('Ignoring invalid DATERANGE tag: "'+B+'"');E.tagList.push(["EXT-X-DATERANGE",B]);break;case "DISCONTINUITY-SEQUENCE":W=parseInt(B);break;case "KEY":var tb,Y=new C.AttrList(B),B=Y.enumeratedString("METHOD");H=Y.URI;G=Y.hexadecimalInteger("IV");K=Y.enumeratedString("KEYFORMATVERSIONS");var M=Y.enumeratedString("KEYID"),Y=null!=(tb=Y.enumeratedString("KEYFORMAT"))?tb:"identity";if(-1<["com.apple.streamingkeydelivery",
"com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(Y)){z.logger.warn("Keyformat "+Y+" is not supported from the manifest");continue}else if("identity"!==Y)continue;B&&(Q=r.LevelKey.fromURL(b,H),H&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(B)&&(Q.method=B,Q.keyFormat=Y,M&&(Q.keyID=M),K&&(Q.keyFormatVersions=K),Q.iv=G));break;case "START":B=(new C.AttrList(B)).decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(B)&&(q.startTimeOffset=
B);break;case "MAP":A=new C.AttrList(B);E.duration?(B=new l.Fragment(e,b),g(B,A,c,Q),A=B,E.initSegment=A,A.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=A.rawProgramDateTime)):(g(E,A,c,Q),A=E,I=!0);break;case "SERVER-CONTROL":B=new C.AttrList(B);q.canBlockReload=B.bool("CAN-BLOCK-RELOAD");q.canSkipUntil=B.optionalFloat("CAN-SKIP-UNTIL",0);q.canSkipDateRanges=0<q.canSkipUntil&&B.bool("CAN-SKIP-DATERANGES");q.partHoldBack=B.optionalFloat("PART-HOLD-BACK",0);q.holdBack=B.optionalFloat("HOLD-BACK",
0);break;case "PART-INF":B=new C.AttrList(B);q.partTarget=B.decimalFloatingPoint("PART-TARGET");break;case "PART":H=q.partList;H||(H=q.partList=[]);G=0<X?H[H.length-1]:void 0;K=X++;B=new l.Part(new C.AttrList(B),E,b,K,G);H.push(B);E.duration+=B.duration;break;case "PRELOAD-HINT":B=new C.AttrList(B);q.preloadHint=B;break;case "RENDITION-REPORT":B=new C.AttrList(B);q.renditionReports=q.renditionReports||[];q.renditionReports.push(B);break;default:z.logger.warn("line parsed but not handled: "+H)}}else z.logger.warn("No matches on slow regex match for level playlist!")}N&&
!N.relurl?(u.pop(),P-=N.duration,q.partList&&(q.fragmentHint=N)):q.partList&&(f(E,N),E.cc=W,q.fragmentHint=E);E=u.length;a=u[0];p=u[E-1];P+=q.skippedSegments*q.targetduration;0<P&&E&&p?(q.averagetargetduration=P/E,E=p.sn,q.endSN="initSegment"!==E?E:0,a&&(q.startCC=a.cc,!a.initSegment&&q.fragments.every(function(a){var b;if(b=a.relurl){var c,d;b=y.test(null!=(c=null===(d=k.parseURL(a.relurl))||void 0===d?void 0:d.path)?c:"")}return b})&&(z.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),
E=new l.Fragment(e,b),E.relurl=p.relurl,E.level=c,E.sn="initSegment",a.initSegment=E,q.needSidxRanges=!0))):(q.endSN=0,q.startCC=0);q.fragmentHint&&(P+=q.fragmentHint.duration);q.totalduration=P;q.endCC=W;0<F&&d(u,F);return q};return a}()},"./src/loader/playlist-loader.ts":function(c,a,b){function e(a,b){var c=a.url;if(void 0===c||0===c.indexOf("data:"))c=b.url;return c}b.r(a);var d=b("./src/polyfills/number.ts"),f=b("./src/events.ts"),g=b("./src/errors.ts"),n=b("./src/utils/logger.ts"),k=b("./src/utils/mp4-tools.ts"),
h=b("./src/loader/m3u8-parser.ts"),l=b("./src/types/loader.ts"),w=b("./src/utils/attr-list.ts");c=function(){function a(b){this.hls=void 0;this.loaders=Object.create(null);this.hls=b;this.registerListeners()}var b=a.prototype;b.startLoad=function(a){};b.stopLoad=function(){this.destroyInternalLoaders()};b.registerListeners=function(){var a=this.hls;a.on(f.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.on(f.Events.LEVEL_LOADING,this.onLevelLoading,this);a.on(f.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,
this);a.on(f.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)};b.unregisterListeners=function(){var a=this.hls;a.off(f.Events.MANIFEST_LOADING,this.onManifestLoading,this);a.off(f.Events.LEVEL_LOADING,this.onLevelLoading,this);a.off(f.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this);a.off(f.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)};b.createInternalLoader=function(a){var b=this.hls.config,c=b.loader,b=new (b.pLoader||c)(b);a.loader=b;return this.loaders[a.type]=
b};b.getInternalLoader=function(a){return this.loaders[a.type]};b.resetInternalLoader=function(a){this.loaders[a]&&delete this.loaders[a]};b.destroyInternalLoaders=function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy();this.resetInternalLoader(a)}};b.destroy=function(){this.unregisterListeners();this.destroyInternalLoaders()};b.onManifestLoading=function(a,b){this.load({id:null,groupId:null,level:0,responseType:"text",type:l.PlaylistContextType.MANIFEST,url:b.url,deliveryDirectives:null})};
b.onLevelLoading=function(a,b){this.load({id:b.id,groupId:null,level:b.level,responseType:"text",type:l.PlaylistContextType.LEVEL,url:b.url,deliveryDirectives:b.deliveryDirectives})};b.onAudioTrackLoading=function(a,b){this.load({id:b.id,groupId:b.groupId,level:null,responseType:"text",type:l.PlaylistContextType.AUDIO_TRACK,url:b.url,deliveryDirectives:b.deliveryDirectives})};b.onSubtitleTrackLoading=function(a,b){this.load({id:b.id,groupId:b.groupId,level:null,responseType:"text",type:l.PlaylistContextType.SUBTITLE_TRACK,
url:b.url,deliveryDirectives:b.deliveryDirectives})};b.load=function(a){var b,c=this.hls.config,d=this.getInternalLoader(a);if(d){var e=d.context;if(e&&e.url===a.url){n.logger.trace("[playlist-loader]: playlist request ongoing");return}n.logger.log("[playlist-loader]: aborting previous loader for type: "+a.type);d.abort()}var f,g,k;switch(a.type){case l.PlaylistContextType.MANIFEST:e=c.manifestLoadingMaxRetry;f=c.manifestLoadingTimeOut;g=c.manifestLoadingRetryDelay;k=c.manifestLoadingMaxRetryTimeout;
break;case l.PlaylistContextType.LEVEL:case l.PlaylistContextType.AUDIO_TRACK:case l.PlaylistContextType.SUBTITLE_TRACK:e=0;f=c.levelLoadingTimeOut;break;default:e=c.levelLoadingMaxRetry,f=c.levelLoadingTimeOut,g=c.levelLoadingRetryDelay,k=c.levelLoadingMaxRetryTimeout}d=this.createInternalLoader(a);if(null!==(b=a.deliveryDirectives)&&void 0!==b&&b.part){var h;a.type===l.PlaylistContextType.LEVEL&&null!==a.level?h=this.hls.levels[a.level].details:a.type===l.PlaylistContextType.AUDIO_TRACK&&null!==
a.id?h=this.hls.audioTracks[a.id].details:a.type===l.PlaylistContextType.SUBTITLE_TRACK&&null!==a.id&&(h=this.hls.subtitleTracks[a.id].details);h&&(b=h.partTarget,h=h.targetduration,b&&h&&(f=Math.min(1E3*Math.max(3*b,0.8*h),f)))}g={timeout:f,maxRetry:e,retryDelay:g,maxRetryDelay:k,highWaterMark:0};k={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};d.load(a,g,k)};b.loadsuccess=function(a,b,c,d){void 0===d&&(d=null);if(c.isSidxRequest)this.handleSidxRequest(a,
c),this.handlePlaylistLoaded(a,b,c,d);else{this.resetInternalLoader(c.type);var e=a.data;0!==e.indexOf("#EXTM3U")?this.handleManifestParsingError(a,c,"no EXTM3U delimiter",d):(b.parsing.start=performance.now(),0<e.indexOf("#EXTINF:")||0<e.indexOf("#EXT-X-TARGETDURATION:")?this.handleTrackOrLevelPlaylist(a,b,c,d):this.handleMasterPlaylist(a,b,c,d))}};b.loaderror=function(a,b,c){void 0===c&&(c=null);this.handleNetworkError(b,c,!1,a)};b.loadtimeout=function(a,b,c){void 0===c&&(c=null);this.handleNetworkError(b,
c,!0)};b.handleMasterPlaylist=function(a,b,c,d){var g=this.hls,k=a.data,l=e(a,c),r=h["default"].parseMasterPlaylist(k,l),p=r.levels,r=r.sessionData;p.length?(a=p.map(function(a){return{id:a.attrs.AUDIO,audioCodec:a.audioCodec}}),c=p.map(function(a){return{id:a.attrs.SUBTITLES,textCodec:a.textCodec}}),a=h["default"].parseMasterPlaylistMedia(k,l,"AUDIO",a),c=h["default"].parseMasterPlaylistMedia(k,l,"SUBTITLES",c),k=h["default"].parseMasterPlaylistMedia(k,l,"CLOSED-CAPTIONS"),a.length&&(!a.some(function(a){return!a.url})&&
p[0].audioCodec&&!p[0].attrs.AUDIO)&&(n.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),a.unshift({type:"main",name:"main","default":!1,autoselect:!1,forced:!1,id:-1,attrs:new w.AttrList({}),bitrate:0,url:""})),g.trigger(f.Events.MANIFEST_LOADED,{levels:p,audioTracks:a,subtitles:c,captions:k,url:l,stats:b,networkDetails:d,sessionData:r})):this.handleManifestParsingError(a,c,"no level found in manifest",d)};b.handleTrackOrLevelPlaylist=
function(a,b,c,k){var n=this.hls,m=c.id,r=c.level,v=c.type,p=e(a,c),x=Object(d.isFiniteNumber)(m)?m:0,C=Object(d.isFiniteNumber)(r)?r:x,R;a:switch(c.type){case l.PlaylistContextType.AUDIO_TRACK:R=l.PlaylistLevelType.AUDIO;break a;case l.PlaylistContextType.SUBTITLE_TRACK:R=l.PlaylistLevelType.SUBTITLE;break a;default:R=l.PlaylistLevelType.MAIN}x=h["default"].parseLevelPlaylist(a.data,p,C,R,x);if(x.fragments.length)if(v===l.PlaylistContextType.MANIFEST&&(C={attrs:new w.AttrList({}),bitrate:0,details:x,
name:"",url:p},n.trigger(f.Events.MANIFEST_LOADED,{levels:[C],audioTracks:[],url:p,stats:b,networkDetails:k,sessionData:null})),b.parsing.end=performance.now(),x.needSidxRanges){var O;a=null===(O=x.fragments[0].initSegment)||void 0===O?void 0:O.url;this.load({url:a,isSidxRequest:!0,type:v,level:r,levelDetails:x,id:m,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else c.levelDetails=x,this.handlePlaylistLoaded(a,b,c,k);else n.trigger(f.Events.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,
details:g.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:p,reason:"no fragments found in level",level:"number"===typeof c.level?c.level:void 0})};b.handleSidxRequest=function(a,b){var c=new Uint8Array(a.data),d=Object(k.findBox)(c,["sidx"])[0];if(d&&(d=Object(k.parseSegmentIndex)(d))){var e=b.levelDetails;d.references.forEach(function(a,b){var d=a.info,f=e.fragments[b];0===f.byteRange.length&&f.setByteRange(String(1+d.end-d.start)+"@"+String(d.start));f.initSegment&&(d=Object(k.findBox)(c,["moov"])[0],
f.initSegment.setByteRange(String(d?d.length:null)+"@0"))})}};b.handleManifestParsingError=function(a,b,c,d){this.hls.trigger(f.Events.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:b.type===l.PlaylistContextType.MANIFEST,url:a.url,reason:c,response:a,context:b,networkDetails:d})};b.handleNetworkError=function(a,b,c,d){void 0===c&&(c=!1);n.logger.warn("[playlist-loader]: A network "+(c?"timeout":"error")+" occurred while loading "+a.type+" level: "+a.level+
" id: "+a.id+' group-id: "'+a.groupId+'"');var e=g.ErrorDetails.UNKNOWN,k=!1,h=this.getInternalLoader(a);switch(a.type){case l.PlaylistContextType.MANIFEST:e=c?g.ErrorDetails.MANIFEST_LOAD_TIMEOUT:g.ErrorDetails.MANIFEST_LOAD_ERROR;k=!0;break;case l.PlaylistContextType.LEVEL:e=c?g.ErrorDetails.LEVEL_LOAD_TIMEOUT:g.ErrorDetails.LEVEL_LOAD_ERROR;k=!1;break;case l.PlaylistContextType.AUDIO_TRACK:e=c?g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;k=!1;break;case l.PlaylistContextType.SUBTITLE_TRACK:e=
c?g.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:g.ErrorDetails.SUBTITLE_LOAD_ERROR,k=!1}h&&this.resetInternalLoader(a.type);a={type:g.ErrorTypes.NETWORK_ERROR,details:e,fatal:k,url:a.url,loader:h,context:a,networkDetails:b};d&&(a.response=d);this.hls.trigger(f.Events.ERROR,a)};b.handlePlaylistLoaded=function(a,b,c,d){var e=c.type,k=c.level,g=c.id,n=c.groupId,h=c.loader,t=c.levelDetails,r=c.deliveryDirectives;if(null!==t&&void 0!==t&&t.targetduration){if(h){if(t.live&&(h.getCacheAge&&(t.ageHeader=h.getCacheAge()||
0),!h.getCacheAge||isNaN(t.ageHeader)))t.ageHeader=0;switch(e){case l.PlaylistContextType.MANIFEST:case l.PlaylistContextType.LEVEL:this.hls.trigger(f.Events.LEVEL_LOADED,{details:t,level:k||0,id:g||0,stats:b,networkDetails:d,deliveryDirectives:r});break;case l.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(f.Events.AUDIO_TRACK_LOADED,{details:t,id:g||0,groupId:n||"",stats:b,networkDetails:d,deliveryDirectives:r});break;case l.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(f.Events.SUBTITLE_TRACK_LOADED,
{details:t,id:g||0,groupId:n||"",stats:b,networkDetails:d,deliveryDirectives:r})}}}else this.handleManifestParsingError(a,c,"invalid target duration",d)};return a}();a["default"]=c},"./src/polyfills/number.ts":function(c,a,b){b.r(a);b.d(a,"isFiniteNumber",function(){return e});b.d(a,"MAX_SAFE_INTEGER",function(){return d});var e=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)},d=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(c,a,b){b.r(a);c=function(){function a(){}
a.getSilentFrame=function(a,b){switch(a){case "mp4a.40.2":if(1===b)return new Uint8Array([0,200,0,128,35,128]);if(2===b)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,
4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===b)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===b||3===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}};return a}();a["default"]=
c},"./src/remux/mp4-generator.ts":function(c,a,b){b.r(a);var e=Math.pow(2,32)-1;c=function(){function a(){}a.init=function(){a.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};for(var b in a.types)a.types.hasOwnProperty(b)&&(a.types[b]=[b.charCodeAt(0),
b.charCodeAt(1),b.charCodeAt(2),b.charCodeAt(3)]);b=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var c=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);a.HDLR_TYPES={video:b,audio:c};b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);c=new Uint8Array([0,0,0,0,0,0,0,0]);a.STTS=a.STSC=a.STCO=c;a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,
0,0]);a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);a.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var c=new Uint8Array([105,115,111,109]),e=new Uint8Array([97,118,99,49]),k=new Uint8Array([0,0,0,1]);a.FTYP=a.box(a.types.ftyp,c,k,c,e);a.DINF=a.box(a.types.dinf,a.box(a.types.dref,b))};a.box=function(a){for(var b=8,c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];for(e=c=d.length;c--;)b+=d[c].byteLength;var l=new Uint8Array(b);l[0]=b>>24&255;
l[1]=b>>16&255;l[2]=b>>8&255;l[3]=b&255;l.set(a,4);c=0;for(b=8;c<e;c++)l.set(d[c],b),b+=d[c].byteLength;return l};a.hdlr=function(b){return a.box(a.types.hdlr,a.HDLR_TYPES[b])};a.mdat=function(b){return a.box(a.types.mdat,b)};a.mdhd=function(b,c){c*=b;var n=Math.floor(c/(e+1)),k=Math.floor(c%(e+1));return a.box(a.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,b&255,n>>24,n>>16&255,n>>8&255,n&255,k>>24,k>>16&255,k>>8&255,k&255,85,196,0,0]))};a.mdia=
function(b){return a.box(a.types.mdia,a.mdhd(b.timescale,b.duration),a.hdlr(b.type),a.minf(b))};a.mfhd=function(b){return a.box(a.types.mfhd,new Uint8Array([0,0,0,0,b>>24,b>>16&255,b>>8&255,b&255]))};a.minf=function(b){return"audio"===b.type?a.box(a.types.minf,a.box(a.types.smhd,a.SMHD),a.DINF,a.stbl(b)):a.box(a.types.minf,a.box(a.types.vmhd,a.VMHD),a.DINF,a.stbl(b))};a.moof=function(b,c,e){return a.box(a.types.moof,a.mfhd(b),a.traf(e,c))};a.moov=function(b){for(var c=b.length,e=[];c--;)e[c]=a.trak(b[c]);
return a.box.apply(null,[a.types.moov,a.mvhd(b[0].timescale,b[0].duration)].concat(e).concat(a.mvex(b)))};a.mvex=function(b){for(var c=b.length,e=[];c--;)e[c]=a.trex(b[c]);return a.box.apply(null,[a.types.mvex].concat(e))};a.mvhd=function(b,c){c*=b;var n=Math.floor(c/(e+1)),k=Math.floor(c%(e+1)),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,b&255,n>>24,n>>16&255,n>>8&255,n&255,k>>24,k>>16&255,k>>8&255,k&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a.box(a.types.mvhd,n)};a.sdtp=function(b){b=b.samples||[];var c=new Uint8Array(4+b.length),e,k;for(e=0;e<b.length;e++)k=b[e].flags,c[e+4]=k.dependsOn<<4|k.isDependedOn<<2|k.hasRedundancy;return a.box(a.types.sdtp,c)};a.stbl=function(b){return a.box(a.types.stbl,a.stsd(b),a.box(a.types.stts,a.STTS),a.box(a.types.stsc,a.STSC),a.box(a.types.stsz,a.STSZ),a.box(a.types.stco,a.STCO))};
a.avc1=function(b){var c=[],e=[],k,h,l;for(k=0;k<b.sps.length;k++)h=b.sps[k],l=h.byteLength,c.push(l>>>8&255),c.push(l&255),c=c.concat(Array.prototype.slice.call(h));for(k=0;k<b.pps.length;k++)h=b.pps[k],l=h.byteLength,e.push(l>>>8&255),e.push(l&255),e=e.concat(Array.prototype.slice.call(h));c=a.box(a.types.avcC,new Uint8Array([1,c[3],c[4],c[5],255,224|b.sps.length].concat(c).concat([b.pps.length]).concat(e)));e=b.width;k=b.height;h=b.pixelRatio[0];b=b.pixelRatio[1];return a.box(a.types.avc1,new Uint8Array([0,
0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,e>>8&255,e&255,k>>8&255,k&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,a.box(a.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),a.box(a.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,b>>24,b>>16&255,b>>8&255,b&255])))};a.esds=function(a){var b=a.config.length;return new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,
0,0,0,0,0,0,0,0,5].concat([b]).concat(a.config).concat([6,1,2]))};a.mp4a=function(b){var c=b.samplerate;return a.box(a.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,c&255,0,0]),a.box(a.types.esds,a.esds(b)))};a.mp3=function(b){var c=b.samplerate;return a.box(a.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,c&255,0,0]))};a.stsd=function(b){return"audio"===b.type?"mp3"===b.segmentCodec&&"mp3"===
b.codec?a.box(a.types.stsd,a.STSD,a.mp3(b)):a.box(a.types.stsd,a.STSD,a.mp4a(b)):a.box(a.types.stsd,a.STSD,a.avc1(b))};a.tkhd=function(b){var c=b.id,h=b.duration*b.timescale,k=b.width;b=b.height;var t=Math.floor(h/(e+1)),h=Math.floor(h%(e+1));return a.box(a.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,c&255,0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,h>>24,h>>16&255,h>>8&255,h&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,k>>8&255,k&255,0,0,b>>8&255,b&255,0,0]))};a.traf=function(b,c){var h=a.sdtp(b),k=b.id,t=Math.floor(c/(e+1)),l=Math.floor(c%(e+1));return a.box(a.types.traf,a.box(a.types.tfhd,new Uint8Array([0,0,0,0,k>>24,k>>16&255,k>>8&255,k&255])),a.box(a.types.tfdt,new Uint8Array([1,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,l>>24,l>>16&255,l>>8&255,l&255])),a.trun(b,h.length+16+20+8+16+8+8),h)};a.trak=function(b){b.duration=b.duration||4294967295;return a.box(a.types.trak,a.tkhd(b),
a.mdia(b))};a.trex=function(b){b=b.id;return a.box(a.types.trex,new Uint8Array([0,0,0,0,b>>24,b>>16&255,b>>8&255,b&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};a.trun=function(b,c){var e=b.samples||[],k=e.length,h=12+16*k,l=new Uint8Array(h),w,r,C,z;c+=8+h;l.set(["video"===b.type?1:0,0,15,1,k>>>24&255,k>>>16&255,k>>>8&255,k&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255],0);for(h=0;h<k;h++)w=e[h],r=w.duration,C=w.size,z=w.flags,w=w.cts,l.set([r>>>24&255,r>>>16&255,r>>>8&255,r&255,C>>>24&255,C>>>16&255,C>>>
8&255,C&255,z.isLeading<<2|z.dependsOn,z.isDependedOn<<6|z.hasRedundancy<<4|z.paddingValue<<1|z.isNonSync,z.degradPrio&61440,z.degradPrio&15,w>>>24&255,w>>>16&255,w>>>8&255,w&255],12+16*h);return a.box(a.types.trun,l)};a.initSegment=function(b){a.types||a.init();b=a.moov(b);var c=new Uint8Array(a.FTYP.byteLength+b.byteLength);c.set(a.FTYP);c.set(b,a.FTYP.byteLength);return c};return a}();c.types=void 0;c.HDLR_TYPES=void 0;c.STTS=void 0;c.STSC=void 0;c.STCO=void 0;c.STSZ=void 0;c.VMHD=void 0;c.SMHD=
void 0;c.STSD=void 0;c.FTYP=void 0;c.DINF=void 0;a["default"]=c},"./src/remux/mp4-remuxer.ts":function(c,a,b){function e(){e=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return e.apply(this,arguments)}function d(a,b){var c;if(null===b)return a;for(c=b<a?-8589934592:8589934592;4294967296<Math.abs(a-b);)a+=c;return a}function f(a,b,c,e){var f=a.samples.length;if(f){for(var k=
a.inputTimeScale,g=0;g<f;g++){var l=a.samples[g];l.pts=d(l.pts-c,b*k)/k;l.dts=d(l.dts-e,b*k)/k}b=a.samples;a.samples=[];return{samples:b}}}function g(a,b,c){var e=a.samples.length;if(e){for(var f=a.inputTimeScale,k=0;k<e;k++){var g=a.samples[k];g.pts=d(g.pts-c,b*f)/f}a.samples.sort(function(a,b){return a.pts-b.pts});b=a.samples;a.samples=[];return{samples:b}}}b.r(a);b.d(a,"default",function(){return u});b.d(a,"normalizePts",function(){return d});b.d(a,"flushTextTrackMetadataCueSamples",function(){return f});
b.d(a,"flushTextTrackUserdataCueSamples",function(){return g});var h=b("./src/polyfills/number.ts"),k=b("./src/remux/aac-helper.ts"),t=b("./src/remux/mp4-generator.ts"),l=b("./src/events.ts"),w=b("./src/errors.ts"),r=b("./src/utils/logger.ts"),C=b("./src/types/loader.ts"),z=b("./src/utils/timescale-conversion.ts"),A=null,q=null,u=function(){function a(b,c,d,e){this.typeSupported=this.config=this.observer=void 0;this.ISGenerated=!1;this._initDTS=this._initPTS=void 0;this.videoSampleDuration=this.nextAudioPts=
this.nextAvcDts=null;this.isVideoContiguous=this.isAudioContiguous=!1;this.observer=b;this.config=c;this.typeSupported=d;this.ISGenerated=!1;null===A&&(A=(b=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?parseInt(b[1]):0);null===q&&(q=(b=navigator.userAgent.match(/Safari\/(\d+)/i))?parseInt(b[1]):0)}var b=a.prototype;b.destroy=function(){};b.resetTimeStamp=function(a){r.logger.log("[mp4-remuxer]: initPTS & initDTS reset");this._initPTS=this._initDTS=a};b.resetNextTimestamp=function(){r.logger.log("[mp4-remuxer]: reset next timestamp");
this.isAudioContiguous=this.isVideoContiguous=!1};b.resetInitSegment=function(){r.logger.log("[mp4-remuxer]: ISGenerated flag reset");this.ISGenerated=!1};b.getVideoStartPts=function(a){var b=!1;a=a.reduce(function(a,c){var e=c.pts-a;return-4294967296>e?(b=!0,d(a,c.pts)):0<e?a:c.pts},a[0].pts);b&&r.logger.debug("PTS rollover detected");return a};b.remux=function(a,b,c,e,k,l,h,n){var m,t,w,q,u,A,E=k,y=k,z=-1<b.pid,D=b.samples.length,v=0<a.samples.length,I=h&&0<D||1<D;if((!(-1<a.pid)||v)&&(!z||I)||
this.ISGenerated||h){this.ISGenerated||(w=this.generateIS(a,b,k));h=this.isVideoContiguous;var B=-1,F;if(I){a:{for(var B=b.samples,G=0;G<B.length;G++)if(B[G].key){B=G;break a}B=-1}!h&&this.config.forceKeyFrameOnDiscontinuity&&(A=!0,0<B?(r.logger.warn("[mp4-remuxer]: Dropped "+B+" out of "+D+" video samples due to a missing keyframe"),F=this.getVideoStartPts(b.samples),b.samples=b.samples.slice(B),b.dropped+=B,F=y+=(b.samples[0].pts-F)/b.inputTimeScale):-1===B&&(r.logger.warn("[mp4-remuxer]: No keyframe found out of "+
D+" video samples"),A=!1))}this.ISGenerated&&(v&&I&&(D=this.getVideoStartPts(b.samples),D=(d(a.samples[0].pts,D)-D)/b.inputTimeScale,E+=Math.max(0,D),y+=Math.max(0,-D)),v?(a.samplerate||(r.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),w=this.generateIS(a,b,k)),t=this.remuxAudio(a,E,this.isAudioContiguous,l,z||I||n===C.PlaylistLevelType.AUDIO?y:void 0),I&&(l=t?t.endPTS-t.startPTS:0,b.inputTimeScale||(r.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),
w=this.generateIS(a,b,k)),m=this.remuxVideo(b,y,h,l))):I&&(m=this.remuxVideo(b,y,h,0)),m&&(m.firstKeyFrame=B,m.independent=-1!==B,m.firstKeyFramePTS=F))}this.ISGenerated&&(c.samples.length&&(u=f(c,k,this._initPTS,this._initDTS)),e.samples.length&&(q=g(e,k,this._initPTS)));return{audio:t,video:m,initSegment:w,independent:A,text:q,id3:u}};b.generateIS=function(a,b,c){var e=a.samples,f=b.samples,k=this.typeSupported,g={},l=!Object(h.isFiniteNumber)(this._initPTS),m="audio/mp4",r,w,q;l&&(r=w=Infinity);
if(a.config&&e.length){a.timescale=a.samplerate;switch(a.segmentCodec){case "mp3":k.mpeg?(m="audio/mpeg",a.codec=""):k.mp3&&(a.codec="mp3")}g.audio={id:"audio",container:m,codec:a.codec,initSegment:"mp3"===a.segmentCodec&&k.mpeg?new Uint8Array(0):t["default"].initSegment([a]),metadata:{channelCount:a.channelCount}};l&&(q=a.inputTimeScale,r=w=e[0].pts-Math.round(q*c))}b.sps&&(b.pps&&f.length)&&(b.timescale=b.inputTimeScale,g.video={id:"main",container:"video/mp4",codec:b.codec,initSegment:t["default"].initSegment([b]),
metadata:{width:b.width,height:b.height}},l&&(q=b.inputTimeScale,a=this.getVideoStartPts(f),c=Math.round(q*c),w=Math.min(w,d(f[0].dts,a)-c),r=Math.min(r,a-c)));if(Object.keys(g).length)return this.ISGenerated=!0,l&&(this._initPTS=r,this._initDTS=w),{tracks:g,initPTS:r,timescale:q}};b.remuxVideo=function(a,b,c,f){var k=a.inputTimeScale,g=a.samples,h=[],n=g.length,m=this._initPTS,u=this.nextAvcDts,y=8,v=this.videoSampleDuration,C=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,E=!1;if(!c||null===
u)b*=k,u=g[0].pts-d(g[0].dts,g[0].pts),u=b-u;for(b=0;b<n;b++){var H=g[b];H.pts=d(H.pts-m,u);H.dts=d(H.dts-m,u);if(H.dts<g[0<b?b-1:b].dts)E=!0}E&&g.sort(function(a,b){var c=a.pts-b.pts;return a.dts-b.dts||c});m=g[0].dts;b=g[g.length-1].dts;E=(E=b-m)?Math.round(E/(n-1)):v||a.inputTimeScale/30;if(c&&(b=m-u,(c=b>E)||-1>b))c?r.logger.warn("AVC: "+Object(z.toMsFromMpegTsClock)(b,!0)+" ms ("+b+"dts) hole between fragments detected, filling it"):r.logger.warn("AVC: "+Object(z.toMsFromMpegTsClock)(-b,!0)+
" ms ("+b+"dts) overlapping between fragments detected"),m=u,c=g[0].pts-b,g[0].dts=m,g[0].pts=c,r.logger.log("Video: First PTS/DTS adjusted: "+Object(z.toMsFromMpegTsClock)(c,!0)+"/"+Object(z.toMsFromMpegTsClock)(m,!0)+", delta: "+Object(z.toMsFromMpegTsClock)(b,!0)+" ms");m=Math.max(0,m);for(b=u=c=0;b<n;b++){for(var H=g[b],F=H.units,G=F.length,ja=0,I=0;I<G;I++)ja+=F[I].data.length;u+=ja;c+=G;H.length=ja;H.dts=Math.max(H.dts,m);C=Math.min(H.pts,C);N=Math.max(H.pts,N)}b=g[n-1].dts;c=u+4*c+8;var B;
try{B=new Uint8Array(c)}catch(M){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:w.ErrorTypes.MUX_ERROR,details:w.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:c,reason:"fail allocating video mdat "+c});return}u=new DataView(B.buffer);u.setUint32(0,c);B.set(t["default"].types.mdat,4);c=!1;F=H=Number.POSITIVE_INFINITY;ja=G=Number.NEGATIVE_INFINITY;for(I=0;I<n;I++){for(var J=g[I],v=J.units,Y=0,ka=0,L=v.length;ka<L;ka++){var S=v[ka],T=S.data,S=S.data.byteLength;u.setUint32(y,S);y+=4;B.set(T,y);
y+=S;Y+=4+S}ka=void 0;I<n-1?(v=g[I+1].dts-J.dts,ka=g[I+1].pts-J.pts):(v=this.config,L=0<I?J.dts-g[I-1].dts:E,ka=0<I?J.pts-g[I-1].pts:E,v.stretchShortVideoTrack&&null!==this.nextAudioPts?(T=(f?C+f*k:this.nextAudioPts)-J.pts,T>Math.floor(v.maxBufferHole*k)?(v=T-L,0>v?v=L:c=!0,r.logger.log("[mp4-remuxer]: It is approximately "+T/90+" ms to the next segment; using duration "+v/90+" ms for the last video frame.")):v=L):v=L);L=Math.round(J.pts-J.dts);H=Math.min(H,v);G=Math.max(G,v);F=Math.min(F,ka);ja=
Math.max(ja,ka);h.push(new D(J.key,v,Y,L))}if(h.length)if(A)70>A&&(f=h[0].flags,f.dependsOn=2,f.isNonSync=0);else if(q&&ja-F<G-H&&0.025>E/G&&0===h[0].cts){r.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");y=m;f=0;for(g=h.length;f<g;f++)n=y+h[f].duration,y+=h[f].cts,h[f].duration=f<g-1?n+h[f+1].cts-y:f?h[f-1].duration:E,h[f].cts=0,y=n}console.assert(null!==v,"mp4SampleDuration must be computed");v=c||!v?E:v;this.nextAvcDts=u=b+v;this.videoSampleDuration=
v;this.isVideoContiguous=!0;k={data1:t["default"].moof(a.sequenceNumber++,m,e({},a,{samples:h})),data2:B,startPTS:C/k,endPTS:(N+v)/k,startDTS:m/k,endDTS:u/k,type:"video",hasAudio:!1,hasVideo:!0,nb:h.length,dropped:a.dropped};a.samples=[];a.dropped=0;console.assert(B.length,"MDAT length must not be zero");return k};b.remuxAudio=function(a,b,c,f,g){var h=a.inputTimeScale,n=h/(a.samplerate?a.samplerate:h),m="aac"===a.segmentCodec?1024:1152,q=m*n,u=this._initPTS,y="mp3"===a.segmentCodec&&this.typeSupported.mpeg,
A=[],v=void 0!==g,z=a.samples,E=y?0:8,C=this.nextAudioPts||-1,F=b*h;this.isAudioContiguous=c=c||z.length&&0<C&&(f&&9E3>Math.abs(F-C)||Math.abs(d(z[0].pts-u,F)-C)<20*q);z.forEach(function(a){a.pts=d(a.pts-u,F)});if(!c||0>C){z=z.filter(function(a){return 0<=a.pts});if(!z.length)return;C=0===g?0:f&&!v?Math.max(0,F):z[0].pts}if("aac"===a.segmentCodec){b=this.config.maxAudioFramesDrift;f=0;for(g=C;f<z.length;f++){var G=z[f],J=G.pts,I=J-g,B=Math.abs(1E3*I/h);if(I<=-b*q&&v)0===f&&(r.logger.warn("Audio frame @ "+
(J/h).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1E3*I/h)+" ms."),this.nextAudioPts=C=g=J);else if(I>=b*q&&1E4>B&&v){B=Math.round(I/q);g=J-B*q;0>g&&(B--,g+=q);0===f&&(this.nextAudioPts=C=g);r.logger.warn("[mp4-remuxer]: Injecting "+B+" audio frame @ "+(g/h).toFixed(3)+"s due to "+Math.round(1E3*I/h)+" ms gap.");for(J=0;J<B;J++){var I=Math.max(g,0),M=k["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount);M||(r.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),
M=G.unit.subarray());z.splice(f,0,{unit:M,pts:I});g+=q;f++}}G.pts=g;g+=q}}var v=q=null,L;b=0;for(f=z.length;f--;)b+=z[f].unit.byteLength;f=0;for(g=z.length;f<g;f++){B=z[f];G=B.unit;B=B.pts;if(null!==v)A[f-1].duration=Math.round((B-v)/n);else if(c&&"aac"===a.segmentCodec&&(B=C),q=B,0<b){b+=E;try{L=new Uint8Array(b)}catch(Y){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:w.ErrorTypes.MUX_ERROR,details:w.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:b,reason:"fail allocating audio mdat "+b});
return}y||((new DataView(L.buffer)).setUint32(0,b),L.set(t["default"].types.mdat,4))}else return;L.set(G,E);v=G.byteLength;E+=v;A.push(new D(!0,m,v,0));v=B}if(c=A.length)return this.nextAudioPts=C=v+n*A[A.length-1].duration,n=y?new Uint8Array(0):t["default"].moof(a.sequenceNumber++,q/n,e({},a,{samples:A})),a.samples=[],a=q/h,h=C/h,h={data1:n,data2:L,startPTS:a,endPTS:h,startDTS:a,endDTS:h,type:"audio",hasAudio:!0,hasVideo:!1,nb:c},this.isAudioContiguous=!0,console.assert(L.length,"MDAT length must not be zero"),
h};b.remuxEmptyAudio=function(a,b,c,d){var e=a.inputTimeScale,f=this.nextAudioPts,f=(null!==f?f:d.startDTS*e)+this._initDTS,g=1024*(e/(a.samplerate?a.samplerate:e));d=Math.ceil((d.endDTS*e+this._initDTS-f)/g);e=k["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount);r.logger.warn("[mp4-remuxer]: remux empty Audio");if(e){for(var l=[],h=0;h<d;h++){var n=f+h*g;l.push({unit:e,pts:n,dts:n})}a.samples=l;return this.remuxAudio(a,b,c,!1)}r.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")};
return a}(),D=function(a,b,c,d){this.flags=this.cts=this.duration=this.size=void 0;this.duration=b;this.size=c;this.cts=d;this.flags=new m(a)},m=function(a){this.degradPrio=this.hasRedundancy=this.isDependedOn=this.isLeading=0;this.isNonSync=this.dependsOn=1;this.dependsOn=a?2:1;this.isNonSync=a?0:1}},"./src/remux/passthrough-remuxer.ts":function(c,a,b){function e(a,b){var c=null===a||void 0===a?void 0:a.codec;return c&&4<c.length?c:"hvc1"===c||"hev1"===c?"hvc1.1.c.L120.90":"av01"===c?"av01.0.04M.08":
"avc1"===c||b===h.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}b.r(a);var d=b("./src/polyfills/number.ts"),f=b("./src/remux/mp4-remuxer.ts"),g=b("./src/utils/mp4-tools.ts"),h=b("./src/loader/fragment.ts"),k=b("./src/utils/logger.ts");c=function(){function a(){this.emitInitSegment=!1;this.initTracks=this.initPTS=this.initData=this.videoCodec=this.audioCodec=void 0;this.lastEndTime=null}var b=a.prototype;b.destroy=function(){};b.resetTimeStamp=function(a){this.initPTS=a;this.lastEndTime=null};
b.resetNextTimestamp=function(){this.lastEndTime=null};b.resetInitSegment=function(a,b,c){this.audioCodec=b;this.videoCodec=c;this.generateInitSegment(a);this.emitInitSegment=!0};b.generateInitSegment=function(a){var b=this.audioCodec,c=this.videoCodec;if(!a||!a.byteLength)this.initData=this.initTracks=void 0;else{var d=this.initData=Object(g.parseInitSegment)(a);b||(b=e(d.audio,h.ElementaryStreamTypes.AUDIO));c||(c=e(d.video,h.ElementaryStreamTypes.VIDEO));var f={};d.audio&&d.video?f.audiovideo=
{container:"video/mp4",codec:b+","+c,initSegment:a,id:"main"}:d.audio?f.audio={container:"audio/mp4",codec:b,initSegment:a,id:"audio"}:d.video?f.video={container:"video/mp4",codec:c,initSegment:a,id:"main"}:k.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes.");this.initTracks=f}};b.remux=function(a,b,c,e,h){var l,n=this.initPTS,t=this.lastEndTime,m={audio:void 0,video:void 0,text:e,id3:c,initSegment:void 0};Object(d.isFiniteNumber)(t)||(t=this.lastEndTime=h||
0);var y=b.samples;if(!y||!y.length)return m;b={initPTS:void 0,timescale:1};var v=this.initData;if(!v||!v.length)this.generateInitSegment(y),v=this.initData;if(!v||!v.length)return k.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),m;this.emitInitSegment&&(b.tracks=this.initTracks,this.emitInitSegment=!1);var p=Object(g.getStartDTS)(v,y);Object(d.isFiniteNumber)(n)||(this.initPTS=b.initPTS=n=p-h);var x=Object(g.getDuration)(y,v);a=a?p-n:t;t=a+x;Object(g.offsetStartDTS)(v,y,
n);0<x?this.lastEndTime=t:(k.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());n=!!v.audio;v=!!v.video;x="";n&&(x+="audio");v&&(x+="video");y={data1:y,startPTS:a,startDTS:a,endPTS:t,endDTS:t,type:x,hasAudio:n,hasVideo:v,nb:1,dropped:0};m.audio="audio"===y.type?y:void 0;m.video="audio"!==y.type?y:void 0;m.initSegment=b;b=null!=(l=this.initPTS)?l:0;m.id3=Object(f.flushTextTrackMetadataCueSamples)(c,h,b,b);e.samples.length&&(m.text=Object(f.flushTextTrackUserdataCueSamples)(e,
h,b));return m};return a}();a["default"]=c},"./src/task-loop.ts":function(c,a,b){b.r(a);b.d(a,"default",function(){return e});var e=function(){function a(){this._boundTick=void 0;this._tickInterval=this._tickTimer=null;this._tickCallCount=0;this._boundTick=this.tick.bind(this)}var b=a.prototype;b.destroy=function(){this.onHandlerDestroying();this.onHandlerDestroyed()};b.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()};b.onHandlerDestroyed=function(){};b.hasInterval=function(){return!!this._tickInterval};
b.hasNextTick=function(){return!!this._tickTimer};b.setInterval=function(a){return!this._tickInterval?(this._tickInterval=self.setInterval(this._boundTick,a),!0):!1};b.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1};b.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1};b.tick=function(){this._tickCallCount++;1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&
this.tickImmediate(),this._tickCallCount=0)};b.tickImmediate=function(){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)};b.doTick=function(){};return a}()},"./src/types/demuxer.ts":function(c,a,b){b.r(a);b.d(a,"MetadataSchema",function(){return e});var e;(function(a){a.audioId3="org.id3";a.dateRange="com.apple.quicktime.HLS";a.emsg="https://aomedia.org/emsg/ID3"})(e||(e={}))},"./src/types/level.ts":function(c,a,b){function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function d(a,b,c){b&&e(a.prototype,b);c&&e(a,c);Object.defineProperty(a,"prototype",{writable:!1});return a}function f(a,b){var c=a.canSkipUntil,d=a.canSkipDateRanges,e=a.endSN;return c&&(void 0!==b?b-e:0)<c?d?g.v2:g.Yes:g.No}b.r(a);b.d(a,"HlsSkip",function(){return g});b.d(a,"getSkipValue",function(){return f});b.d(a,"HlsUrlParameters",function(){return h});b.d(a,"Level",function(){return k});var g;
(function(a){a.No="";a.Yes="YES";a.v2="v2"})(g||(g={}));var h=function(){function a(b,c,d){this.skip=this.part=this.msn=void 0;this.msn=b;this.part=c;this.skip=d}a.prototype.addDirectives=function(a){a=new self.URL(a);void 0!==this.msn&&a.searchParams.set("_HLS_msn",this.msn.toString());void 0!==this.part&&a.searchParams.set("_HLS_part",this.part.toString());this.skip&&a.searchParams.set("_HLS_skip",this.skip);return a.toString()};return a}(),k=function(){function a(b){this.details=this.audioGroupIds=
this.unknownCodecs=this.width=this.videoCodec=this.name=this.id=this.height=this.codecSet=this.bitrate=this.audioCodec=this.attrs=void 0;this.loadError=this.fragmentError=0;this.loaded=void 0;this.realBitrate=0;this.url=this.textGroupIds=void 0;this._urlId=0;this.url=[b.url];this.attrs=b.attrs;this.bitrate=b.bitrate;b.details&&(this.details=b.details);this.id=b.id||0;this.name=b.name;this.width=b.width||0;this.height=b.height||0;this.audioCodec=b.audioCodec;this.videoCodec=b.videoCodec;this.unknownCodecs=
b.unknownCodecs;this.codecSet=[b.videoCodec,b.audioCodec].filter(function(a){return a}).join(",").replace(/\.[^.,]+/g,"")}d(a,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(a){a%=this.url.length;this._urlId!==a&&(this.details=void 0,this._urlId=a)}}]);return a}()},"./src/types/loader.ts":function(c,a,b){b.r(a);b.d(a,"PlaylistContextType",function(){return e});
b.d(a,"PlaylistLevelType",function(){return d});var e;(function(a){a.MANIFEST="manifest";a.LEVEL="level";a.AUDIO_TRACK="audioTrack";a.SUBTITLE_TRACK="subtitleTrack"})(e||(e={}));var d;(function(a){a.MAIN="main";a.AUDIO="audio";a.SUBTITLE="subtitle"})(d||(d={}))},"./src/types/transmuxer.ts":function(c,a,b){function e(){return{start:0,executeStart:0,executeEnd:0,end:0}}b.r(a);b.d(a,"ChunkMetadata",function(){return d});var d=function(a,b,c,d,h,l){void 0===d&&(d=0);void 0===h&&(h=-1);void 0===l&&(l=
!1);this.partial=this.size=this.id=this.part=this.sn=this.level=void 0;this.transmuxing=e();this.buffering={audio:e(),video:e(),audiovideo:e()};this.level=a;this.sn=b;this.id=c;this.size=d;this.part=h;this.partial=l}},"./src/utils/attr-list.ts":function(c,a,b){b.r(a);b.d(a,"AttrList",function(){return f});var e=/^(\d+)x(\d+)$/,d=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,f=function(){function a(b){"string"===typeof b&&(b=a.parseAttrList(b));for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])}var b=a.prototype;
b.decimalInteger=function(a){a=parseInt(this[a],10);return a>Number.MAX_SAFE_INTEGER?Infinity:a};b.hexadecimalInteger=function(a){if(this[a]){a=(this[a]||"0x").slice(2);a=(a.length&1?"0":"")+a;for(var b=new Uint8Array(a.length/2),c=0;c<a.length/2;c++)b[c]=parseInt(a.slice(2*c,2*c+2),16);return b}return null};b.hexadecimalIntegerAsNumber=function(a){a=parseInt(this[a],16);return a>Number.MAX_SAFE_INTEGER?Infinity:a};b.decimalFloatingPoint=function(a){return parseFloat(this[a])};b.optionalFloat=function(a,
b){var c=this[a];return c?parseFloat(c):b};b.enumeratedString=function(a){return this[a]};b.bool=function(a){return"YES"===this[a]};b.decimalResolution=function(a){a=e.exec(this[a]);return null===a?void 0:{width:parseInt(a[1],10),height:parseInt(a[2],10)}};a.parseAttrList=function(a){var b,c={};for(d.lastIndex=0;null!==(b=d.exec(a));){var e=b[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1));c[b[1]]=e}return c};return a}()},"./src/utils/binary-search.ts":function(c,a,b){b.r(a);
a["default"]={search:function(a,b){for(var c=0,g=a.length-1,h=null,k=null;c<=g;){var h=(c+g)/2|0,k=a[h],t=b(k);if(0<t)c=h+1;else if(0>t)g=h-1;else return k}return null}}},"./src/utils/buffer-helper.ts":function(c,a,b){b.r(a);b.d(a,"BufferHelper",function(){return f});var e=b("./src/utils/logger.ts"),d={length:0,start:function(){return 0},end:function(){return 0}},f=function(){function a(){}a.isBuffered=function(b,c){try{if(b)for(var d=a.getBuffered(b),e=0;e<d.length;e++)if(c>=d.start(e)&&c<=d.end(e))return!0}catch(f){}return!1};
a.bufferInfo=function(b,c,d){try{if(b){var e=a.getBuffered(b);b=[];var f;for(f=0;f<e.length;f++)b.push({start:e.start(f),end:e.end(f)});return this.bufferedInfo(b,c,d)}}catch(h){}return{len:0,start:c,end:c,nextStart:void 0}};a.bufferedInfo=function(a,b,c){b=Math.max(0,b);a.sort(function(a,b){var c=a.start-b.start;return c?c:b.end-a.end});var d=[];if(c)for(var e=0;e<a.length;e++){var f=d.length;if(f){var g=d[f-1].end;a[e].start-g<c?a[e].end>g&&(d[f-1].end=a[e].end):d.push(a[e])}else d.push(a[e])}else d=
a;a=0;for(var h,f=e=b,g=0;g<d.length;g++){var A=d[g].start,q=d[g].end;if(b+c>=A&&b<q)e=A,f=q,a=f-b;else if(b+c<A){h=A;break}}return{len:a,start:e||0,end:f||0,nextStart:h}};a.getBuffered=function(a){try{return a.buffered}catch(b){return e.logger.log("failed to get media.buffered",b),d}};return a}()},"./src/utils/codecs.ts":function(c,a,b){function e(a,b){var c=f[b];return!!c&&!0===c[a.slice(0,4)]}function d(a,b){return MediaSource.isTypeSupported((b||"video")+'/mp4;codecs="'+a+'"')}b.r(a);b.d(a,"isCodecType",
function(){return e});b.d(a,"isCodecSupportedInMp4",function(){return d});var f={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,
resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}}},"./src/utils/discontinuities.ts":function(c,a,b){function e(a,b){for(var c=null,d=0,e=a.length;d<e;d++){var f=a[d];if(f&&f.cc===b){c=f;break}}return c}function d(a,b,c){return b.details&&(c.endCC>c.startCC||a&&a.cc<c.startCC)?!0:!1}function f(a,b){var c=a.fragments,d=b.fragments;if(!d.length||!c.length)C.logger.log("No fragments to align");else if(c=e(c,d[0].cc),!c||c&&!c.startPTS)C.logger.log("No frag in previous level to align on");
else return c}function g(a,b){if(a){var c=a.start+b;a.start=a.startPTS=c;a.endPTS=c+a.duration}}function h(a,b){for(var c=b.fragments,d=0,e=c.length;d<e;d++)g(c[d],a);b.fragmentHint&&g(b.fragmentHint,a);b.alignedSliding=!0}function k(a,b,c){if(b){if(d(a,b,c)&&(a=f(b.details,c))&&Object(r.isFiniteNumber)(a.start))C.logger.log("Adjusting PTS using last level due to CC increase within current level "+c.url),h(a.start,c);!c.alignedSliding&&b.details&&t(c,b.details);!c.alignedSliding&&(b.details&&!c.skippedSegments)&&
Object(z.adjustSliding)(b.details,c)}}function t(a,b){if(b.fragments.length&&a.hasProgramDateTime&&b.hasProgramDateTime){var c=b.fragments[0].programDateTime,d=a.fragments[0].programDateTime,e=(d-c)/1E3+b.fragments[0].start;e&&Object(r.isFiniteNumber)(e)&&(C.logger.log("Adjusting PTS using programDateTime delta "+(d-c)+"ms, sliding:"+e.toFixed(3)+" "+a.url+" "),h(e,a))}}function l(a,b){var c=a.programDateTime;c&&(c=(c-b)/1E3,a.start=a.startPTS=c,a.endPTS=c+a.duration)}function w(a,b){if(b.fragments.length&&
a.hasProgramDateTime&&b.hasProgramDateTime){var c=b.fragments[0].programDateTime-1E3*b.fragments[0].start;a.fragments.forEach(function(a){l(a,c)});a.fragmentHint&&l(a.fragmentHint,c);a.alignedSliding=!0}}b.r(a);b.d(a,"findFirstFragWithCC",function(){return e});b.d(a,"shouldAlignOnDiscontinuities",function(){return d});b.d(a,"findDiscontinuousReferenceFrag",function(){return f});b.d(a,"adjustSlidingStart",function(){return h});b.d(a,"alignStream",function(){return k});b.d(a,"alignPDT",function(){return t});
b.d(a,"alignFragmentByPDTDelta",function(){return l});b.d(a,"alignMediaPlaylistByPDT",function(){return w});var r=b("./src/polyfills/number.ts"),C=b("./src/utils/logger.ts"),z=b("./src/controller/level-helper.ts")},"./src/utils/ewma-bandwidth-estimator.ts":function(c,a,b){b.r(a);var e=b("./src/utils/ewma.ts");c=function(){function a(b,c,d){this.fast_=this.slow_=this.minDelayMs_=this.minWeight_=this.defaultEstimate_=void 0;this.defaultEstimate_=d;this.minWeight_=0.001;this.minDelayMs_=50;this.slow_=
new e["default"](b);this.fast_=new e["default"](c)}var b=a.prototype;b.update=function(a,b){var c=this.slow_,d=this.fast_;this.slow_.halfLife!==a&&(this.slow_=new e["default"](a,c.getEstimate(),c.getTotalWeight()));this.fast_.halfLife!==b&&(this.fast_=new e["default"](b,d.getEstimate(),d.getTotalWeight()))};b.sample=function(a,b){a=Math.max(a,this.minDelayMs_);var c=a/1E3,d=8*b/c;this.fast_.sample(c,d);this.slow_.sample(c,d)};b.canEstimate=function(){var a=this.fast_;return a&&a.getTotalWeight()>=
this.minWeight_};b.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_};b.destroy=function(){};return a}();a["default"]=c},"./src/utils/ewma.ts":function(c,a,b){b.r(a);c=function(){function a(b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this.totalWeight_=this.estimate_=this.alpha_=this.halfLife=void 0;this.alpha_=(this.halfLife=b)?Math.exp(Math.log(0.5)/b):0;this.estimate_=c;this.totalWeight_=d}var b=a.prototype;b.sample=
function(a,b){var c=Math.pow(this.alpha_,a);this.estimate_=b*(1-c)+c*this.estimate_;this.totalWeight_+=a};b.getTotalWeight=function(){return this.totalWeight_};b.getEstimate=function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);if(a)return this.estimate_/a}return this.estimate_};return a}();a["default"]=c},"./src/utils/fetch-loader.ts":function(c,a,b){function e(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;h(a,b)}function d(a){var b="function"===typeof Map?
new Map:void 0;d=function(a){function c(){return f(a,arguments,k(this).constructor)}if(null===a||-1===Function.toString.call(a).indexOf("[native code]"))return a;if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});return h(c,a)};return d(a)}function f(a,b,c){f=g()?Reflect.construct.bind():
function(a,b,c){var d=[null];d.push.apply(d,b);a=new (Function.bind.apply(a,d));c&&h(a,c.prototype);return a};return f.apply(null,arguments)}function g(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function h(a,b){h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){a.__proto__=b;return a};return h(a,
b)}function k(a){k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)};return k(a)}function t(){t=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return t.apply(this,arguments)}function l(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(a){}return!1}
function w(a,b){var c={method:"GET",mode:"cors",credentials:"same-origin",signal:b,headers:new self.Headers(t({},a.headers))};a.rangeEnd&&c.headers.set("Range","bytes="+a.rangeStart+"-"+String(a.rangeEnd-1));return c}function r(a,b){return new self.Request(a.url,b)}b.r(a);b.d(a,"fetchSupported",function(){return l});var C=b("./src/polyfills/number.ts"),z=b("./src/loader/load-stats.ts"),A=b("./src/demux/chunk-cache.ts");c=function(){function a(b){this.context=this.controller=this.response=this.request=
this.requestTimeout=this.fetchSetup=void 0;this.callbacks=this.config=null;this.stats=void 0;this.loader=null;this.fetchSetup=b.fetchSetup||r;this.controller=new self.AbortController;this.stats=new z.LoadStats}var b=a.prototype;b.destroy=function(){this.loader=this.callbacks=null;this.abortInternal()};b.abortInternal=function(){var a=this.response;if(!a||!a.ok)this.stats.aborted=!0,this.controller.abort()};b.abort=function(){var a;this.abortInternal();if(null!==(a=this.callbacks)&&void 0!==a&&a.onAbort)this.callbacks.onAbort(this.stats,
this.context,this.response)};b.load=function(a,b,c){var d=this,e=this.stats;if(e.loading.start)throw Error("Loader can only be used once.");e.loading.start=self.performance.now();var f=w(a,this.controller.signal),k=c.onProgress,g="arraybuffer"===a.responseType,h=g?"byteLength":"length";this.context=a;this.config=b;this.callbacks=c;this.request=this.fetchSetup(a,f);self.clearTimeout(this.requestTimeout);this.requestTimeout=self.setTimeout(function(){d.abortInternal();c.onTimeout(e,a,d.response)},b.timeout);
self.fetch(this.request).then(function(c){d.response=d.loader=c;if(!c.ok)throw new q(c.statusText||"fetch, bad network response",c.status,c);e.loading.first=Math.max(self.performance.now(),e.loading.start);e.total=parseInt(c.headers.get("Content-Length")||"0");return k&&Object(C.isFiniteNumber)(b.highWaterMark)?d.loadProgressively(c,e,a,b.highWaterMark,k):g?c.arrayBuffer():c.text()}).then(function(f){var g=d.response;self.clearTimeout(d.requestTimeout);e.loading.end=Math.max(self.performance.now(),
e.loading.first);e.loaded=e.total=f[h];var l={url:g.url,data:f};k&&!Object(C.isFiniteNumber)(b.highWaterMark)&&k(e,a,f,g);c.onSuccess(l,e,a,g)}).catch(function(b){self.clearTimeout(d.requestTimeout);if(!e.aborted)c.onError({code:!b?0:b.code||0,text:!b?null:b.message},a,b?b.details:null)})};b.getCacheAge=function(){var a=null;this.response&&(a=(a=this.response.headers.get("age"))?parseFloat(a):null);return a};b.loadProgressively=function(a,b,c,d,e){void 0===d&&(d=0);var f=new A["default"],k=a.body.getReader();
return function ca(){return k.read().then(function(k){if(k.done)return f.dataLength&&e(b,c,f.flush(),a),Promise.resolve(new ArrayBuffer(0));k=k.value;var g=k.length;b.loaded+=g;g<d||f.dataLength?(f.push(k),f.dataLength>=d&&e(b,c,f.flush(),a)):e(b,c,k,a);return ca()}).catch(function(){return Promise.reject()})}()};return a}();var q=function(a){function b(c,d,e){c=a.call(this,c)||this;c.code=void 0;c.details=void 0;c.code=d;c.details=e;return c}e(b,a);return b}(d(Error));a["default"]=c},"./src/utils/logger.ts":function(c,
a,b){function e(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];c.forEach(function(b){var c=h,d;d=a[b]?a[b].bind(a):(d=self.console[b])?d.bind(self.console,"["+b+"] >"):f;c[b]=d})}function d(a){if(self.console&&!0===a||"object"===typeof a){e(a,"debug","log","info","warn","error");try{h.log()}catch(b){h=g}}else h=g}b.r(a);b.d(a,"enableLogs",function(){return d});b.d(a,"logger",function(){return k});var f=function(){},g={trace:f,debug:f,log:f,warn:f,info:f,error:f},
h=g,k=h},"./src/utils/mediakeys-helper.ts":function(c,a,b){b.r(a);b.d(a,"KeySystems",function(){return e});b.d(a,"requestMediaKeySystemAccess",function(){return d});var e;(function(a){a.WIDEVINE="com.widevine.alpha";a.PLAYREADY="com.microsoft.playready"})(e||(e={}));var d;d="undefined"!==typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(c,a,b){function e(){return self.MediaSource||
self.WebKitMediaSource}b.r(a);b.d(a,"getMediaSource",function(){return e})},"./src/utils/mp4-tools.ts":function(c,a,b){function e(a){return String.fromCharCode.apply(null,a)}function d(a,b){var c=a[b]<<8|a[b+1];return 0>c?65536+c:c}function f(a,b){var c=g(a,b);return 0>c?4294967296+c:c}function g(a,b){return a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3]}function h(a,b,c){a[b]=c>>24;a[b+1]=c>>16&255;a[b+2]=c>>8&255;a[b+3]=c&255}function k(a,b){var c=[];if(!b.length)return c;for(var d=a.byteLength,g=0;g<d;){var h=
f(a,g),l=e(a.subarray(g+4,g+8)),h=1<h?g+h:d;l===b[0]&&(1===b.length?c.push(a.subarray(g+8,h)):(g=k(a.subarray(g+8,h),b.slice(1)),g.length&&G.apply(c,g)));g=h}return c}function t(a){for(var b=[],c=a[0],e=8,g=f(a,e),e=e+4,e=(0===c?e+8:e+16)+2,k=a.length+0,h=d(a,e),e=e+2,l=0;l<h;l++){var n=f(a,e),e=e+4,m=n&2147483647;if(1===(n&2147483648)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;n=f(a,e);e+=4;b.push({referenceSize:m,subsegmentDuration:n,info:{duration:n/g,start:k,
end:k+m-1}});k+=m;e+=4}return{earliestPresentationTime:0,timescale:g,version:c,referencesCount:h,references:b}}function l(a){for(var b=[],c=k(a,["moov","trak"]),d=0;d<c.length;d++){var g=c[d],h=k(g,["tkhd"])[0];if(h){var l=h[0],l=0===l?12:20,h=f(h,l),n=k(g,["mdia","mdhd"])[0];if(n&&(l=n[0],l=0===l?12:20,l=f(n,l),n=k(g,["mdia","hdlr"])[0]))if(n=e(n.subarray(8,12)),n={soun:p.ElementaryStreamTypes.AUDIO,vide:p.ElementaryStreamTypes.VIDEO}[n]){var g=k(g,["mdia","minf","stbl","stsd"])[0],m=void 0;g&&(m=
e(g.subarray(12,16)));b[h]={timescale:l,type:n};b[n]={timescale:l,id:h,codec:m}}}}k(a,["moov","mvex","trex"]).forEach(function(a){var c=f(a,4);if(c=b[c])c.default={duration:f(a,12),flags:f(a,20)}});return b}function w(a,b){return k(b,["moof","traf"]).reduce(function(b,c){var d=k(c,["tfdt"])[0],e=d[0],g=k(c,["tfhd"]).reduce(function(b,c){var g=f(c,4);if(g=a[g]){var k=f(d,4);1===e&&(k*=Math.pow(2,32),k+=f(d,8));g=k/(g.timescale||9E4);if(isFinite(g)&&(null===b||g<b))return g}return b},null);return null!==
g&&isFinite(g)&&(null===b||g<b)?g:b},null)||0}function r(a,b){for(var c=0,d=0,e=0,g=k(a,["moof","traf"]),h=0;h<g.length;h++){var l=g[h],n=k(l,["tfhd"])[0],m=f(n,4);if(m=b[m]){var r=m.default,q=f(n,0)|(null===r||void 0===r?NaN:r.flags),r=null===r||void 0===r?void 0:r.duration;q&8&&(r=q&2?f(n,12):f(n,8));n=m.timescale||9E4;l=k(l,["trun"]);for(q=0;q<l.length;q++)c=C(l[q]),!c&&r&&(c=f(l[q],4),c*=r),m.type===p.ElementaryStreamTypes.VIDEO?d+=c/n:m.type===p.ElementaryStreamTypes.AUDIO&&(e+=c/n)}}if(0===
d&&0===e){d=0;e=k(a,["sidx"]);for(g=0;g<e.length;g++)h=t(e[g]),null!==h&&(void 0!==h&&h.references)&&(d+=h.references.reduce(function(a,b){return a+b.info.duration||0},0));return d}return d?d:e}function C(a){var b=f(a,0),c=8;b&1&&(c+=4);b&4&&(c+=4);for(var d=0,e=f(a,4),g=0;g<e;g++){if(b&256)var k=f(a,c),d=d+k,c=c+4;b&512&&(c+=4);b&1024&&(c+=4);b&2048&&(c+=4)}return d}function z(a,b,c){k(b,["moof","traf"]).forEach(function(b){k(b,["tfhd"]).forEach(function(d){d=f(d,4);if(d=a[d]){var e=d.timescale||
9E4;k(b,["tfdt"]).forEach(function(a){var b=a[0],d=f(a,4);0===b?(d-=c*e,d=Math.max(d,0),h(a,4,d)):(d*=Math.pow(2,32),d+=f(a,8),d-=c*e,d=Math.max(d,0),b=Math.floor(d%(F+1)),h(a,4,Math.floor(d/(F+1))),h(a,8,b))})}})})}function A(a){var b={valid:null,remainder:null},c=k(a,["moof"]);if(c){if(2>c.length)return b.remainder=a,b}else return b;c=c[c.length-1];b.valid=Object(v.sliceUint8)(a,0,c.byteOffset-8);b.remainder=Object(v.sliceUint8)(a,c.byteOffset-8);return b}function q(a,b){var c=new Uint8Array(a.length+
b.length);c.set(a);c.set(b,a.length);return c}function u(a,b){var c=[],d=b.samples,e=b.timescale,h=b.id,l=!1;k(d,["moof"]).map(function(n){var r=n.byteOffset-8;k(n,["traf"]).map(function(n){var t=k(n,["tfdt"]).map(function(a){var b=a[0],c=f(a,4);1===b&&(c*=Math.pow(2,32),c+=f(a,8));return c/e})[0];void 0!==t&&(a=t);return k(n,["tfhd"]).map(function(t){var q=f(t,4),w=f(t,0)&16777215,u=0,v=0!==(w&16),z=0,y=0!==(w&32),x=8;q===h&&(0!==(w&1)&&(x+=8),0!==(w&2)&&(x+=4),0!==(w&8)&&(u=f(t,x),x+=4),v&&(z=f(t,
x),x+=4),y&&(x+=4),"video"===b.type&&(l=D(b.codec)),k(n,["trun"]).map(function(k){var h=k[0],n=f(k,0)&16777215,t=0!==(n&1),q=0,w=0!==(n&4),v=0!==(n&256),E=0,y=0!==(n&512),x=0,A=0!==(n&1024),n=0!==(n&2048),C=0,D=f(k,4),B=8;t&&(q=f(k,B),B+=4);w&&(B+=4);t=q+r;for(q=0;q<D;q++){v?(E=f(k,B),B+=4):E=u;y?(x=f(k,B),B+=4):x=z;A&&(B+=4);n&&(C=0===h?f(k,B):g(k,B),B+=4);if(b.type===p.ElementaryStreamTypes.VIDEO)for(w=0;w<x;){var F=f(d,t),t=t+4,G=d[t]&31;if(l?39===G||40===G:6===G)G=d.subarray(t,t+F),m(G,a+C/e,
c);t+=F;w+=F+4}a+=E/e}}))})})});return c}function D(a){if(!a)return!1;var b=a.indexOf(".");a=0>b?a:a.substring(0,b);return"hvc1"===a||"hev1"===a||"dvh1"===a||"dvhe"===a}function m(a,b,c){for(var e=a.byteLength,g=[],k=1;k<e-2;)0===a[k]&&0===a[k+1]&&3===a[k+2]?(g.push(k+2),k+=2):k++;if(0!==g.length){for(var e=e-g.length,h=new Uint8Array(e),l=0,k=0;k<e;l++,k++)l===g[0]&&(l++,g.shift()),h[k]=a[l];a=h}g=0;g++;l=k=0;e=!1;for(h=0;g<a.length;){k=0;do{if(g>=a.length)break;h=a[g++];k+=h}while(255===h);l=0;
do{if(g>=a.length)break;h=a[g++];l+=h}while(255===h);h=a.length-g;if(!e&&4===k&&g<a.length){if(e=!0,181===a[g++]&&(h=d(a,g),g+=2,49===h&&(h=f(a,g),g+=4,1195456820===h&&(h=a[g++],3===h)))){var l=a[g++],n=31&l,m=64&l,n=m?2+3*n:0,r=new Uint8Array(n);if(m){r[0]=l;for(l=1;l<n;l++)r[l]=a[g++]}c.push({type:h,payloadType:k,pts:b,bytes:r})}}else if(5===k&&l<h){if(e=!0,16<l){h=[];for(m=0;16>m;m++)n=a[g++].toString(16),h.push(1==n.length?"0"+n:n),(3===m||5===m||7===m||9===m)&&h.push("-");l-=16;m=new Uint8Array(l);
for(n=0;n<l;n++)m[n]=a[g++];c.push({payloadType:k,pts:b,uuid:h.join(""),userData:Object(x.utf8ArrayToStr)(m),userDataBytes:m})}}else if(l<h)g+=l;else if(l>h)break}}function y(a){var b=a[0],c="",d="",g=0,k=0,h=0,l=0,n=0,m=0;if(0===b){for(;"\x00"!==e(a.subarray(m,m+1));)c+=e(a.subarray(m,m+1)),m+=1;c+=e(a.subarray(m,m+1));for(m+=1;"\x00"!==e(a.subarray(m,m+1));)d+=e(a.subarray(m,m+1)),m+=1;d+=e(a.subarray(m,m+1));g=f(a,12);k=f(a,16);l=f(a,20);n=f(a,24);m=28}else if(1===b){m+=4;g=f(a,m);m+=4;h=f(a,m);
m+=4;l=f(a,m);m+=4;h=Math.pow(2,32)*h+l;Number.isSafeInteger(h)||(h=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box"));l=f(a,m);m+=4;n=f(a,m);for(m+=4;"\x00"!==e(a.subarray(m,m+1));)c+=e(a.subarray(m,m+1)),m+=1;c+=e(a.subarray(m,m+1));for(m+=1;"\x00"!==e(a.subarray(m,m+1));)d+=e(a.subarray(m,m+1)),m+=1;d+=e(a.subarray(m,m+1));m+=1}a=a.subarray(m,a.byteLength);return{schemeIdUri:c,value:d,timeScale:g,presentationTime:h,
presentationTimeDelta:k,eventDuration:l,id:n,payload:a}}b.r(a);b.d(a,"RemuxerTrackIdConfig",function(){return J});b.d(a,"bin2str",function(){return e});b.d(a,"readUint16",function(){return d});b.d(a,"readUint32",function(){return f});b.d(a,"readSint32",function(){return g});b.d(a,"writeUint32",function(){return h});b.d(a,"findBox",function(){return k});b.d(a,"parseSegmentIndex",function(){return t});b.d(a,"parseInitSegment",function(){return l});b.d(a,"getStartDTS",function(){return w});b.d(a,"getDuration",
function(){return r});b.d(a,"computeRawDurationFromSamples",function(){return C});b.d(a,"offsetStartDTS",function(){return z});b.d(a,"segmentValidRange",function(){return A});b.d(a,"appendUint8Array",function(){return q});b.d(a,"parseSamples",function(){return u});b.d(a,"parseSEIMessageFromNALu",function(){return m});b.d(a,"parseEmsg",function(){return y});var v=b("./src/utils/typed-array.ts"),p=b("./src/loader/fragment.ts"),x=b("./src/demux/id3.ts"),F=Math.pow(2,32)-1,G=[].push,J={video:1,audio:2,
id3:3,text:4}},"./src/utils/texttrack-utils.ts":function(c,a,b){function e(a,b){var c;try{c=new Event("addtrack")}catch(d){c=document.createEvent("Event"),c.initEvent("addtrack",!1,!1)}c.track=a;b.dispatchEvent(c)}function d(a,b){var c=a.mode;"disabled"===c&&(a.mode="hidden");if(a.cues&&!a.cues.getCueById(b.id))try{if(a.addCue(b),!a.cues.getCueById(b.id))throw Error("addCue is failed for: "+b);}catch(d){t.logger.debug("[texttrack-utils]: "+d);var e=new self.TextTrackCue(b.startTime,b.endTime,b.text);
e.id=b.id;a.addCue(e)}"disabled"===c&&(a.mode=c)}function f(a){var b=a.mode;"disabled"===b&&(a.mode="hidden");if(a.cues)for(var c=a.cues.length;c--;)a.removeCue(a.cues[c]);"disabled"===b&&(a.mode=b)}function g(a,b,c,d){var e=a.mode;"disabled"===e&&(a.mode="hidden");if(a.cues&&0<a.cues.length){b=k(a.cues,b,c);for(c=0;c<b.length;c++)(!d||d(b[c]))&&a.removeCue(b[c])}"disabled"===e&&(a.mode=e)}function h(a,b){if(b<a[0].startTime)return 0;var c=a.length-1;if(b>a[c].endTime)return-1;for(var d=0,e=c;d<=
e;){var f=Math.floor((e+d)/2);if(b<a[f].startTime)e=f-1;else if(b>a[f].startTime&&d<c)d=f+1;else return f}return a[d].startTime-b<b-a[e].startTime?d:e}function k(a,b,c){var d=[],e=h(a,b);if(-1<e)for(var f=a.length;e<f;e++){var g=a[e];if(g.startTime>=b&&g.endTime<=c)d.push(g);else if(g.startTime>c)break}return d}b.r(a);b.d(a,"sendAddTrackEvent",function(){return e});b.d(a,"addCueToTrack",function(){return d});b.d(a,"clearCurrentCues",function(){return f});b.d(a,"removeCuesInRange",function(){return g});
b.d(a,"getCuesInRange",function(){return k});var t=b("./src/utils/logger.ts")},"./src/utils/time-ranges.ts":function(c,a,b){b.r(a);a["default"]={toString:function(a){for(var b="",c=a.length,g=0;g<c;g++)b+="["+a.start(g).toFixed(3)+","+a.end(g).toFixed(3)+"]";return b}}},"./src/utils/timescale-conversion.ts":function(c,a,b){function e(a,b,c,d){void 0===c&&(c=1);void 0===d&&(d=!1);a=a*b*c;return d?Math.round(a):a}function d(a,b,c,d){void 0===c&&(c=1);void 0===d&&(d=!1);return e(a,b,1/c,d)}function f(a,
b){void 0===b&&(b=!1);return e(a,1E3,1/h,b)}function g(a,b){void 0===b&&(b=1);return e(a,h,1/b)}b.r(a);b.d(a,"toTimescaleFromBase",function(){return e});b.d(a,"toTimescaleFromScale",function(){return d});b.d(a,"toMsFromMpegTsClock",function(){return f});b.d(a,"toMpegTsClockFromTimescale",function(){return g});var h=9E4},"./src/utils/typed-array.ts":function(c,a,b){function e(a,b,c){return Uint8Array.prototype.slice?a.slice(b,c):new Uint8Array(Array.prototype.slice.call(a,b,c))}b.r(a);b.d(a,"sliceUint8",
function(){return e})},"./src/utils/xhr-loader.ts":function(c,a,b){b.r(a);var e=b("./src/utils/logger.ts"),d=b("./src/loader/load-stats.ts"),f=/^age:\s*[\d.]+\s*$/m;c=function(){function a(b){this.retryDelay=this.retryTimeout=this.requestTimeout=this.xhrSetup=void 0;this.callbacks=this.config=null;this.context=void 0;this.loader=null;this.stats=void 0;this.xhrSetup=b?b.xhrSetup:null;this.stats=new d.LoadStats;this.retryDelay=0}var b=a.prototype;b.destroy=function(){this.callbacks=null;this.abortInternal();
this.config=this.loader=null};b.abortInternal=function(){var a=this.loader;self.clearTimeout(this.requestTimeout);self.clearTimeout(this.retryTimeout);a&&(a.onreadystatechange=null,a.onprogress=null,4!==a.readyState&&(this.stats.aborted=!0,a.abort()))};b.abort=function(){var a;this.abortInternal();if(null!==(a=this.callbacks)&&void 0!==a&&a.onAbort)this.callbacks.onAbort(this.stats,this.context,this.loader)};b.load=function(a,b,c){if(this.stats.loading.start)throw Error("Loader can only be used once.");
this.stats.loading.start=self.performance.now();this.context=a;this.config=b;this.callbacks=c;this.retryDelay=b.retryDelay;this.loadInternal()};b.loadInternal=function(){var a=this.config,b=this.context;if(a){var c=this.loader=new self.XMLHttpRequest,d=this.stats;d.loading.first=0;d.loaded=0;d=this.xhrSetup;try{if(d)try{d(c,b.url)}catch(e){c.open("GET",b.url,!0),d(c,b.url)}c.readyState||c.open("GET",b.url,!0);var f=this.context.headers;if(f)for(var g in f)c.setRequestHeader(g,f[g])}catch(h){this.callbacks.onError({code:c.status,
text:h.message},b,c);return}b.rangeEnd&&c.setRequestHeader("Range","bytes="+b.rangeStart+"-"+(b.rangeEnd-1));c.onreadystatechange=this.readystatechange.bind(this);c.onprogress=this.loadprogress.bind(this);c.responseType=b.responseType;self.clearTimeout(this.requestTimeout);this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout);c.send()}};b.readystatechange=function(){var a=this.context,b=this.loader,c=this.stats;if(a&&b){var d=b.readyState,f=this.config;if(!c.aborted&&2<=d)if(self.clearTimeout(this.requestTimeout),
0===c.loading.first&&(c.loading.first=Math.max(self.performance.now(),c.loading.start)),4===d)if(b.onreadystatechange=null,b.onprogress=null,d=b.status,200<=d&&300>d){if(c.loading.end=Math.max(self.performance.now(),c.loading.first),"arraybuffer"===a.responseType?(f=b.response,d=f.byteLength):(f=b.responseText,d=f.length),c.loaded=c.total=d,this.callbacks&&((d=this.callbacks.onProgress)&&d(c,a,f,b),this.callbacks))this.callbacks.onSuccess({url:b.responseURL,data:f},c,a,b)}else c.retry>=f.maxRetry||
400<=d&&499>d?(e.logger.error(d+" while loading "+a.url),this.callbacks.onError({code:d,text:b.statusText},a,b)):(e.logger.warn(d+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,f.maxRetryDelay),c.retry++);else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),
f.timeout)}};b.loadtimeout=function(){e.logger.warn("timeout while loading "+this.context.url);var a=this.callbacks;a&&(this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader))};b.loadprogress=function(a){var b=this.stats;b.loaded=a.loaded;a.lengthComputable&&(b.total=a.total)};b.getCacheAge=function(){var a=null;this.loader&&f.test(this.loader.getAllResponseHeaders())&&(a=(a=this.loader.getResponseHeader("age"))?parseFloat(a):null);return a};return a}();a["default"]=c}})["default"]});
"use strict";var xa=this&&this.__extends||function(){var c=function(a,b){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return c(a,b)};return function(a,b){function e(){this.constructor=a}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");c(a,b);a.prototype=null===b?Object.create(b):(e.prototype=b.prototype,
new e)}}();h.__esModule=!0;h.mem_readsi=h.mem_readsi_str=h.mem_readss_str=h.mem_readss=h.mem_readsc_str=h.mem_readul=h.mem_readl=h.mem_readui=h.mem_readi=h.mem_readu16=h.mem_read16=h.mem_readu8=h.mem_read8=h.mem_readn_str=h.mem_putlong=h.mem_putint=h.mem_putshort=h.mem_putchar=h.pos_data=h.pos_catsi=h.pos_catn=h.mem_readn=h.mem_read=h.Mem=h.mem_db=h.Tim=h.tim_db=h.Modalg=h.modalg_db=h.Hint=h.hint_db=h.El=h.el_db=h.Clip=h.clip_db=h.dm_ginp_upd=h.inpg_sval=h.inpg_set_val_pos=h.search_set=h.inpg_pos_set=
h.inpg_pos_get=h.inpg_knav=h.Inpg=h.DM_ginp_esc=h.DM_ginp_blur=h.DM_ginp_focus=h.DM_ginp_live=h.DM_ginp_exec=h.DM_ginp_init=h.ntbl_db=void 0;h.Timg=h.timg_db=h.Pos=h.pos_db=h.dm_gcard_parse=h.cardg_parse=h.Cardg=h.cardg_db=h.Mod=h.mod_db=h.His=h.Err=h.err_db=h.Tvcnl=h.tvcnl_db=h.Kbd=h.kbd_db=h.dmi_play_prev_cb=h.dmi_play_next_cb=h.dmi_play_status_cb=h.dmi_play_pause_cb=h.dmi_play_play_cb=h.dmi_play_add_cb=h.dmi_play_init=h.Play=h.dmi_play_cfg=h.play_db=h.Loadg=h.Html=h.html_db=h.Ctxmg=h.ctxmg_db=
h.Evt=h.evt_db=h.Evt_db=h.Ntbl=h.tblg=h.tblg_db=h.Txtg=h.txtg_db=h.Strg=h.strg_db=h.Playg=h.playg_db=h.Play_std=h.play_std_db=h.Elg=h.elg_db=h.Win=h.win_db=void 0;h.debug=h.Rect=h.rect_db=h.App=h.app_db=h.Progressg=h.progressg_db=h.Urlq=h.urlq_db=h.Anim=h.dmi_anim_back_op=h.anim_db=h.Cont=h.dmi_cont_init_cb=h.cont_db=h.Fun=h.fun_db=h.Col=h.col_db=h.Bg=h.bg_db=void 0;(function(c){})(h.ntbl_db||(h.ntbl_db={}));h.DM_ginp_init=0;h.DM_ginp_exec=1;h.DM_ginp_live=2;h.DM_ginp_focus=3;h.DM_ginp_blur=4;h.DM_ginp_esc=
5;var Z=function(){function c(){this.val_el=this.hint=this.field=null;this.pos=0;this.val="";this.placeholder_el=this.placeholder=null;this.el=document.getElementById("dm_search");this.microphone=this.file=this.ud_par=this.evt=null;this.is_click=this.is_focus=this.is_evtch=this.is_init=!1;this.ln_pos=0;this.ln_len=1}c.init=function(){c.cur.el=document.getElementById("dm_search");c.microphone={speech_recognition:window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||
window.msSpeechRecognition}};c.prototype.imp=function(a){this.val=$(a);this.placeholder=$(a);this.evt=oa(a)};c.prototype.focus=function(a){var b=document.getElementById("dm_menu_bottom"),c=document.getElementById("dm_menu_top");if(!1===this.is_focus)return 0;this.is_evtch=!1;this.is_focus=!0;a&&(this.is_click=!0);ba(this,this.pos);this.el.className="searchg inpg act";b&&(b.style.display="none");da.cur.set_meta_theme_color(16777215);c.className="menug top bot act";this.hint&&this.hint.open();this.exec_evt(h.DM_ginp_focus)};
c.prototype.blur=function(a){if(this.is_focus)return this.field.blur(),0;dm_search.className="searchg inpg";dm_menu_top.className="menug top bot";da.cur.set_meta_theme_color(16777215);this.pos=0;this.is_evtch=this.is_click=!1;this.hint&&this.hint.close();this.exec_evt(h.DM_ginp_blur);window.setTimeout(function(){var a=document.getElementById("dm_menu_bottom");a&&(a.style.display="block")},200)};c.prototype.line_pos=function(a){if(0<a){if(this.ln_pos>=this.ln_len)return-1;this.ln_pos++}else{if(1>this.ln_pos)return-1;
this.ln_pos--}a=50*this.ln_pos;this.field.scrollTo(0,a);this.val_el.style.marginTop=-a+"px";return 0};c.prototype.set_placeholder=function(a){var b=this.field;a&&(this.placeholder=a);b.placeholder=this.placeholder};c.prototype.get_val=function(){return this.val};c.prototype.nval=function(){return this.val?this.val.length:0};c.prototype.init_microphone=function(){var a=this,b,e,d=this.el.children[0];if(c.microphone.speech_recognition){if(b=document.createElement("div"),e=document.createElement("i"),
b.className="i24 microphone",b.appendChild(e),b.onclick=function(){a.microphone_exec()},d.appendChild(b),e=new c.microphone.speech_recognition)e.lang="ru-RU",e.onresult=function(b){a.put_val(" ",b.results[b.results.length-1][0].transcript,"",null)},e.onend=function(b){a.microphone_close(1)},e.onspeechend=function(){a.microphone_close(0)},e.onstart=function(){b.className=b.className.replace(" act","_process act")}}else e=b=null;this.microphone={el:b,recognition:e,is_work:0}};c.prototype.microphone_close=
function(a){var b=this.microphone.recognition,c=this.microphone.el;this.set_placeholder(this.placeholder);this.placeholder=null;c.className=c.className.replace("_process","").replace(" act","");a?b.abort():b.stop();this.microphone.is_work=0};c.prototype.microphone_exec=function(){var a;if(1===this.microphone.is_work)return this.microphone_close(0);a=this.microphone.el;this.microphone.recognition.start();this.microphone.is_work=1;this.placeholder=this.field.placeholder;this.set_placeholder("\u0413\u043e\u0432\u043e\u0440\u0438\u0442\u0435...");
a.className+=" act";return 0};c.prototype.init_file=function(){var a=this.el.children[0],b,c,d,f;null===this.file&&(this.file={});if("undefined"===typeof this.file.is_show||!this.file.is_show)return 0;this.file.is_multiple=this.file.is_multiple||0;if("object"!==typeof this.file.el){d=document.createElement("label");c=document.createElement("input");c.type="file";c.multiple=this.file.is_multiple;b=document.createElement("div");f=document.createElement("i");b.className="i24 upload";b.appendChild(f);
b.appendChild(d);d.appendChild(c);a.appendChild(b);var g=this;c.addEventListener("change",function(){if(0<this.files.length){var a=this.files[0];console.log(this.files[0]);var b=(a.size/1024).toFixed(2)+" kb";g.set_val(a.name,b,null);var c=new FileReader;c&&(this.file.ctx=c,c.onload=function(c){this;a.name;b;[a.type,c.originalTarget.result]},c.readAsBinaryString(a))}},!1);this.file.el=b}this.file.ctx=null;return 0};c.prototype.set_val=function(a,b,c){Ea(this,a,b,c,1)};c.prototype.put_val=function(a,
b,c,d){var f=this.get_val(),g=f.length,h;h=0<this.pos?f.substring(0,this.pos):"";h+=b;this.pos<g&&(h+=a);h+=f.substring(this.pos,g);Ea(this,h,c,d,1);this.pos+=b.length};c.prototype.exec_evt=function(a){var b,c;if(!this.evt)return-1;c=ya.find(this.evt);b=this.get_val();return c(this,this.ud_par,a,b)};c.prototype.creat=function(){if(!this.field){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("textarea");this.el||(this.el=document.createElement("div"));this.el.className=
"searchg inpg";a.className="a";b.className="f";this.el.insertBefore(b,this.el.firstChild);b.appendChild(c);this.el.insertBefore(a,b);this.field=c}};c.prototype.init=function(){var a=this,b=this.field;if("number"!==typeof this.is_init||0===this.is_init)b.onfocus=function(b){a.is_focus=!0;return a.focus(b)},b.onblur=function(b){a.is_focus=!1;return a.blur(b)},b.onkeypress=function(a){return!1},b.onkeydown=function(b){return bb(a,b)},b.onkeyup=function(b){return b.ctrlKey&&13===b.keyCode?a.exec_evt(h.DM_ginp_exec):
!1},b.oninput=function(b){a.is_evtch&&a.set_val(b.data,"",null)},b.onpaste=function(b){var c=a.pos;b=(b.clipboardData||window.clipboardData).getData("Text");var f=a.get_val(),g=f.substring(0,c),g=g+b+f.substring(c,f.length),c=c+b.length;a.set_val(g,"",null);ba(a,c);return!1},b.onclick=function(b){a.is_click?b=cb(a):(b=a.get_val(),a.is_click=!0);ba(a,b)},b.setAttribute("autocomplete","off"),b.setAttribute("autoCapitalize","off"),b.setAttribute("autocorrect","off"),b.setAttribute("spellCheck","off"),
b.setAttribute("maxlength","2048"),b.bk=null,this.is_init=!0,this.is_click=this.is_focus=!1;"undefined"===typeof this.hint&&(this.hint=null);this.hint=null;this.exec_evt(h.DM_ginp_init);null==this.val_el&&(this.val_el=document.createElement("div"),this.val_el.className="val",b.parentElement.appendChild(this.val_el),b._notice_el=document.createElement("div"),b._notice_el.className="info",b.parentElement.appendChild(b._notice_el));this.init_microphone();this.init_file();this.pos=this.val.length;Ka(this,
this.val,null,null);ba(this,this.pos);this.set_placeholder(null);setTimeout(function(){},1500)};c.main_evt=function(a,b,c,d){switch(c){case h.DM_ginp_init:a.hint&&(b=new ea,b.is_act_res=!0,b.click_res_cb=null,b.is_find_live=!1,b.filter=!0,b.data=[],a.hint=b,b.init())}return 0};c.cur=new c;c.bk=null;c.microphone=null;return c}();h.Inpg=Z;h.inpg_knav=bb;h.inpg_pos_get=cb;h.inpg_pos_set=ba;h.search_set=Da;h.inpg_set_val_pos=Ea;h.inpg_sval=Ka;h.dm_ginp_upd=db;(function(c){})(h.clip_db||(h.clip_db={}));
var Va=function(){function c(){}c.paste_str=function(){return navigator.clipboard.readText()};c.paste=function(){return navigator.clipboard.readText()};c.copy_str=function(a){navigator.clipboard.writeText(a)};c.copy=function(a){navigator.clipboard.writeText(a)};return c}();h.Clip=Va;(function(c){})(h.el_db||(h.el_db={}));T=function(){return function(){}}();h.El=T;(function(c){})(h.hint_db||(h.hint_db={}));var ea=function(){function c(){this.pel=null;this.cont=new F;this.ctx=this._act=this._pos=null;
this.query="";this.is_find_live=this.is_act_res=this.is_init=!1;this.click_res_cb=null;this.filter=!1;this.data=[]}c.parse=function(a){c.gog_qurl=$(a);c.gog_qurl_js=$(a)};c.prototype.close=function(){this._act=!1;var a=this.gpos();a&&(a.className="");this._pos=null;this.pel.close();return 0};c.prototype.spos_null=function(){var a=this.gpos();a&&(a.className="");this._pos=null};c.prototype.spos=function(a){var b=this.cont.node.childNodes.length-1,c;null===this._pos?this._pos=c=a?b:0:(c=this._pos,this.spos_null(),
a?0===c?c=b:c--:c===b?c=0:c++);this._pos=c;this.gpos().className="act";return!1};c.prototype.init=function(){this.pel||(this.pel=Wa.cur);this.ctx=null;this.cont.node.onmousedown=function(a){a.preventDefault()};this.pel.el.append(this.cont);this.cont.cls_add("cardg","max_w");this.close();this.is_init=!0;return this};c.prototype.select=function(a){var b=this.gpos(),c;b&&(b.className="",c=b.children[a].click(),this._pos=null);return c};c.prototype.open=function(){this._act=!0;this.pel.open(new F(this.cont.node));
return this};c.prototype.gpos=function(){var a=this.cont.node.childNodes,b=this._pos,c;null!==b&&(c=a[b]);return c};c.prototype.knav=function(a){var b=null!==this._pos,c;if(this._act)switch(c=0,73<a&&(76>a&&!b)&&(a=0),a){case 38:case 75:this.spos(1);break;case 9:case 40:case 74:this.spos(0);break;case 13:b&&this.select(13===a);break;case 27:b?this.spos_null():this.close();break;default:c=!b}else c=1;return c};c.prototype.els=function(){var a,b,c,d,f;a=this.query;""!==a&&(a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,
"\\$&"));f=RegExp(a,"i");c=a.length;this.open();this.cont.set("");this._pos=null;this.cont.node.scrollTop=0;"number"!==typeof this.filter&&(this.filter=!1);this.filter&&0===c&&(c=1E6);for(b=0;b<this.data.length;b++)if(a=this.data[b],null!=a){if(this.filter&&c){if(d=a.data.title.search(f),-1===d)continue}else d=-1;a.exec(d,c);this.cont.append(a.el)}return 0};c.web=function(a,b,c){b.data=Array(c[1].length);for(a=0;a<c[1].length;a++)b.data[a]=c[0]===c[1][a]?null:{id:a,title:c[1][a]};b.els();return 0};
c.init=function(){c.cur=new c};c.web_evt=function(a,b,e,d){var f,g;d.length&&(d=d.trim());b=encodeURIComponent(d);switch(e){case h.DM_ginp_init:g=new c;g.is_act_res=!0;g.click_res_cb=null;g.is_find_live=!1;g.filter=!0;g.data=[];a.hint=g;g.init();Ua(null,act_mod_id,g);a.hint=g;break;case h.DM_ginp_exec:if(!d.length)break;e=c.gog_qurl+b;window.open(e,"_blank");break;case h.DM_ginp_live:if(!d.length)break;e=c.gog_qurl_js+"__hint_web_cb&q="+b;f=document.createElement("script");f.src=e;g=a.hint;g.query=
d;window.__hint_web_cb=function(b){c.web(a,g,b);document.head.removeChild(f)};document.head.appendChild(f);g.ctx=f}return 0};c.cur=null;c.gog_qurl=null;c.gog_qurl_js=null;return c}();h.Hint=ea;(function(c){})(h.modalg_db||(h.modalg_db={}));var Wa=function(){function c(){this.is_open=!1;this.scroll_pos=0}c.init=function(){c.scroll=F.creat("dmi_scroll");null==c.scroll.node&&(c.scroll=new F,c.scroll.node.id="dmi_scroll",aa.body.append(c.scroll));c.cur.init();window.addEventListener("click",function(a){a=
F.creat(a.target);var b=c.cur;b.is_open&&!b.cont.exists(a)&&b.close()})};c.prototype.init=function(){this.el=(new F).cls_add("modalg");this.close();c.scroll.prepend(this.el)};c.prototype.open=function(a){this.el.show(!0);this.cont=a;this.is_open=!0;this.scroll_pos=c.scroll.node.scrollTop;for(var b=1;b<c.scroll.node.children.length;b++)c.scroll.node.children[b].className="cfix";a.cls_add("abs","full");return 0};c.prototype.close=function(){this.el.show(!1);this.is_open=!1;for(var a=1;a<c.scroll.node.children.length;a++)c.scroll.node.children[a].className=
"";c.scroll.node.scrollTop=this.scroll_pos};c.cur=new c;return c}();h.Modalg=Wa;(function(c){})(h.tim_db||(h.tim_db={}));var ia=function(){function c(a){this.second=this.min=this.hour=this.sec=0;this.sec=a=null==a?c.get_cur_sec():0;a=new Date(1E3*this.sec);this.hour=a.getHours();this.min=a.getMinutes();this.second=a.getSeconds()}c.get_cur_sec=function(){c.sec=Date.now()/1E3|0;return c.sec};c.prototype.passed=function(){var a=this.sec,b=c.get_cur_sec(),e=b-b%86400,b="",d=new Date(1E3*this.sec);a<e-
86400?(a=("0"+d.getDay()).slice(-2),e=("0"+d.getMonth()).slice(-2),b=("0"+d.getFullYear()).slice(-2),b=a+"/"+e+"/"+b):a<e?(b="\u0412\u0447 ",a=("0"+d.getHours()).slice(-2),e=("0"+d.getMinutes()).slice(-2),b+=a+":"+e):a>e&&(a=("0"+d.getHours()).slice(-2),e=("0"+d.getMinutes()).slice(-2),b=("0"+d.getSeconds()).slice(-2),b=a+":"+e+":"+b);return b};c.prototype.strf=function(a){var b=this.sec?new Date(1E3*this.sec):new Date,c;this.sec=b.getTime()/1E3|0;void 0!==a?"H:I"===a?(a=b.getHours(),c=b.getMinutes(),
b=(10>a?"0"+a:a)+"<span>:</span>"+(10>c?"0"+c:c)):"H I"===a?(a=b.getHours(),c=b.getMinutes(),b=(10>a?"0"+a:a)+"<span> </span>"+(10>c?"0"+c:c)):"H:i:s"===a?(a=b.getHours(),c=b.getMinutes(),b=b.getSeconds(),b=(10>a?"0"+a:a)+":"+(10>c?"0"+c:c)+(10>b?"0"+b:b)):b="":b=b.toString();return b};c.prototype.set_now=function(){this.sec=c.get_cur_sec()};c.sec=0;return c}();h.Tim=ia;(function(c){})(h.mem_db||(h.mem_db={}));var Xa=function(){function c(){this.pos=null;this.sz=0}c.prototype.init=function(a){var b=
new ArrayBuffer(a);this.pos=new DataView(b,0,a);this.sz=a;return this};return c}();h.Mem=Xa;h.mem_read=eb;h.mem_readn=La;h.pos_catn=fb;h.pos_catsi=Ma;h.pos_data=hb;h.mem_putchar=ta;h.mem_putshort=function(c,a){c.pos.setInt16(c.end,a,!0);c.end+=2};h.mem_putint=gb;h.mem_putlong=Na;h.mem_readn_str=Fa;h.mem_read8=Oa;h.mem_readu8=wa;h.mem_read16=ib;h.mem_readu16=oa;h.mem_readi=Pa;h.mem_readui=pa;h.mem_readl=Qa;h.mem_readul=ua;h.mem_readsc_str=Ra;h.mem_readss=jb;h.mem_readss_str=$;h.mem_readsi_str=Sa;h.mem_readsi=
kb;(function(c){})(h.win_db||(h.win_db={}));var aa=function(){function c(){this.par=window;this.sz_w=window.innerWidth;this.sz_h=window.innerHeight;this.is_full=!1}c.init=function(){c.body=F.creat(document.body);M.init();da.init();document.addEventListener("fullscreenchange",function(){var a=c.cur;a.evt(a.is_full?G.infullscreen:G.fullscreen);a.is_full=!a.is_full});document.addEventListener("resize",function(){return c.cur.evt(G.resize)});document.addEventListener("devtoolschange",function(){alert(44)});
document.addEventListener("visibilitychange",function(){c.cur.evt(document.hidden?G.show:G.hide)});window.addEventListener("mousedown",function(a){var b=F.find(a.target);b&&(b.sel(),a.preventDefault())});window.addEventListener("click",function(a){var b=F.find(a.target);b&&(b.exec(),a.preventDefault())});window.addEventListener("dblclick",function(a){var b=F.find(a.target);b&&(b.evt(la.db.dblclick),a.preventDefault())})};c.prototype.resize=function(){c.cur.sz_w=window.innerWidth;c.cur.sz_h=window.innerHeight;
J.cur.resize()};c.prototype.evt=function(a){switch(a){case G.resize:case G.fullscreen:case G.infullscreen:c.cur.resize()}};c.prototype.exit=function(){tizen.application.getCurrentApplication().exit()};c.prototype.fullscreen=function(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()};c.cur=new c;return c}();h.Win=aa;(function(c){})(h.elg_db||(h.elg_db={}));var F=function(){function c(a){this.is_focus=!1;this.key=this.evt_obj=
this.evt_ud=this.evt_fn=null;this.node="string"===typeof a?document.createElement(a):a?a:document.createElement("div");this.node._elg=this;this.cls_add("elg").show(!0)}c.prototype.init=function(a){this.key=a;this.cls_add(a)};c.prototype.cls_add=function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];(a=this.node.classList).add.apply(a,b);return this};c.prototype.cls_rm=function(){for(var a,b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];(a=this.node.classList).remove.apply(a,b);return this};
c.prototype.cls_has=function(a){return this.node.classList.contains(a)};c.prototype.cls_toggle=function(a,b){this.cls_rm(a);this.cls_add(b);return this};c.prototype.cls_toggle_state=function(a,b){a?this.cls_add(b):this.cls_rm(b);return this};c.prototype.set_focus=function(a){this.is_focus=a;return this};c.prototype.show=function(a){a?(this.evt(G.visibility),this.cls_rm("hide")):(this.evt(G.invisibility),this.cls_add("hide"))};c.prototype.prepend=function(a){this.node.insertBefore(a.node,this.node.firstChild)};
c.prototype.append=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(b=0;b<a.length;b++)this.node.appendChild(a[b].node);return this};c.prototype.set=function(a){this.node.innerHTML=a};c.prototype.remove=function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)};c.prototype.exists=function(a){a=a.node;for(var b=this.node;a;){if(a==b)return!0;a=a.parentElement}return!1};c.prototype.sel_set=function(a){-1===a&&(a=!this.cls_has(c.cls_sel));a?this.cls_add(c.cls_sel):
this.cls_rm(c.cls_sel);this.evt(a?la.db.unselect:la.db.select);return this};c.prototype.exec=function(){this.evt(la.db.click)};c.prototype.sel_block=function(){var a=this.first();c.focus_prev=c.focus_cur;c.focus_cur=this;a&&a.sel()};c.prototype.sel=function(){c.focus&&c.focus.node!==this.node&&c.focus.sel_set(0);c.focus=this;this.sel_set(1);return this};c.prototype.first=function(){var a=this.node.firstElementChild;return a&&a._elg?a._elg:null};c.prototype.evt_set=function(a,b){this.evt_obj=a;this.evt_fn=
b};c.prototype.evt=function(a){var b,c=this.evt_obj,d=this.evt_fn,f;!d&&(this.node&&this.node.parentElement)&&(f=this.node.parentElement,f._elg&&(c=f._elg.evt_obj,d=f._elg.evt_fn));d&&(b=la.exec(c,d,a,this));return b};c.creat=function(a){a="string"==typeof a?document.getElementById(a):a;return"object"===typeof a._elg?a._elg:new c(a)};c.prototype.rect=function(){var a=new ub,b=this.node.getBoundingClientRect();b&&(a.x1=b.x,a.y1=b.y,a.x2=b.width,a.y2=b.height);return a};c.prototype.pos=function(a,b,
c,d){this.node.style.left=a+"px";this.node.style.top=b+"px";this.node.style.width=c+"px";this.node.style.height=d+"px"};c.find=function(a){for(var b;a;){if((b="object"===typeof a._elg?a._elg:null)&&b.is_focus)return a._elg;a=a.parentElement}return null};c.find2=function(a){for(var b;a;){if(b="object"===typeof a._elg?a._elg:null)return a._elg;a=a.parentElement}return null};c.sel_def=function(){var a=c.creat(da.headg.node.firstElementChild.firstElementChild.firstElementChild);a&&a.sel()};c.sel_exec=
function(){c.focus&&c.focus.exec()};c.sel_par=function(){c.focus&&c.focus.node.parentElement._elg.exec()};c.sel_restore=function(){c.focus_prev&&c.focus_prev.sel_block()};c.sel_left=function(){var a=c.focus;if(a&&a.node){if(a=a.node.previousElementSibling)return a=c.creat(a),a.sel()}else c.sel_def();return-1};c.sel_right=function(){var a=c.focus;if(a&&a.node){if(a=a.node.nextElementSibling)return a=c.creat(a),a.sel()}else c.sel_def();return-1};c.focus=null;c.focus_cur=null;c.focus_prev=null;c.cls_sel=
"sel";return c}();h.Elg=F;(function(c){})(h.play_std_db||(h.play_std_db={}));var Ha=function(){function c(a){this.el=document.createElement("video");this.progress=0;this.is_play=!1;this.par=a}c.prototype.init=function(){var a=this,b=this.el;this.muted(!0);this.el.controls=!1;this.el.autoplay=!1;this.el.playsInline=!0;b.addEventListener("play",function(){a.par.evt(G.start)});b.addEventListener("waiting",function(){a.is_play=!1;a.progress=0;a.par.evt(G.waiting)});b.addEventListener("durationchange",
function(){a.progress=95;a.par.evt(G.progress)});b.addEventListener("loadedmetadata",function(){a.progress=10;a.info_hsz=a.el.videoHeight;a.info_wsz=a.el.videoWidth;a.par.evt(G.load_meta)});b.addEventListener("loadeddata",function(){a.progress=20;a.par.evt(G.progress)});b.addEventListener("progress",function(){a.progress=15;a.par.evt(G.progress)});b.addEventListener("playing",function(){a.progress=17;a.is_play=!0;a.par.evt(G.resume)});b.addEventListener("canplay",function(){a.progress=80;a.par.evt(G.progress)});
b.addEventListener("canplaythrough",function(){a.muted(!1);a.progress=100;a.is_play=!0;a.par.evt(G.resume)});b.addEventListener("pause",function(){a.is_play=!1;a.par.evt(G.suspend)});b.addEventListener("ended",function(b){a.par.evt(G.end)});this.el=b};c.prototype.init_hls=function(){var a=this;this.hls=new h.Hls;this.hls.on(h.Hls.Events.MANIFEST_PARSED,function(){a.el.play()});this.hls.on(h.Hls.Events.ERROR,function(a,c){if(c.fatal)switch(c.type){case h.Hls.ErrorTypes.NETWORK_ERROR:alert(444);break;
case h.Hls.ErrorTypes.MEDIA_ERROR:alert(55);break;default:alert(66)}})};c.prototype.stop_hls=function(){this.hls&&this.hls.destroy()};c.prototype.set_src=function(a){this.check_hls(a)?(this.hls.attachMedia(this.el),this.hls.loadSource(a)):(this.hls.detachMedia(),this.el.src=a)};c.prototype.stop=function(){this.set_src("");this.el.pause()};c.prototype.check_hls=function(a){var b=this.el;return!Boolean(b.canPlayType("audio/mpegurl")||b.canPlayType("application/vnd.apple.mpegURL"))&&-1!=a.indexOf(".m3u8")};
c.prototype.muted=function(a){this.el.muted=a;this.el.volume=a?0:1};c.support_hls=!1;return c}();h.Play_std=Ha;(function(c){})(h.playg_db||(h.playg_db={}));var J=function(c){function a(){var a=c.call(this)||this;a.play_indq=-1;a.player=L.cur;a.background=new F;a.video=new F(a.player.els[0].el);a.video2=new F(a.player.els[1].el);a.play_btn=null;a.all_btn=null;a.load_el=null;a.is_full=!1;a.sz_w=720;a.sz_h=576;a.timeg=new vb;a.info_g=new F;a.no_g=new sa("no");a.num_g=new sa("num");var e=a.video.node,
d=a.video2.node;a.player.evt_obj=a;a.player.evt_fn=a.on;a.cls_add("playg","abs","full");a.video.show(!1);a.video2.show(!1);a.no_g.set("#");a.info_g.cls_add("info").append(a.no_g,a.num_g).show(!1);a.append(a.video,a.video2,a.timeg,a.info_g);a.background.cls_add("all","abs","full").set_focus(!0).evt_set(a,a.on);a.append(a.background);a.sz_w=aa.cur.sz_w;a.sz_h=aa.cur.sz_h;e.width=a.sz_w;e.height=a.sz_h;d.width=a.sz_w;d.height=a.sz_h;za.add(a.background.node,["play",function(c){a.player.play_cur()},"stop",
function(c){a.player.stop()},"prev",function(c){a.player.prev()},"next",function(c){a.player.next()},"fullscreen",function(a){aa.cur.fullscreen()},"refresh",function(a){location.reload()}]);return a}xa(a,c);a.prototype.init=function(){this.play_btn||(this.play_btn=new F);this.play_btn.set_focus(!0).evt_set(this,this.on);this.all_btn.set_focus(!0).evt_set(this,this.on);this.load_el=F.creat("dm_search");this.timeg.exec_rep()};a.prototype.resize=function(){720==this.player.cur.info_wsz&&576==this.player.cur.info_hsz?
this.player.cur.el.classList.add("pal"):this.player.cur.el.classList.remove("pal");this.player.cur&&(this.player.cur.el.width=aa.cur.sz_w,this.player.cur.el.height=aa.cur.sz_h)};a.prototype.full_toggle=function(){this.full_set(!this.is_full)};a.prototype.full_set=function(a){a!=this.is_full&&(a?(this.timeg.show(!1),this.info_g.show(!1),da.headg.show(!1)):(this.timeg.show(!0),this.info_g.show(!0),da.headg.show(!0)),this.is_full=a);return this};a.prototype.full_act=function(b){var c=this;ga.cur.set_waiting(1E3*
a.full_delay,this,b?function(a){c.full_set(!0)}:null).exec_waiting();return this};a.prototype.progress_reset=function(){this.load_el.node.lastElementChild.innerHTML="";return this};a.prototype.progress=function(a){a=a||(this.player.buf||this.player.cur).progress;var c=this.load_el.node.lastElementChild;100<=a?c.innerHTML+="-\r\n":(c.innerHTML+=a+", ",console.log("progress",a));return this};a.prototype.on=function(a,c){var d;switch(a){case G.dblclick:this.background===c&&aa.cur.fullscreen();break;
case G.click:this.all_btn===c?this.list():this.play_btn==c&&this.player.toggle();break;case G.load_meta_q:this.progress_reset().progress().full_set(!1).list_close().logo(this.player.list[this.player.cur_ind].img);d=F.creat(this.play_btn.node.firstElementChild);d.cls_toggle("play","pause");d.cls_rm("act");this.info_g.show(!0);this.num_g.set(""+(this.player.cur_ind+1));break;case G.progress:this.progress();break;case G.resume:this.player.upd();this.resize();this.progress();d=F.creat(this.play_btn.node.firstElementChild);
d.cls_toggle("play","pause");d.cls_add("act");this.full_act(!0);break;case G.stop_q:this.full_set(!1).full_act(!1);this.info_g.show(!1);this.num_g.set("");this.list();break;case G.waiting:this.full_act(!1).full_set(!1);this.progress("Loading...");break;case G.suspend_q:this.full_set(!1).full_act(!1);break;case G.suspend:d=F.creat(this.play_btn.node.firstElementChild);d.cls_toggle("pause","play");break;case G.end:this.full_act(!1).full_set(!1)}};a.prototype.play=function(){this.player.play()};a.prototype.logo=
function(a){var c=F.creat("dmi_logo");a&&c.set("<img src='"+a+"' alt=''/>")};a.prototype.list=function(){var a=ea.cur;a._act?a.close():this.list_open();return this};a.prototype.list_close=function(){var a=ea.cur;a&&a._act&&a.close();return this};a.prototype.list_open=function(){var a=ea.cur;a.data=[new ha(L.cur.list[0]),new ha(L.cur.list[1]),new ha(L.cur.list[2]),new ha(L.cur.list[3]),new ha(L.cur.list[4]),new ha(L.cur.list[5]),new ha(L.cur.list[6]),new ha(L.cur.list[7]),new ha(L.cur.list[8])];a.is_init||
a.init();a.els();return this};a.prototype.ind_check=function(a){return 0<a&&a<=this.player.list.length};a.prototype.play_ind=function(a){-1!=this.play_indq?a=10*this.play_indq+a:this.info_g.show(!0);Ia.cur.run_duration(this.info_g,2E3,this.play_ind_act.bind(this));this.num_g.cls_toggle_state(!this.ind_check(a),"err").set(""+a);this.play_indq=a};a.prototype.play_ind_act=function(){this.ind_check(this.play_indq)?this.player.play_ind(this.play_indq-1):this.info_g.show(!1);this.play_indq=-1};a.init=function(){a.cur=
new a};a.full_delay=5;a.cur=null;return a}(F);h.Playg=J;(function(c){})(h.strg_db||(h.strg_db={}));var sa=function(c){function a(b){var e=c.call(this)||this;e.val=null;e.is_ellipsis=!1;e.sz=16;b&&e.init(b);e.cls_add(a.MOD);return e}xa(a,c);a.prototype.set=function(a){this.is_ellipsis&&this.cls_add("ellipsis");this.sz&&this.cls_add("s"+this.sz);c.prototype.set.call(this,a);return this};a.MOD="strg";return a}(F);h.Strg=sa;(function(c){})(h.txtg_db||(h.txtg_db={}));T=function(){return function(){this.y2=
this.x2=this.y1=this.x1=0}}();h.Txtg=T;(function(c){})(h.tblg_db||(h.tblg_db={}));T=function(){return function(){}}();h.tblg=T;(function(c){})(h.ntbl_db||(h.ntbl_db={}));T=function(){function c(){this.hint=this.html=this.fields=this.sel_td=this.td_el=this.dt_el=null}c.init=function(){M.focus(c.cur,function(a,b){var e=c.cur;if(!Z.cur.is_focus)switch(b){case 73:e.edit(0);break;case 79:e.new_row(!a.evt.shiftKey);break;case 37:case 72:e.sel_left();break;case 38:case 75:e.sel_up();break;case 39:case 76:e.sel_right();
break;case 40:case 74:e.sel_low();break;case 77:za.open(e.sel_td,null);break;case 13:a.evt.ctrlKey&&e.send()}return 0})};c.prototype.imp=function(a){var b=Pa(a);Pa(a);return b};c.prototype.tbl=function(a){var b,e,d,f;this.imp(a);var g=oa(a),h=!1;e=document.getElementById("act_mod_id");null===this.fields&&(this.fields=Array(g),Ya.imp(this.fields,a),b=document.createElement("table"),e._head=document.createElement("thead"),e._body=document.createElement("tbody"),b.id="main_table",b.append(e._head),b.append(e._body),
e.append(b));b=this.fields;e=e._head;if(0<g){g=document.createElement("tr");e.append(g);e=document.createElement("th");e.innerText="";g.append(e);for(f=0;f<b.length;f++)d=b[f],e=document.createElement("th"),e.innerText=d.name,e.title="#"+d.id+" - "+d.title,g.append(e)}else h=!0;for(f=0;a.cur<a.sz&&f<c.limit;f++)this.tbl_row(a,h,null);return 0};c.prototype.td_close=function(){var a=act_mod_id._head.firstChild,b=this.td_el,c=this.dt_el;b&&(a=a.childNodes[b.col_ind+1],this.log_info_close(c),Da(null),
a.classList.remove("act"),b.classList.remove("act"),this.hint&&this.hint.close(),this.td_el=null)};c.find=function(a,b,c,d){switch(c){case h.DM_ginp_exec:"string"===typeof a.field._val_big&&(d=a.field._val_big),!d||""===d?(c=b.row_alloc(),b.tbl_row(c,0,null)):b.tbl_row(null,0,d),!b.hint||a.hint.close()}return!1};c.inp_field_evt=function(a,b,c,d){var f=b.td_el,g=b.fields[f.col_ind],n="/"+b.html.mod.mod_nm+"/"+f.parentNode._id+"/";switch(c){case h.DM_ginp_init:b.td_act2(a);break;case h.DM_ginp_esc:b.td_close();
break;case h.DM_ginp_live:ma.send(n+"live/"+g.id,b,b.col_val,"text/plain",d),f.new_type?b.td_val(f,0,d):b.td_val(f,d,"")}};c.prototype.tbl_row=function(a,b,c){var d=act_mod_id._body,f=this.fields,g=d.childNodes.length,h=null,k,t;if(!c){t=ua(a);for(a.cur-=8;g--;)if(k=d.childNodes[g],!k._id&&b||t&&k._id===t){h=k;break}}h?d=h.childNodes[0]:(h=document.createElement("tr"),d.insertBefore(h,d.firstChild),d=document.createElement("th"),g=document.createElement("a"),k=document.createElement("span"),g.onclick=
function(a){this.parentElement.parentElement.classList.add("act")},d.append(g),d.append(k),h.append(d));h._id=t||0;h.new_val=c&&""!==c?c:null;g=d;if(c)d=document.createElement("td"),d.colSpan=f.length,d.className="new",h.append(d),d._id=t,d.col_ind=-1,h.cur_val=c,h.new_val=c,this.tbl_td(null,h,d,g);else for(c=0;c<f.length;c++)d=h.childNodes[c+1],d||(d=document.createElement("td"),d.col_ind=c,d.cur_id=!c&&b?0:null,h.append(d),d.sel_hn=[this.sel,this]),d._id=t,this.tbl_td(a,h,d,g);return h};c.prototype.td_sel=
function(a,b){var c=act_mod_id._head.firstChild.childNodes[a.col_ind+1],d=a.parentNode.firstChild;-1===b&&(b=!a.classList.contains("sel"));b?(c.classList.add("sel"),d.classList.add("sel"),a.classList.add("sel")):(c.classList.remove("sel"),d.classList.remove("sel"),a.classList.remove("sel"))};c.prototype.sel=function(a){this.sel_td&&this.sel_td!==a&&this.td_sel(this.sel_td,0);this.sel_td=a;this.td_sel(a,1)};c.prototype.sel_left=function(){var a=this.sel_td;return a&&0<a.col_ind&&(a=a.previousSibling)?
this.sel(a):-1};c.prototype.sel_up=function(){var a=this.sel_td,b;if(a&&(b=a.parentNode))if(b=b.previousSibling)if(a=b.childNodes[a.col_ind+1])return this.sel(a);return-1};c.prototype.sel_right=function(){var a=this.sel_td;return a&&a.nextSibling?this.sel(a.nextSibling):-1};c.prototype.sel_low=function(){var a=this.sel_td,b;if(a&&(b=a.parentNode))if(b=b.nextSibling)if(a=b.childNodes[a.col_ind+1])return this.sel(a);return-1};c.prototype.new_row=function(a){a||(a=this.row_alloc(),this.tbl_row(a,0,null))};
c.prototype.edit=function(a){var b=this.sel_td,c=this.fields,d=b.parentNode;if(!b)return-1;b.col_ind&&(this.td_el=b,b.new_type=a,c=c[b.col_ind],this.log_info(0,0,d._id,c.id),Da({val:a?b.new_val:"0"+b.new_id,notice:a?null:b.new_val,placeholder:this.html.mod.mod_nm+"("+d._id+")."+c.name+"("+b.new_id+")",ud_par:this,evt:ya.db.ntbl_inp_field_evt_fn}))};c.prototype.tbl_td=function(a,b,c,d){var f=this,g,h;g=this.fields[c.col_ind];h=!this.html.mod.isvar||this.html.mod.istxt||g.istxt;if(a){switch(g.siz){default:g=
g.arr?ua(a):Qa(a)}h=h?$(a):jb(a)}else g=0,h=b.new_val;c.children.length?(a=c.children[0],b=c.children[1]):(c.dt=d,a=document.createElement("a"),b=document.createElement("span"),za.add(c,["edit PTR",function(a){f.td_close();f.sel(a);f.edit(0)},"edit value",function(a){f.sel(a);f.td_close();f.edit(1)},"refresh",function(a){location.reload()},"datetime",function(a){var b=new ia(0),c=b.strf("H:i:s");a.cur_id=b.sec;a.cur_val=c;a.new_type=0;a.firstChild.click()},"revert",function(a){a.new_type=0;f.td_val(a,
a.cur_id,a.cur_val)},"copy ID",function(a){Va.copy_str(a.new_id)},"copy value",function(a){Va.copy_str(a.new_val)}]),c.col_ind||(d.bk=null,this.dt_el=d,this.log_info(0,0,0,0)),c.onmousedown=function(){f.sel(c)},c.append(a),c.append(b));c.lind=0;c.tm={sec:1};null!=c.cur_id&&c.cur_id!==g&&(c.className="",sb(c,"#dbdef9"));c.cur_id=g;c.cur_val=h;c.new_type=0;this.td_val(c,g,h)};c.prototype.log_info=function(a,b,c,d){var f=this.dt_el,g=new ia(1);f.title=g.strf(b);f.children[0].innerText=a;f.children[0].innerText=
f.parentNode._id;f.children[1].innerText=g.passed();null==f.bk?f.bk=[a,f.children[1].innerText]:(f.className="date",f.children[1].onclick=function(a){urlq_load("/"+act_mod_id.className+"/"+c+"/column/"+d,null,ntbl_log_field)})};c.prototype.log_info_close=function(a){a.className="";a.children[0].innerText=a.bk[0];a.children[1].innerText=a.bk[1];a.children[1].onclick=void 0};c.prototype.td_val=function(a,b,c){var d=a.children[0],f=a.children[1],g=this.fields;if(g=-1!==a.col_ind?g[a.col_ind]:null)if(g.id===
Ya.db.pos)if(this.html.mod.id===Aa.db.imgv)c=document.createElement("img"),c.src="data:image/png;base64,"+btoa(ival),f.appendChild(c),c=null;else{if(!this.html.mod.istxt){var h,k="";for(h=0;h<ival.length;h++)h&&(k+=1<h&&!(h%16)?"\n":" "),c=ival.charCodeAt(h).toString(16).toUpperCase(),k+=("0"+c).slice(-2);c=k}}else g.mod===Aa.db.img?c='<a target="_blank" href="https://s.dy.md:4433'+ival+'"><img width=100 src="'+c+'"  alt=""/></a>':g.mod===Aa.db.url&&(c='<a target="_blank" href="'+c+'">'+c+"</a>");
d.innerHTML="0"+(0!==b?b:"");null!=c&&(f.innerHTML=c);a.new_id=b;a.new_val=c;!a._id&&(!g||1===g.id)?a.classList.add("new"):a.cur_id!==a.new_id?a.classList.add(!a._id?"new":"date"):(a.classList.remove("date"),a.classList.remove("new"))};c.prototype.hints=function(a){var b,c,d=this.hint||new ea;this.imp(a);this.hint=d;d.data=[];for(var f=0;1E3>f&&a.cur<a.sz;f++)b=ua(a),c=$(a),d.data.push({id:0,title:b.toString(),"int":1,desc:c,date:0});d.init();d.els();return 0};c.prototype.td_act2=function(a){a=this.td_el;
var b=act_mod_id._head.firstChild.childNodes[a.col_ind+1],c="/"+this.html.mod.mod_nm+"/"+a._id+"/field-ls/"+this.fields[a.col_ind].id+"/";a.classList.add("act");b.classList.add("act");ma.load(c,this,this.hints)};c.prototype.row_alloc=function(){var a=new Xa;a.init(1E4);return a};c.prototype.col_val=function(a){var b=this.imp(a),c=this.td_el,d=0;if(b)return b;d=Qa(a);b=$(a);a=1>d?"":"0"+d;""!==a&&(Ka(Z.cur,a,b,null),ba(Z.cur,a.length),this.td_val(c,d,b));return b};c.prototype.set_field_res=function(a){var b=
this.imp(a);if(b)a=$(a),alert(b+" - "+a);else{for(oa(a);a.cur<a.end;);this.td_close()}};c.prototype.send=function(){var a=act_mod_id._body,b,c,d,f=a.childNodes.length,g=new Ja(f*9*this.fields.length);b=0;for(var h="/"+this.html.mod.mod_nm+"/save",k=f;k--;)if(c=a.childNodes[k],f=0,g.cur=g.end,ta(g,f),Na(g,c._id),c.new_val)console.log(c.new_val),Ma(g,c.new_val);else{for(b=1;b<c.childNodes.length;b++)d=c.childNodes[b],d.new_type?d.cur_id!==d.new_id&&(ta(g,-1*b),Ma(g,d.new_val),f++):d.cur_id!==d.new_id&&
(ta(g,b),Na(g,d.new_id),f++);b=g.end;g.end=g.cur;f&&(ta(g,f),g.end=b);g.cur=0}g.end&&ma.send(h,this.html,da.cur.evt,ma.type,hb(g))};c.log_field=function(a){var b,c,d,f=new ea;f.is_act_res=!0;f.query=dm_ginp_input.value;f.data=[];for(var g=0;1E3>g&&a.cur<a.sz;g++)b=ua(a),c={sec:pa(a)},d=$(a),f.data.push({id:0,title:b.toString(),desc:d,date:c});f.els();return 0};c.cur=new c;c.limit=300;return c}();h.Ntbl=T;T=function(){return function(){}}();h.Evt_db=T;var G;(function(c){c[c.click=0]="click";c[c.unclick=
1]="unclick";c[c.dblclick=2]="dblclick";c[c.select=3]="select";c[c.unselect=4]="unselect";c[c.start=5]="start";c[c.start_q=6]="start_q";c[c.stop=7]="stop";c[c.stop_q=8]="stop_q";c[c.resume=9]="resume";c[c.resume_q=10]="resume_q";c[c.resume_s=11]="resume_s";c[c.suspend=12]="suspend";c[c.waiting=13]="waiting";c[c.suspend_q=14]="suspend_q";c[c.fullscreen=15]="fullscreen";c[c.infullscreen=16]="infullscreen";c[c.prev=17]="prev";c[c.next=18]="next";c[c.visibility=19]="visibility";c[c.invisibility=20]="invisibility";
c[c.load_meta_q=21]="load_meta_q";c[c.load_meta=22]="load_meta";c[c.progress=23]="progress";c[c.end=24]="end";c[c.show=25]="show";c[c.hide=26]="hide";c[c.resize=27]="resize"})(G=h.evt_db||(h.evt_db={}));var la=function(){function c(a,b,c){this.mod=a;this.evt=b;this.sec=c||ia.get_cur_sec()}c.exec=function(a,b,c,d){b&&(a=b.bind(a,c,d))&&a()};c.db=G;return c}();h.Evt=la;(function(c){})(h.ctxmg_db||(h.ctxmg_db={}));var za=function(){function c(){this.ls=this.ul=this.cont=this.el=null}c.prototype.init=
function(){this.cont=new F;this.ul=new F("ul");this.cont.cls_add(c.MOD).append(this.ul);aa.body.append(this.cont);for(var a=0;a<this.ls.length;a+=2)this.it_init(this.ls[a],this.ls[a+1]);this.ul.set_focus(!0).evt_set(this,this.evt)};c.prototype.open=function(a,b){var c,d;this.cont.show(!0);b?this.cont.cls_add("mouse"):this.cont.cls_rm("mouse");this.ul.sel_block();b?(c=b.clientX-10,d=b.clientY-10):(c=a.rect(),d=c.y1+25,c=c.x1+25);this.cont.node.style.left=c+"px";this.cont.node.style.top=d+"px"};c.prototype.it_init=
function(a,b){var c=new F("li");c.set_focus(!0).set(a);c.evt_ud=b;this.ul.append(c)};c.prototype.it_exec=function(){F.focus.evt_ud();this.close()};c.prototype.close=function(){this.cont.show(!1);F.sel_restore()};c.prototype.evt=function(a,b){switch(a){case G.click:this.cont!=b&&this.ul!=b?this.it_exec():this.close()}};c.init=function(){window.addEventListener("contextmenu",function(a){c.open(a.target,a)&&a.preventDefault()},!1);window.addEventListener("click",function(a){var b=c.cur;b&&b.cont&&(a=
F.find(a.target),b.cont.exists(a)||b.close())})};c.add=function(a,b){var e=new c;e.el=a;e.ls=b;a._ctxmg=e};c.open=function(a,b){for(var e=a,d;a&&"object"!=typeof e._ctxmg;)a=a.parentElement;a&&"object"==typeof e._ctxmg&&(d=e._ctxmg,c.cur&&d!==c.cur&&c.cur.close(),d.cont||d.init(),d.open(e._ctxmg,b),c.cur=d);return d};c.all_cb=function(a,b){var c=new ea;c.is_act_res=!0;c.is_find_live=!0;c.filter=!0;c.click_res_cb=function(a,b){window.location.href="/"+b.title+"/"};c.data=[];Da({placeholder:"Select module...",
evt:function(a){c.query=a;c.els()}});for(var d=0;1E3>d&&a.cur<a.sz;d++)c.data.push({id:0,title:void 0,date:0});c.els()};c.MOD="ctxmg";c.cur=null;return c}();h.Ctxmg=za;(function(c){})(h.html_db||(h.html_db={}));var da=function(){function c(){this.admin=this.is_bin=!1;this.mod=this.inpg=this.it_mod=this.qel=this.path=this.theme_color=null}c.prototype.parse=function(){var a;if(a=document.body.getAttribute("data-bin")){a=window.atob(a);for(var b=a.length,e=new Uint8Array(b),d=0;d<b;d++)e[d]=a.charCodeAt(d);
a=e.buffer}else a=null;a=new Ja(a);Z.cur.creat();a.sz&&this.imp(a);c.act_mod_id=document.getElementById("act_mod_id");c.act_mod_id&&(c.body=F.creat(c.act_mod_id),this.it_mod=c.act_mod_id.className);Z.cur.hint=null;a=this.mod.mod_nm;if("post"===a||"main"===a)Z.cur.evt=ya.db.inpg_main_evt_fn;return this};c.init=function(){var a=function(){za.init();ya.init();fa.init();ma.init();Z.init();c.cur.parse().init(null);na.init();L.init();J.init();Wa.init();ea.init()};document.getElementById("appinit")?(ga.cur.type=
ga.type.TV,c.cur.mod=new Aa,c.cur.inpg=Z.cur,ga.cur.load_css(),aa.body.set('<div id="test"><div id="dm_menu_top" class="elg menug top bot"><div class="max_w"><div id="dmi_logo" class="logog"><a class="i96 main" href="/"><i></i></a></div><div id="dm_all" class="all"><a class="i48 menu" href="/mod"><i></i></a></div><div id="dm_play"><a id="dmi_play_btn" class="i48 play" href="/radio"><i></i></a></div><div id="dm_search" class="search"></div></div></div></div><div id="dmi_scroll" class="scrollg"><div class="elg hide abs full"></div><div><div class="contg"><div id="act_mod_id" class="ntbl"></div></div></div></div>'),
a(),c.act_mod_id=document.getElementById("act_mod_id"),F.creat("dm_menu_top"),F.creat("dmi_logo").set_focus(!0),F.creat("dm_search").set_focus(!0),c.headg=F.creat("test"),c.headg.sel_block(),a=J.cur,a.play_btn=F.creat("dm_play"),a.all_btn=F.creat("dm_all"),a.init(),c.body.append(a)):document.addEventListener("DOMContentLoaded",a)};c.prototype.imp=function(a){this.admin=wa(a);this.theme_color=pa(a);this.inpg.imp(a);this.mod.imp(a);return this};c.links=function(){var a,b,c;if(document.getElementById("act_mod_id")){a=
document.getElementsByTagName("a");for(b=0;b<a.length;b++)c=a[b],null===c.getAttribute("data-id")&&(c.onclick=function(a){a.preventDefault()})}};c.prototype.evt=function(a){var b=Z.cur;this.imp(a);b.ud_par=this;b.file={is_show:1};b.init()};c.prototype.set_meta_theme_color=function(a){a&&(a="#"+a.toString(16).padStart(6,"0"),this.set_meta("theme-color",a));return this};c.prototype.set_meta=function(a,b){var c=document.head,d=c.querySelector("meta[name="+a+"]");d||(d=document.createElement("meta"),
d.name=a,d.content=b,c.appendChild(d));d.hasAttribute("content")&&d.setAttribute("content",b);return this};c.prototype.counter=function(){(new Image).src="https://counter.yadro.ru/hit?r"+encodeURI(document.referrer)+("undefined"==typeof screen?"":";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?screen.colorDepth:screen.pixelDepth))+";u"+encodeURI(document.URL)+";h"+encodeURI(document.title.substring(0,150))+";"+Math.random();return this};c.prototype.init=function(a){this.is_bin?(this.inpg=
Z.cur,this.imp(a),a=eb(a),act_mod_id.innerHTML=a,this.inpg.init()):db();this.it_mod&&(c.act_mod_id.className=" dm_"+this.it_mod);this.set_meta_theme_color(this.theme_color);lb();rb();c.links();this.admin?ma.start():c.cur.counter();ma.state();return this};c.init_evt=function(a,b,e,d){switch(e){case h.DM_ginp_init:b=new ea;b.is_find_live=!0;b.is_act_res=!0;b.filter=!0;b.data=[];a.hint=b;b.init();Ua(null,c.act_mod_id,b);break;case h.DM_ginp_live:a.hint.query=d,a.hint.els()}};c.cur=new c;c.act_mod_id=
null;c.body=null;c.headg=null;return c}();h.Html=da;var Ia=function(c){function a(){var b=c.call(this)||this;b.state=0;b.ln1=new F;b.ln2=new F;b.el=null;b.duration=-1;b.info_g=new sa;c.prototype.init.call(b,a.MOD);b.cls_add("main");b.cls_add("abs");b.ln1.cls_add("ln1");b.ln2.cls_add("ln2");b.append(b.info_g).append(b.ln1).append(b.ln2);return b}xa(a,c);a.prototype.run_duration=function(a,c,d){this.state=this.duration=c;this.thr||this.run(a,d)};a.prototype.run=function(b,c){var d=this,f=0,g;g=b.rect();
this.node.parentElement?this.show(!0):aa.body.append(this);this.pos(g.y1,g.x1,g.x2-g.x1-2,g.y2-g.y1-2);f=this.run_item_cb(f);this.thr=window.setInterval(function(){-1!=d.duration&&d.state<=a.delay?(d.state=d.duration,d.close(),c()):f=d.run_item_cb(f)},a.delay);return this};a.prototype.run_item_cb=function(b){var c,d,f="";d=b;for(c=0;4>c;c++)4===++d&&(d=0),f+=a.color[d]+" ";4===++b&&(b=0);-1!=this.duration?(this.state-=a.delay,c=this.state+""):c=++this.state+"%";this.node.style.borderColor=f;this.info_g.set(c);
return b};a.prototype.close=function(){window.clearInterval(this.thr);this.state=this.thr=0;this.show(!1)};a.color=["#ff00ff","#0000ff","#00ff00","#fff000"];a.MOD="loadg";a.delay=200;a.cur=new a;return a}(F);h.Loadg=Ia;(function(c){})(h.play_db||(h.play_db={}));h.dmi_play_cfg={is:{play:0,fill:0,mediaSession:0},ls:Array(2),_irep:0,_el_act:-1,el:[0,0]};var L=function(){function c(){this.src=this.evt_fn=this.evt_obj=null;this.is_play=!1;this.els=[new Ha(this),new Ha(this)];this.buf=this.cur=null;this.curi=
0;this.list=[];this.cur_item=null;this.cur_ind=-1;this.progress=0;this.els[0].init();this.els[1].init();!Ha.support_hls&&(h.Hls&&h.Hls.isSupported())&&(this.els[0].init_hls(),this.els[1].init_hls())}c.init=function(){var a=new S;a.id=1;a.title="DTV";a.desc="\u041d\u043e\u0432\u043e\u0441\u0442\u0438";a.img="https://mediasat.info/wp-content/uploads/2015/11/logo_DTV_4.jpg";a.dat_link="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm";a.dat_link="http://cdn-01.bonus-tv.ru:8080/vmesterf/index.m3u8";
c.cur.list.push(a);a=new S;a.id=2;a.title="GRT";a.desc="\u041f\u0435\u0440\u0441\u043e\u043d\u0430";c.cur.list.push(a);a.img="https://grt.md/wp-content/themes/grt/img/logo.png";a.dat_link="http://v4.proofix.ru:80/8tv-russia/index.m3u8";a.dat_link="https://ia800300.us.archive.org/17/items/BigBuckBunny_124/Content/big_buck_bunny_720p_surround.mp4";a.dat_link="https://live2.cdn.grt.md/GRT_H264/index.m3u8?token=e285041a05fd5625d4ea0c79418cf81400d9f92a";a=new S;a.id=3;a.title="\u041f\u0435\u0440\u0432\u044b\u0439 \u043a\u0430\u043d\u0430\u043b";
a.desc="\u0412\u0440\u0435\u043c\u044f";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/0af5f37e6bc5147b987967b054255be0cae70262e01bbfb08d785f6800ab23b6/68747470733a2f2f692e696d6775722e636f6d2f314971434765392e706e67";a.dat_link="http://iptv.ktkru.ru:8001/index.m3u8";a=new S;a.id=4;a.title="\u041c\u0430\u0442\u0447 \u0422\u0412";a.desc="\u0424\u0443\u0442\u0431\u043e\u043b";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/7434ddfd2a8415c3e10acfa3723654f1e951c53fe0992ec14f8caa9ad1080c47/68747470733a2f2f692e696d6775722e636f6d2f6b46646f6f52342e706e67";
a.dat_link="http://iptv.ktkru.ru:8003/index.m3u8";a=new S;a.id=5;a.title="\u041e\u0422\u0420";a.desc="\u0424\u0443\u0442\u0431\u043e\u043b";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/d6324d81846b02aeb5081f4328c4e7316cc0d2f8d3c3d4a9e27b078a08abed02/68747470733a2f2f692e696d6775722e636f6d2f51795a765433652e706e67";a.dat_link="http://iptv.ktkru.ru:8009/index.m3u8";a=new S;a.id=6;a.title="\u041f\u0435\u0440\u0435\u0446 \u0422\u0412";a.desc="\u0423\u043b\u0451\u0442\u043d\u043e\u0435 \u0432\u0438\u0434\u0435\u043e";
c.cur.list.push(a);a.img="https://images.beetv.kz/rosing-beelinekz-production/689a91a49cbd7f589dce.jpg";a.dat_link="https://media.w3.org/2010/05/sintel/trailer.mp4";a.dat_link="http://v4.proofix.ru:80/8tv-europe/index.m3u8";a=new S;a.id=7;a.title="\u0422\u041d\u0422";a.desc="\u0414\u043e\u043c 2";c.cur.list.push(a);a.img="https://s6.vcdn.biz/static/f/4034275071/image.jpg";a.dat_link="http://iptv.ktkru.ru:8019/index.m3u8";a=new S;a.id=8;a.title="\u041d\u0422\u0412";a.desc="\u041c\u0435\u043d\u0442\u044b";
c.cur.list.push(a);a.img="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/NTV_logo_2003.svg/1200px-NTV_logo_2003.svg.png";a.dat_link="http://iptv.ktkru.ru:8004/index.m3u8";a=new S;a.id=9;a.title="\u041c\u0438\u0440";a.desc="\u041f\u0440\u0438\u0448\u0435\u043b\u044c\u0446\u044b \u0438\u0437 \u0431\u0443\u0434\u0443\u0449\u0435\u0433\u043e";c.cur.list.push(a);a.img="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/%D0%9C%D0%B8%D1%80_%D0%A2%D0%92_logo.svg/1200px-%D0%9C%D0%B8%D1%80_%D0%A2%D0%92_logo.svg.png";
a.dat_link="http://hls.mirtv.cdnvideo.ru/mirtv-parampublish/mirtv_2500/playlist.m3u8";a=new S;a.id=10;a.title="\u041a\u0430\u0440\u0443\u0441\u0435\u043b\u044c";a.desc="\u0423 \u043c\u0435\u043d\u044f \u043b\u0430\u043f\u043a\u0438";c.cur.list.push(a);a.img="https://s3.spbtv.com/rosing-production/carsellogo.png";a.dat_link="http://iptv.ktkru.ru:8008/index.m3u8";a=new S;a.id=11;a.title="\u0412\u043c\u0435\u0441\u0442\u0435 \u0420\u0424";a.desc="\u0417\u0430 \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u0434\u043e \u0441\u0447\u0430\u0441\u0442\u044c\u044f";
c.cur.list.push(a);a.img="https://yt3.ggpht.com/ytc/AMLnZu_PNiwQTQaozRWX6x9GAKV0A7m5qxzE2hvbCORi_g=s900-c-k-c0x00ffffff-no-rj";a.dat_link="http://cdn-01.bonus-tv.ru:8080/vmesterf/index.m3u8";a=new S;a.id=12;a.title="\u0420\u043e\u0441\u0441\u0438\u044f 1";a.desc="\u0412\u0435\u0441\u0442\u0438 \u043d\u0435\u0434\u0435\u043b\u0438";c.cur.list.push(a);a.img="https://cdn-st4.rtr-vesti.ru/vh/pictures/hd/346/478/7.png";a.img="https://camo.githubusercontent.com/01dbd8bbf909ae4c13d50cf408faf6cf38ad778ded6c54b5b5f565752d35a729/68747470733a2f2f692e696d6775722e636f6d2f574936684b657a2e706e67";
a.dat_link="https://media.w3.org/2010/05/sintel/trailer.mp4";a.dat_link="http://iptv.ktkru.ru:8002/index.m3u8";a=new S;a.id=13;a.title="\u0417\u0432\u0435\u0437\u0434\u0430";a.desc="\u0412\u0435\u0441\u0442\u0438 \u043d\u0435\u0434\u0435\u043b\u0438";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/f62b34b4cc8240c12bfe308932a6d0cf783c0209f0dfcdacfec01f54f9b0f24d/68747470733a2f2f692e696d6775722e636f6d2f63304c306e63412e706e67";a.dat_link="https://media.w3.org/2010/05/sintel/trailer.mp4";
a.dat_link="http://iptv.ktkru.ru:8017/index.m3u8";a=new S;a.id=14;a.title="\u041c\u0443\u0437 \u0422\u0412";a.desc="\u0412\u0435\u0441\u0442\u0438 \u043d\u0435\u0434\u0435\u043b\u0438";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/7abf7e4ece866346edf299caefd1d4ec52abc099c49e993474465b771436241c/68747470733a2f2f692e696d6775722e636f6d2f4d6c3371714f462e706e67";a.dat_link="http://iptv.ktkru.ru:8020/index.m3u8";a=new S;a.id=15;a.title="\u0420\u0435\u043d \u0422\u0412";a.desc="\u041c\u0435\u0447 22";
c.cur.list.push(a);a.img="https://camo.githubusercontent.com/678d4191350ac1cd7a17dda0f1c54c5326ebbf14b7fdc1af1e91f84ff986db72/68747470733a2f2f692e696d6775722e636f6d2f313854417a59562e706e67";a.dat_link="http://iptv.ktkru.ru:8011/index.m3u8";a=new S;a.id=16;a.title="TRT 1";a.desc="Genclik";c.cur.list.push(a);a.img="https://camo.githubusercontent.com/267164da79a6e29349916a0e00707d17c805c2e008b8292c9d0ab57332eb20a3/68747470733a2f2f692e696d6775722e636f6d2f6a3738364f4c472e706e67";a.dat_link="https://tv-trt1.medya.trt.com.tr/master.m3u8"};
c.prototype.prev=function(){0<this.cur_ind&&(this.evt(G.prev),this.play_ind(this.cur_ind-1))};c.prototype.next=function(){var a=-1==this.cur_ind?1:this.cur_ind+1;a<this.list.length&&(this.evt(G.next),this.play_ind(a))};c.prototype.get_free=function(){return this.cur==this.els[0]?this.els[1]:this.els[0]};c.prototype.src_set=function(a){this.src=a;this.evt(G.load_meta_q);this.buf.set_src(a)};c.prototype.play_id=function(a){var b,c=-1,d;for(d=0;d<this.list.length;d++)if(b=this.list[d],b.id===a){c=d;
break}this.play_ind(c)};c.prototype.play_cur=function(){this.play_ind(-1==this.cur_ind?0:this.cur_ind);return this};c.prototype.play_ind=function(a){var b=this.list[a];if(this.cur_ind==a)this.play();else{if(!b)return alert("no track: "+a),0;this.cur_ind=a;this.buf=this.get_free();this.buf.muted(!1);b.nosecurity?(this.buf.el.setAttribute("crossorigin","anonymous"),a="https://vobook.ru:8080/"+b.dat_link):a=b.dat_link;this.src_set(a);this.buf.el.play();this.notify()}};c.prototype.notify=function(){var a=
this.list[this.cur_ind];h.dmi_play_cfg.is.mediaSession&&(navigator.mediaSession.metadata.title=a.title,void 0!==a.img&&(navigator.mediaSession.metadata.artwork=[{src:a.img,type:"image/png",sizes:"512x512"}]))};c.prototype.play=function(){this.evt(G.resume_q);this.cur.el.play();return this};c.prototype.pause=function(){this.evt(G.suspend_q);this.cur.el.pause();return this};c.prototype.stop=function(){this.evt(G.stop_q);this.cur.stop();return this};c.prototype.toggle=function(){this.cur&&this.cur.is_play?
this.pause():this.play_cur();return this};c.prototype.evt=function(a){var b;this.evt_fn&&(b=la.exec(this.evt_obj,this.evt_fn,a,this));return b};c.prototype.upd=function(){var a;if(this.buf){if(this.cur&&(a=F.find2(this.cur.el)))this.cur.stop(),a.show(!1);this.cur=this.buf;(a=F.find2(this.cur.el))&&a.show(!0);this.buf=null}};c.cur=new c;return c}();h.Play=L;h.dmi_play_init=lb;h.dmi_play_add_cb=pb;h.dmi_play_play_cb=Ga;h.dmi_play_pause_cb=Ta;h.dmi_play_status_cb=mb;h.dmi_play_next_cb=ob;h.dmi_play_prev_cb=
nb;var wb;(function(c){c[c.n0=48]="n0";c[c.n1=49]="n1";c[c.n2=50]="n2";c[c.n3=51]="n3";c[c.n4=52]="n4";c[c.n5=53]="n5";c[c.n6=54]="n6";c[c.n7=55]="n7";c[c.n8=56]="n8";c[c.n9=57]="n9";c[c.pause=19]="pause";c[c.media_play=415]="media_play";c[c.media_pause=19]="media_pause";c[c.media_stop=413]="media_stop";c[c.media_prev=412]="media_prev";c[c.media_next=417]="media_next";c[c.media_rec=416]="media_rec";c[c.exit=10182]="exit";c[c.info=457]="info";c[c.channel_up=427]="channel_up";c[c.channel_down=428]=
"channel_down";c[c.andro_kbd=229]="andro_kbd";c[c.del=46]="del";c[c.back=65385]="back";c[c.kbd_virt_enter=65376]="kbd_virt_enter";c[c.guide=458]="guide"})(wb=h.kbd_db||(h.kbd_db={}));var Za="ChannelUp ChannelDown MediaPause MediaPlay MediaPlayPause MediaRecord MediaStop MediaTrackNext MediaTrackPrevious MediaRewind MediaFastForward Exit Info Guide 0 1 2 3 4 5 6 7 8 9".split(" "),M=function(){function c(){this.evt=null}c.focus=function(a,b){c.ud_hn_bk=c.ud_hn;c.ud_obj_bk=c.ud_obj;c.ud_hn=b;c.ud_obj=
a};c.blur=function(){c.ud_hn_bk&&(c.ud_hn=c.ud_hn_bk,c.ud_hn_bk=null);c.ud_obj_bk&&(c.ud_obj=c.ud_obj_bk,c.ud_obj_bk=null)};c.def_nav=function(){};c.init=function(){var a=this;window.addEventListener("keydown",function(b){var d=b.keyCode,e=a.ud_obj,h=a.ud_hn,t=new c,l;c.last_time.set_now();ga.cur.evt(Ba.kbd,G.click);t.evt=b;if(h&&(e?(d=h.bind(e,t,d))&&(l=d()):l=h(t,d),!l))return ga.cur.evt(Ba.kbd,G.unclick),b.preventDefault(),!1});var b,e={},d;if(window.tizen){d=tizen.tvinputdevice.getSupportedKeys();
for(b=0;b<d.length;b++)e[d[b].name]=d[b].code;for(b=0;b<Za.length;b++)e.hasOwnProperty(Za[b])&&tizen.tvinputdevice.registerKey(Za[b])}};c.db=wb;c.last_time=new ia(0);c.ud_obj=null;c.ud_hn=null;c.ud_obj_bk=null;c.ud_hn_bk=null;return c}();h.Kbd=M;(function(c){})(h.tvcnl_db||(h.tvcnl_db={}));var S=function(){return function(){this.dat_link=this.desc=this.img=this.title=this.id=null;this.nosecurity=!1}}();h.Tvcnl=S;(function(c){})(h.err_db||(h.err_db={}));T=function(){return function(){}}();h.Err=T;
var $a=function(){function c(){}c.set=function(a,b){c.cur.pushState({},a,b)};c.add=function(a){c.cur.pushState({page:1},"",a)};c.replace=function(a){c.cur.replaceState({page:1},"",a)};c.cur=window.history;return c}();h.His=$a;var Ba;(function(c){c[c.mod=1]="mod";c[c.img=44]="img";c[c.imgv=163]="imgv";c[c.url=68]="url";c[c.kbd=69]="kbd"})(Ba=h.mod_db||(h.mod_db={}));var Aa=function(){function c(){this.lid=this.id=0;this.istxt=this.isvar=!1;this.it_mod=this.mod_nm=""}c.prototype.imp=function(a){this.id=
ib(a);this.isvar=Oa(a);this.istxt=Oa(a);this.mod_nm=Sa(a);this.it_mod=Sa(a);na.url_js=$(a);na.url_css=$(a);na.url_png=$(a);this.lid=ua(a);this.cfg_bin=kb(a);this.cfg_bin.sz&&ea.parse(this.cfg_bin)};c.db=Ba;return c}();h.Mod=Aa;(function(c){})(h.cardg_db||(h.cardg_db={}));var ha=function(){function c(a){this.img_el=this.data=null;this.el=new F;this.arrow=new F;this.data=a}c.prototype.exec=function(a,b){var c=this,d,f,g,h;d=this.arrow;h=this.int?"0"+this.data.title:this.data.title;f=document.createElement("span");
g=document.createElement("span");this.data.img?(this.img_el=new F("img"),this.img_el.node.src=this.data.img,d.append(this.img_el)):(d.set("<i></i>"),d.cls_add("i16","arrow_up_right"));d.node.onclick=function(){void 0!==c.data.dat_link&&(c.el.node.className="act",L.cur.play_id(c.data.id));return 1};this.el.append(d);-1!==a?(d="",0<a&&(d=d+"<b>"+this.data.title.substr(0,a),d+="</b>"),d+=this.data.title.substr(a,b),d+="<b>",d+=this.data.title.substr(a+b),d+="</b>"):d=h;this.data.dat_link&&pb(this.id,
this.data.dat_link,this.data.title,this.data.img);f._data=this;f.onclick=function(){return 0};f._desc=this.data.desc;f.title="";f._val=h;this.int?(f.title+="0x"+Number.parseInt(s.title).toString(16),f.style.color="#0000FF"):f.title+=this.data.title;"string"==typeof this.data.desc&&(f.title+="\r\n"+this.data.desc,g.innerText=this.data.desc);if("object"==typeof this.date){var k=this.date;h=document.createElement("time");h.innerText=k.passed();h.title=k.strf(null);(void 0).appendChild(h)}f.innerHTML=
d;f.appendChild(g);this.el.node.appendChild(f);this.el.node.onkeyup=function(a){};return 0};return c}();h.Cardg=ha;h.cardg_parse=qb;h.dm_gcard_parse=Ua;(function(c){})(h.pos_db||(h.pos_db={}));var Ja=function(){return function(c){this.pos=null;this.sz=this.end=this.cur=0;null!=c&&("number"===typeof c?this.pos=(new Xa).init(c).pos:(this.pos=new DataView(c),this.end=this.pos.byteLength),this.sz=this.pos.byteLength)}}();h.Pos=Ja;(function(c){})(h.timg_db||(h.timg_db={}));var vb=function(c){function a(){var b=
c.call(this)||this;b.hour=new sa("h");b.sep=new sa("sep");b.min=new sa("m");b.is_on=!1;b.cls_add(a.tag,"big","fgc_white");b.append(b.hour).append(b.sep).append(b.min);return b}xa(a,c);a.prototype.exec=function(){var a=new ia(null),c=(9>=a.hour?"0":"")+a.hour,a=(9>=a.min?"0":"")+a.min;this.is_on?this.cls_rm("act"):this.cls_add("act");this.is_on=!this.is_on;this.cls_add("fgc_white");this.hour.set(c);this.sep.set(":");this.min.set(a)};a.prototype.exec_rep=function(){var a=this;this.exec();setInterval(function(){a.exec()},
1E3)};a.tag="timg";return a}(F);h.Timg=vb;(function(c){})(h.bg_db||(h.bg_db={}));var na=function(){function c(){}c.check=function(){window.matchMedia("(display-mode: standalone)").matches&&(c.is_standalone=!0)};c.init=function(){c.check()};c.ch_upd=function(a,b){var c,d=dm_bg_cfg.cache;return fetch(a,{mode:b?"cors":"no-cors"}).then(function(f){console.log(444,a.url,f.ok,f.type);b&&f.ok&&(c=f.clone(),d.put(a,c));return f})["catch"](dmi_bg_offline)};c.ch_get=function(a){var b=a.request.url,e=a.request,
d=b.indexOf("://"),f,g,h;d?(d+=3,f=b.indexOf("/",d),b=b.substring(d,f),g=-1!==b.indexOf("dy.md")||-1!==b.indexOf("dey.md"),h="admin.dy.md"!==b.substring(0,11)):h=g=!1;g&&a.respondWith(caches.match(e).then(function(b){return h&&void 0!==b?(a.waitUntil(c.ch_upd(e,!0)),b):c.ch_upd(e,g)}));return 0};c.offline=function(){var a=(new ia(0)).strf("H:i:s");return new Response('<html lang=""><head><title>503 Service Unavailable</title><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body bgcolor="white"><center><b><font size="7" color="red">503</font></b><font size="6" color="#666"><br/>Service Unavailable</font><hr/><b>'+
a+"</b><br/>DM</center></body></html>",{status:503,headers:{"Content-Type":"text/html; charset=utf-8"}})};c.prototype.init=function(){self.addEventListener("install",function(a){a.waitUntil(caches.open(c.sw_cache).then(function(a){cfg.cache=a;return a.addAll([self.location.pathname,"/favicon.ico"])}).then(function(a){return self.skipWaiting()}));console.log("bg","Init")});self.addEventListener("activate",function(a){console.log("bg","Act");a.waitUntil(self.clients.claim());cfg.cache.addAll([c.url_png,
c.url_css])});self.addEventListener("message",function(a){a=a.data;c.url_png=a[0];c.url_css=a[1];console.log("bg","Msg")});self.addEventListener("fetch",c.ch_get)};c.sw_cache="v1";c.evt=null;c.is_standalone=!1;c.ctx=null;c.url_js=null;c.url_css=null;c.url_png=null;return c}();h.Bg=na;var xb;(function(c){c[c.id=1]="id";c[c.data=42]="data";c[c.pos=58]="pos"})(xb=h.col_db||(h.col_db={}));var Ya=function(){function c(){this.id=0;this.istxt=this.arr=!1;this.mod=this.siz=0;this.name=this.title=""}c.prototype.imp=
function(a){this.id=oa(a);this.arr=wa(a);this.istxt=wa(a);this.siz=pa(a);this.mod=pa(a);this.name=Ra(a);this.title=Ra(a)};c.imp=function(a,b){var e,d;for(e=0;e<a.length&&b.cur<b.sz;e++)d=new c,d.imp(b),a[e]=d};c.db=xb;return c}();h.Col=Ya;var Ca;(function(c){c[c.hint_web_evt_fn=216]="hint_web_evt_fn";c[c.html_init_evt_fn=555]="html_init_evt_fn";c[c.inpg_main_evt_fn=558]="inpg_main_evt_fn";c[c.ntbl_find_fn=554]="ntbl_find_fn";c[c.ntbl_inp_field_evt_fn=556]="ntbl_inp_field_evt_fn"})(Ca=h.fun_db||(h.fun_db=
{}));var ya=function(){function c(){}c.find=function(a){return c.ls[a]};c.init=function(){var a=c.ls;a[Ca.hint_web_evt_fn]=ea.web_evt;a[Ca.html_init_evt_fn]=da.init_evt;a[Ca.inpg_main_evt_fn]=Z.main_evt};c.db=Ca;c.ls=Array(1E3);return c}();h.Fun=ya;(function(c){})(h.cont_db||(h.cont_db={}));h.dmi_cont_init_cb=rb;T=function(){return function(){}}();h.Cont=T;(function(c){})(h.anim_db||(h.anim_db={}));h.dmi_anim_back_op=sb;T=function(){return function(){}}();h.Anim=T;(function(c){})(h.urlq_db||(h.urlq_db=
{}));var ma=function(){function c(a,b,c,d,f,g,h){this.path=a;this.ud_s=b;this.is_bin=c;this.fn=d;this.method=f;this.headers=g;this.data=h}c.init=function(){c.path=window.location.pathname;c.xhr=new XMLHttpRequest;c.xhr2=new XMLHttpRequest;c.is_online=navigator.onLine;window.onpopstate=function(a){Z.cur.blur(0)};window.addEventListener("online",c.state);window.addEventListener("offline",c.state)};c.urlreq_res_cb=function(a,b){var c=a.pathname,d=(na.is_standalone?"/pwa":"")+c,f=new da;f.path=c;f.qel=
a;f.is_bin=!0;f.init(b);$a.add(d);return 0};c.prototype.load=function(){var a=this,b=na.is_standalone?"/pwa/api":"/api",e=c.get_free();e.open(this.method,b+this.path,!0);e.responseType=this.is_bin?"arraybuffer":"document";for(var d in this.headers)e.setRequestHeader(d,this.headers[d]);e.onload=function(){if(200===e.status){if(null!=a.fn){var b=new Ja(e.response);(b=a.fn.bind(a.ud_s,b))&&b()}Ia.end_cb(null)}else alert(e.status);window.setTimeout(function(){fa.cur.hide()},100)};e.onprogress=function(a){fa.cur.pos(a.lengthComputable?
100*a.loaded/a.total:100)};e.onerror=function(b){b=a.path+" - not responding ("+e.status+")";alert(b);fa.cur.exec(fa.db.ERR,b);Ia.end_cb(null)};this.is_bin||$a.set("",this.path);fa.cur.pos(0);e.send(this.data);return 0};c.load=function(a,b,e){a=new c(a,b,1,e,"GET",{Accept:c.type,"Cache-Control":"max-age=0"},null);a.load();return a};c.send=function(a,b,e,d,f){a=new c(a,b,!0,e,"POST",{"Content-Type":d,Accept:c.type},f);a.load();return a};c.start=function(){c.load(c.path,da.cur,da.cur.evt)};c.state=
function(){c.is_online!=navigator.onLine&&(c.is_online=navigator.onLine,c.is_online?fa.cur.exec(fa.db.OK,"online"):fa.cur.exec(fa.db.ERR,"offline"))};c.get_free=function(){var a;c.is_working?(c.is_working=!1,a=c.xhr2):(a=c.xhr,c.is_working=!0);return a};c.type="application/octet-stream";c.is_working=!1;c.cont=0;return c}();h.Urlq=ma;var yb;(function(c){c.ERR="err";c.OK="ok"})(yb=h.progressg_db||(h.progressg_db={}));var fa=function(){function c(){this.el=document.createElement("div");this.fill=document.createElement("div");
this.style=this.par=null}c.prototype.init=function(){var a=this;this.el.appendChild(this.fill);null==this.el.parentElement&&(this.par.appendChild(this.el),this.el.onclick=function(b){a.hide()});this.hide();return this};c.prototype.pos=function(a){this.fill.innerHTML="";this.el.style.display="";this.fill.style.width=a+"%";this.set_style(!1);return this};c.prototype.exec=function(a,b){this.pos(100);this.style=a;this.set_style(!0);this.fill.innerHTML="<div class='max_w'>"+b+"</divg"};c.prototype.set_style=
function(a){this.el.className="dm_gprogress "+(a?"msg ":"")+this.style};c.prototype.hide=function(){this.el.style.display="none"};c.init=function(){c.cur.style="ok";c.cur.par=document.body;c.cur.init()};c.prototype.auto_hide=function(a){window.clearInterval(c.el_anime);c.el&&(c.cur.el.style.display="none")};c.db=yb;c.cur=new c;return c}();h.Progressg=fa;var ab;(function(c){c[c.WEB=0]="WEB";c[c.TV=1]="TV"})(ab=h.app_db||(h.app_db={}));var ga=function(){function c(){this.type=ab.WEB;this.wait_obj=this.wait_cb=
null;this.wait_last_tim=this.wait_delay=0}c.init=function(){"object"===typeof window?(zb.chek_debug(),aa.init(),c.cur.keys()):na.init()};c.prototype.load_css=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("link"),e="";b.rel="stylesheet";b.type="text/css";c.is_deb||(e="https://denpus.github.io");b.href=e+"/index.css?"+(new Date).getTime();b.media="all";a.appendChild(b)};c.prototype.keys=function(){M.focus(this,function(a,b){switch(b){case 37:case 72:J.cur.is_full?
J.cur.full_set(!1):F.sel_left();break;case 38:case 75:F.sel_left();break;case 39:case 76:J.cur.is_full?J.cur.full_set(!1):F.sel_right();break;case 40:case 74:F.sel_right();break;case M.db.exit:aa.cur.exit();break;case 13:F.sel_exec();break;case 27:F.sel_par();break;case 8:case M.db.pause:case M.db.media_pause:L.cur.pause();break;case M.db.media_play:L.cur.play_cur();break;case M.db.channel_down:L.cur.prev();break;case M.db.channel_up:L.cur.next();break;case M.db.info:J.cur.full_toggle();break;case M.db.guide:J.cur.full_set(!1);
J.cur.list();break;case M.db.media_stop:L.cur.stop();break;case 457:case M.db.n0:J.cur.play_ind(0);break;case M.db.n1:J.cur.play_ind(1);break;case M.db.n2:J.cur.play_ind(2);break;case M.db.n3:J.cur.play_ind(3);break;case M.db.n4:J.cur.play_ind(4);break;case M.db.n5:J.cur.play_ind(5);break;case M.db.n6:J.cur.play_ind(6);break;case M.db.n7:J.cur.play_ind(7);break;case M.db.n8:J.cur.play_ind(8);break;case M.db.n9:J.cur.play_ind(9)}return 0})};c.prototype.get_last_inp=function(){return this.wait_last_tim>
M.last_time.sec?this.wait_last_tim:M.last_time.sec};c.prototype.set_waiting=function(a,b,c){this.wait_delay=a;this.wait_obj=b;this.wait_cb=c;this.wait_last_tim=ia.get_cur_sec();return this};c.prototype.exec_waiting=function(){var a=this;this.wait_thr&&clearTimeout(this.wait_thr);this.wait_cb&&(this.wait_thr=setTimeout(function(){1E3*(ia.get_cur_sec()-a.get_last_inp())>=a.wait_delay&&a.wait_cb(a.wait_obj)},this.wait_delay))};c.prototype.evt=function(a,b){new la(a,b,0);a==Ba.kbd&&this.exec_waiting()};
c.is_deb=!0;c.type=ab;c.cur=new c;return c}();h.App=ga;(function(c){})(h.rect_db||(h.rect_db={}));var ub=function(){return function(){this.y2=this.x2=this.y1=this.x1=0}}();h.Rect=ub;var zb=function(c){function a(){var a=c.call(this)||this;ga.init();return a}xa(a,c);a.chek_debug=function(){ga.is_deb=h.debug};return a}(ga);h.debug=!1;new zb})(this);
